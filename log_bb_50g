@@@/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q01/query01.sql
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q01/engineLocalSettings.sql to hive init.
===============================================
Running query : q01
-----------------------------------------------
benchmark phase: run_query
stream number  : 0
user parameter file: 
user settings file : 
log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q01_hive_run_query_0.log
===============================================
checking existence of local: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs
creating/cleaning/set permissions for hdfs tmp and result folders for this query
hdfs client: hadoop fs
Duration for hdfs prepare:  0h 0m 17s
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q01/engineLocalSettings.sql to hive init.
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/log4j-slf4j-impl-2.6.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/users/wentingt/hadoop-3.0.0-beta1-src/hadoop-dist/target/hadoop-3.0.0-beta1/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]

Logging initialized using configuration in jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/hive-common-2.3.2.jar!/hive-log4j2.properties Async: true
hive.execution.engine=mr
hive.cbo.enable=true
hive.stats.fetch.partition.stats=true
hive.script.operator.truncate.env=false
hive.compute.query.using.stats=true
hive.vectorized.execution.enabled=false
hive.vectorized.execution.reduce.enabled=true
hive.stats.autogather=true
mapreduce.input.fileinputformat.split.minsize=1
mapreduce.input.fileinputformat.split.maxsize=256000000
hive.exec.reducers.bytes.per.reducer=256000000
hive.exec.reducers.max=1009
hive.exec.parallel=false
hive.exec.parallel.thread.number=8
hive.exec.compress.intermediate=false
hive.exec.compress.output=false
mapred.map.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
mapred.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
hive.default.fileformat=TEXTFILE
hive.auto.convert.sortmerge.join=false
hive.auto.convert.sortmerge.join.noconditionaltask is undefined
hive.optimize.bucketmapjoin=false
hive.optimize.bucketmapjoin.sortedmerge=false
hive.auto.convert.join.noconditionaltask.size=10000000
hive.auto.convert.join=true
hive.optimize.mapjoin.mapreduce is undefined
hive.mapred.local.mem=0
hive.mapjoin.smalltable.filesize=25000000
hive.mapjoin.localtask.max.memory.usage=0.9
hive.optimize.skewjoin=false
hive.optimize.skewjoin.compiletime=false
hive.optimize.ppd=true
hive.optimize.ppd.storage=true
hive.ppd.recognizetransivity=true
hive.optimize.index.filter=false
hive.optimize.sampling.orderby=false
hive.optimize.sampling.orderby.number=1000
hive.optimize.sampling.orderby.percent=0.1
bigbench.hive.optimize.sampling.orderby=true
bigbench.hive.optimize.sampling.orderby.number=20000
bigbench.hive.optimize.sampling.orderby.percent=0.1
hive.groupby.skewindata=false
hive.exec.submit.local.task.via.child=true
Added [/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/Resources/bigbenchqueriesmr.jar] to class path
Added resources: [/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/Resources/bigbenchqueriesmr.jar]
OK
Time taken: 0.01 seconds
hive.exec.compress.output=false
OK
Time taken: 0.082 seconds
OK
Time taken: 0.48 seconds
OK
STAGE DEPENDENCIES:
  Stage-8 is a root stage
  Stage-2 depends on stages: Stage-8
  Stage-3 depends on stages: Stage-2
  Stage-4 depends on stages: Stage-3
  Stage-0 depends on stages: Stage-4
  Stage-5 depends on stages: Stage-0

STAGE PLANS:
  Stage: Stage-8
    Map Reduce Local Work
      Alias -> Map Local Tables:
        soldtogetherpairs:solditemsperticket:i 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        soldtogetherpairs:solditemsperticket:i 
          TableScan
            alias: i
            Statistics: Num rows: 17820 Data size: 31241101 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_sk is not null and (i_category_id) IN (1, 2, 3)) (type: boolean)
              Statistics: Num rows: 8910 Data size: 15620550 Basic stats: COMPLETE Column stats: NONE
              HashTable Sink Operator
                keys:
                  0 ss_item_sk (type: bigint)
                  1 i_item_sk (type: bigint)

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: s
            Statistics: Num rows: 667579 Data size: 953293700 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_item_sk is not null and (ss_store_sk) IN (10, 20, 33, 40, 50)) (type: boolean)
              Statistics: Num rows: 333790 Data size: 476647563 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 ss_item_sk (type: bigint)
                  1 i_item_sk (type: bigint)
                outputColumnNames: _col2, _col9, _col26
                Statistics: Num rows: 367169 Data size: 524312330 Basic stats: COMPLETE Column stats: NONE
                Filter Operator
                  predicate: (_col2 = _col26) (type: boolean)
                  Statistics: Num rows: 183584 Data size: 262155451 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col9 (type: bigint), _col2 (type: bigint)
                    outputColumnNames: _col9, _col2
                    Statistics: Num rows: 183584 Data size: 262155451 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: collect_set(_col2)
                      keys: _col9 (type: bigint)
                      mode: hash
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 183584 Data size: 262155451 Basic stats: COMPLETE Column stats: NONE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 183584 Data size: 262155451 Basic stats: COMPLETE Column stats: NONE
                        value expressions: _col1 (type: array<bigint>)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: collect_set(VALUE._col0)
          keys: KEY._col0 (type: bigint)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 91792 Data size: 131077725 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: sort_array(_col1) (type: array<bigint>), false (type: boolean)
            outputColumnNames: _col0, _col1
            Statistics: Num rows: 91792 Data size: 131077725 Basic stats: COMPLETE Column stats: NONE
            UDTF Operator
              Statistics: Num rows: 91792 Data size: 131077725 Basic stats: COMPLETE Column stats: NONE
              function name: io.bigdatabenchmark.v1.queries.udf.PairwiseUDTF@38197e82
              Group By Operator
                aggregations: count()
                keys: itema (type: string), itemb (type: string)
                mode: hash
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 91792 Data size: 131077725 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string)
              sort order: ++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: string)
              Statistics: Num rows: 91792 Data size: 131077725 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0)
          keys: KEY._col0 (type: string), KEY._col1 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 45896 Data size: 65538862 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (_col2 > 50) (type: boolean)
            Statistics: Num rows: 15298 Data size: 21845335 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col2 (type: bigint), _col0 (type: string), _col1 (type: string)
              sort order: -++
              Statistics: Num rows: 15298 Data size: 21845335 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey1 (type: string), KEY.reducesinkkey2 (type: string), KEY.reducesinkkey0 (type: bigint)
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 15298 Data size: 21845335 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 142700 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: UDFToLong(_col0) (type: bigint), UDFToLong(_col1) (type: bigint), _col2 (type: bigint)
              outputColumnNames: _col0, _col1, _col2
              Statistics: Num rows: 100 Data size: 142700 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                Statistics: Num rows: 100 Data size: 142700 Basic stats: COMPLETE Column stats: NONE
                table:
                    input format: org.apache.hadoop.mapred.TextInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                    name: bigbench.q01_hive_run_query_0_result

  Stage: Stage-0
    Move Operator
      tables:
          replace: false
          table:
              input format: org.apache.hadoop.mapred.TextInputFormat
              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
              serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
              name: bigbench.q01_hive_run_query_0_result

  Stage: Stage-5
    Stats-Aggr Operator

Time taken: 2.354 seconds, Fetched: 163 row(s)
======= q01_hive_run_query_0 time =======
Start timestamp: 2018/02/12:12:09:01 1518458941
Stop  timestamp: 2018/02/12:12:09:16 1518458956
Duration:  0h 0m 15s
q01_hive_run_query_0 SUCCESS exit code: 0 
----- result -----
EMPTY  bytes: 0
to display: hadoop fs -cat /user/wentingt/benchmarks/bigbench/queryResults/q01_hive_run_query_0_result/*
----- logs -----
time&status: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/times.csv
full log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q01_hive_run_query_0.log
=========================
@@@/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q02/query02.sql
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q02/engineLocalSettings.sql to hive init.
===============================================
Running query : q02
-----------------------------------------------
benchmark phase: run_query
stream number  : 0
user parameter file: 
user settings file : 
log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q02_hive_run_query_0.log
===============================================
checking existence of local: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs
creating/cleaning/set permissions for hdfs tmp and result folders for this query
hdfs client: hadoop fs
Duration for hdfs prepare:  0h 0m 17s
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q02/engineLocalSettings.sql to hive init.
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/log4j-slf4j-impl-2.6.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/users/wentingt/hadoop-3.0.0-beta1-src/hadoop-dist/target/hadoop-3.0.0-beta1/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]

Logging initialized using configuration in jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/hive-common-2.3.2.jar!/hive-log4j2.properties Async: true
hive.execution.engine=mr
hive.cbo.enable=true
hive.stats.fetch.partition.stats=true
hive.script.operator.truncate.env=false
hive.compute.query.using.stats=true
hive.vectorized.execution.enabled=false
hive.vectorized.execution.reduce.enabled=true
hive.stats.autogather=true
mapreduce.input.fileinputformat.split.minsize=1
mapreduce.input.fileinputformat.split.maxsize=256000000
hive.exec.reducers.bytes.per.reducer=256000000
hive.exec.reducers.max=1009
hive.exec.parallel=false
hive.exec.parallel.thread.number=8
hive.exec.compress.intermediate=false
hive.exec.compress.output=false
mapred.map.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
mapred.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
hive.default.fileformat=TEXTFILE
hive.auto.convert.sortmerge.join=false
hive.auto.convert.sortmerge.join.noconditionaltask is undefined
hive.optimize.bucketmapjoin=false
hive.optimize.bucketmapjoin.sortedmerge=false
hive.auto.convert.join.noconditionaltask.size=10000000
hive.auto.convert.join=true
hive.optimize.mapjoin.mapreduce is undefined
hive.mapred.local.mem=0
hive.mapjoin.smalltable.filesize=25000000
hive.mapjoin.localtask.max.memory.usage=0.9
hive.optimize.skewjoin=false
hive.optimize.skewjoin.compiletime=false
hive.optimize.ppd=true
hive.optimize.ppd.storage=true
hive.ppd.recognizetransivity=true
hive.optimize.index.filter=false
hive.optimize.sampling.orderby=false
hive.optimize.sampling.orderby.number=1000
hive.optimize.sampling.orderby.percent=0.1
bigbench.hive.optimize.sampling.orderby=true
bigbench.hive.optimize.sampling.orderby.number=20000
bigbench.hive.optimize.sampling.orderby.percent=0.1
hive.groupby.skewindata=false
hive.exec.submit.local.task.via.child=true
Added [/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/Resources/bigbenchqueriesmr.jar] to class path
Added resources: [/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/Resources/bigbenchqueriesmr.jar]
OK
Time taken: 0.01 seconds
Added resources: [/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q02/q2-sessionize.py]
OK
Time taken: 0.072 seconds
OK
Time taken: 0.939 seconds
hive.exec.compress.output=false
OK
Time taken: 0.013 seconds
OK
Time taken: 0.15 seconds
OK
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-2 depends on stages: Stage-1
  Stage-3 depends on stages: Stage-2
  Stage-4 depends on stages: Stage-3
  Stage-0 depends on stages: Stage-4
  Stage-5 depends on stages: Stage-0

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_clickstreams
            Statistics: Num rows: 6770550 Data size: 253337416 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (wcs_item_sk is not null and wcs_user_sk is not null) (type: boolean)
              Statistics: Num rows: 6770550 Data size: 253337416 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: wcs_user_sk (type: bigint), wcs_item_sk (type: bigint), ((((wcs_click_date_sk * 24) * 60) * 60) + wcs_click_time_sk) (type: bigint)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 6770550 Data size: 253337416 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint), _col2 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 6770550 Data size: 253337416 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: bigint)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint), VALUE._col0 (type: bigint)
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 6770550 Data size: 253337416 Basic stats: COMPLETE Column stats: NONE
          Transform Operator
            command: python q2-sessionize.py 3600
            output info:
                input format: org.apache.hadoop.mapred.TextInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
            Statistics: Num rows: 6770550 Data size: 253337416 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              keys: _col1 (type: string), _col0 (type: bigint)
              mode: hash
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 6770550 Data size: 253337416 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: bigint)
              sort order: ++
              Map-reduce partition columns: _col0 (type: string)
              Statistics: Num rows: 6770550 Data size: 253337416 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: string), KEY._col1 (type: bigint)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 3385275 Data size: 126668708 Basic stats: COMPLETE Column stats: NONE
          Group By Operator
            aggregations: collect_list(_col1)
            keys: _col0 (type: string)
            mode: complete
            outputColumnNames: _col0, _col1
            Statistics: Num rows: 1692637 Data size: 63334335 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: array_contains(_col1, 10001) (type: boolean)
              Statistics: Num rows: 846318 Data size: 31667148 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col1 (type: array<bigint>)
                outputColumnNames: _col0
                Statistics: Num rows: 846318 Data size: 31667148 Basic stats: COMPLETE Column stats: NONE
                UDTF Operator
                  Statistics: Num rows: 846318 Data size: 31667148 Basic stats: COMPLETE Column stats: NONE
                  function name: explode
                  Filter Operator
                    predicate: (col <> 10001) (type: boolean)
                    Statistics: Num rows: 846318 Data size: 31667148 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: count()
                      keys: col (type: bigint)
                      mode: hash
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 846318 Data size: 31667148 Basic stats: COMPLETE Column stats: NONE
                      File Output Operator
                        compressed: false
                        table:
                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                            serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 846318 Data size: 31667148 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0)
          keys: KEY._col0 (type: bigint)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 423159 Data size: 15833574 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: bigint), 10001 (type: int), _col1 (type: bigint)
            outputColumnNames: _col0, _col1, _col2
            Statistics: Num rows: 423159 Data size: 15833574 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col2 (type: bigint), _col0 (type: bigint)
              sort order: -+
              Statistics: Num rows: 423159 Data size: 15833574 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey1 (type: bigint), 10001 (type: int), KEY.reducesinkkey0 (type: bigint)
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 423159 Data size: 15833574 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 30
            Statistics: Num rows: 30 Data size: 1110 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col0 (type: bigint), 10001 (type: bigint), _col2 (type: bigint)
              outputColumnNames: _col0, _col1, _col2
              Statistics: Num rows: 30 Data size: 1110 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                Statistics: Num rows: 30 Data size: 1110 Basic stats: COMPLETE Column stats: NONE
                table:
                    input format: org.apache.hadoop.mapred.TextInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                    name: bigbench.q02_hive_run_query_0_result

  Stage: Stage-0
    Move Operator
      tables:
          replace: false
          table:
              input format: org.apache.hadoop.mapred.TextInputFormat
              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
              serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
              name: bigbench.q02_hive_run_query_0_result

  Stage: Stage-5
    Stats-Aggr Operator

Time taken: 0.681 seconds, Fetched: 170 row(s)
OK
Time taken: 1.548 seconds
======= q02_hive_run_query_0 time =======
Start timestamp: 2018/02/12:12:09:35 1518458975
Stop  timestamp: 2018/02/12:12:09:51 1518458991
Duration:  0h 0m 16s
q02_hive_run_query_0 SUCCESS exit code: 0 
----- result -----
EMPTY  bytes: 0
to display: hadoop fs -cat /user/wentingt/benchmarks/bigbench/queryResults/q02_hive_run_query_0_result/*
----- logs -----
time&status: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/times.csv
full log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q02_hive_run_query_0.log
=========================
@@@/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q03/query03.sql
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q03/engineLocalSettings.sql to hive init.
===============================================
Running query : q03
-----------------------------------------------
benchmark phase: run_query
stream number  : 0
user parameter file: 
user settings file : 
log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q03_hive_run_query_0.log
===============================================
checking existence of local: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs
creating/cleaning/set permissions for hdfs tmp and result folders for this query
hdfs client: hadoop fs
Duration for hdfs prepare:  0h 0m 17s
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q03/engineLocalSettings.sql to hive init.
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/log4j-slf4j-impl-2.6.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/users/wentingt/hadoop-3.0.0-beta1-src/hadoop-dist/target/hadoop-3.0.0-beta1/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]

Logging initialized using configuration in jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/hive-common-2.3.2.jar!/hive-log4j2.properties Async: true
hive.execution.engine=mr
hive.cbo.enable=true
hive.stats.fetch.partition.stats=true
hive.script.operator.truncate.env=false
hive.compute.query.using.stats=true
hive.vectorized.execution.enabled=false
hive.vectorized.execution.reduce.enabled=true
hive.stats.autogather=true
mapreduce.input.fileinputformat.split.minsize=1
mapreduce.input.fileinputformat.split.maxsize=256000000
hive.exec.reducers.bytes.per.reducer=256000000
hive.exec.reducers.max=1009
hive.exec.parallel=false
hive.exec.parallel.thread.number=8
hive.exec.compress.intermediate=false
hive.exec.compress.output=false
mapred.map.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
mapred.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
hive.default.fileformat=TEXTFILE
hive.auto.convert.sortmerge.join=false
hive.auto.convert.sortmerge.join.noconditionaltask is undefined
hive.optimize.bucketmapjoin=false
hive.optimize.bucketmapjoin.sortedmerge=false
hive.auto.convert.join.noconditionaltask.size=10000000
hive.auto.convert.join=true
hive.optimize.mapjoin.mapreduce is undefined
hive.mapred.local.mem=0
hive.mapjoin.smalltable.filesize=25000000
hive.mapjoin.localtask.max.memory.usage=0.9
hive.optimize.skewjoin=false
hive.optimize.skewjoin.compiletime=false
hive.optimize.ppd=true
hive.optimize.ppd.storage=true
hive.ppd.recognizetransivity=true
hive.optimize.index.filter=false
hive.optimize.sampling.orderby=false
hive.optimize.sampling.orderby.number=1000
hive.optimize.sampling.orderby.percent=0.1
bigbench.hive.optimize.sampling.orderby=true
bigbench.hive.optimize.sampling.orderby.number=20000
bigbench.hive.optimize.sampling.orderby.percent=0.1
hive.groupby.skewindata=false
hive.exec.submit.local.task.via.child=true
Added resources: [/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q03/q03_filterLast_N_viewedItmes_within_y_days.py]
hive.exec.compress.output=false
OK
Time taken: 0.106 seconds
OK
Time taken: 0.519 seconds
OK
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-9 depends on stages: Stage-1
  Stage-3 depends on stages: Stage-9
  Stage-4 depends on stages: Stage-3
  Stage-5 depends on stages: Stage-4
  Stage-0 depends on stages: Stage-5
  Stage-6 depends on stages: Stage-0

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: w
            Statistics: Num rows: 6770550 Data size: 253337416 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (wcs_user_sk is not null and wcs_item_sk is not null) (type: boolean)
              Statistics: Num rows: 6770550 Data size: 253337416 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: wcs_user_sk (type: bigint), ((((wcs_click_date_sk * 24) * 60) * 60) + wcs_click_time_sk) (type: bigint), wcs_item_sk (type: bigint), wcs_sales_sk (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 6770550 Data size: 253337416 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint), _col1 (type: bigint), _col3 (type: bigint), _col2 (type: bigint)
                  sort order: ++++
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 6770550 Data size: 253337416 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint), KEY.reducesinkkey3 (type: bigint), KEY.reducesinkkey2 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 6770550 Data size: 253337416 Basic stats: COMPLETE Column stats: NONE
          Transform Operator
            command: python q03_filterLast_N_viewedItmes_within_y_days.py 864000 5 10001
            output info:
                input format: org.apache.hadoop.mapred.TextInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
            Statistics: Num rows: 6770550 Data size: 253337416 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: _col1 is not null (type: boolean)
              Statistics: Num rows: 6770550 Data size: 253337416 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-9
    Map Reduce Local Work
      Alias -> Map Local Tables:
        distributed:i 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        distributed:i 
          TableScan
            alias: i
            Statistics: Num rows: 17820 Data size: 31241101 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_sk is not null and (i_category_id) IN (2, 3)) (type: boolean)
              Statistics: Num rows: 8910 Data size: 15620550 Basic stats: COMPLETE Column stats: NONE
              HashTable Sink Operator
                keys:
                  0 i_item_sk (type: bigint)
                  1 _col1 (type: bigint)

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 i_item_sk (type: bigint)
                1 _col1 (type: bigint)
              outputColumnNames: _col0, _col25, _col26
              Statistics: Num rows: 7447605 Data size: 278671163 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: (_col0 = _col26) (type: boolean)
                Statistics: Num rows: 3723802 Data size: 139335562 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col25 (type: bigint), _col26 (type: bigint)
                  outputColumnNames: _col22, _col23
                  Statistics: Num rows: 3723802 Data size: 139335562 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col23 (type: bigint), _col22 (type: bigint)
                    sort order: ++
                    Map-reduce partition columns: _col23 (type: bigint), _col22 (type: bigint)
                    Statistics: Num rows: 3723802 Data size: 139335562 Basic stats: COMPLETE Column stats: NONE
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey1 (type: bigint), KEY.reducesinkkey0 (type: bigint)
          outputColumnNames: _col22, _col23
          Statistics: Num rows: 3723802 Data size: 139335562 Basic stats: COMPLETE Column stats: NONE
          Group By Operator
            aggregations: count()
            keys: _col22 (type: bigint), _col23 (type: bigint)
            mode: hash
            outputColumnNames: _col0, _col1, _col2
            Statistics: Num rows: 3723802 Data size: 139335562 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint), _col1 (type: bigint)
              sort order: ++
              Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
              Statistics: Num rows: 3723802 Data size: 139335562 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0)
          keys: KEY._col0 (type: bigint), KEY._col1 (type: bigint)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 1861901 Data size: 69667781 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col2 (type: bigint), _col0 (type: bigint), _col1 (type: bigint)
              sort order: -++
              Statistics: Num rows: 1861901 Data size: 69667781 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey1 (type: bigint), KEY.reducesinkkey2 (type: bigint), KEY.reducesinkkey0 (type: bigint)
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 1861901 Data size: 69667781 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 3700 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 3700 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.TextInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                  name: bigbench.q03_hive_run_query_0_result

  Stage: Stage-0
    Move Operator
      tables:
          replace: false
          table:
              input format: org.apache.hadoop.mapred.TextInputFormat
              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
              serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
              name: bigbench.q03_hive_run_query_0_result

  Stage: Stage-6
    Stats-Aggr Operator

Time taken: 1.174 seconds, Fetched: 176 row(s)
======= q03_hive_run_query_0 time =======
Start timestamp: 2018/02/12:12:10:10 1518459010
Stop  timestamp: 2018/02/12:12:10:24 1518459024
Duration:  0h 0m 14s
q03_hive_run_query_0 SUCCESS exit code: 0 
----- result -----
EMPTY  bytes: 0
to display: hadoop fs -cat /user/wentingt/benchmarks/bigbench/queryResults/q03_hive_run_query_0_result/*
----- logs -----
time&status: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/times.csv
full log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q03_hive_run_query_0.log
=========================
@@@/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q04/query04.sql
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q04/engineLocalSettings.sql to hive init.
===============================================
Running query : q04
-----------------------------------------------
benchmark phase: run_query
stream number  : 0
user parameter file: 
user settings file : 
log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q04_hive_run_query_0.log
===============================================
checking existence of local: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs
creating/cleaning/set permissions for hdfs tmp and result folders for this query
hdfs client: hadoop fs
Duration for hdfs prepare:  0h 0m 16s
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q04/engineLocalSettings.sql to hive init.
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/log4j-slf4j-impl-2.6.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/users/wentingt/hadoop-3.0.0-beta1-src/hadoop-dist/target/hadoop-3.0.0-beta1/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]

Logging initialized using configuration in jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/hive-common-2.3.2.jar!/hive-log4j2.properties Async: true
hive.execution.engine=mr
hive.cbo.enable=true
hive.stats.fetch.partition.stats=true
hive.script.operator.truncate.env=false
hive.compute.query.using.stats=true
hive.vectorized.execution.enabled=false
hive.vectorized.execution.reduce.enabled=true
hive.stats.autogather=true
mapreduce.input.fileinputformat.split.minsize=1
mapreduce.input.fileinputformat.split.maxsize=256000000
hive.exec.reducers.bytes.per.reducer=256000000
hive.exec.reducers.max=1009
hive.exec.parallel=false
hive.exec.parallel.thread.number=8
hive.exec.compress.intermediate=false
hive.exec.compress.output=false
mapred.map.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
mapred.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
hive.default.fileformat=TEXTFILE
hive.auto.convert.sortmerge.join=false
hive.auto.convert.sortmerge.join.noconditionaltask is undefined
hive.optimize.bucketmapjoin=false
hive.optimize.bucketmapjoin.sortedmerge=false
hive.auto.convert.join.noconditionaltask.size=10000000
hive.auto.convert.join=true
hive.optimize.mapjoin.mapreduce is undefined
hive.mapred.local.mem=0
hive.mapjoin.smalltable.filesize=25000000
hive.mapjoin.localtask.max.memory.usage=0.9
hive.optimize.skewjoin=false
hive.optimize.skewjoin.compiletime=false
hive.optimize.ppd=true
hive.optimize.ppd.storage=true
hive.ppd.recognizetransivity=true
hive.optimize.index.filter=false
hive.optimize.sampling.orderby=false
hive.optimize.sampling.orderby.number=1000
hive.optimize.sampling.orderby.percent=0.1
bigbench.hive.optimize.sampling.orderby=true
bigbench.hive.optimize.sampling.orderby.number=20000
bigbench.hive.optimize.sampling.orderby.percent=0.1
hive.groupby.skewindata=false
hive.exec.submit.local.task.via.child=true
Added resources: [/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q04/q4_abandonedShoppingCarts.py]
Added resources: [/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q04/q4_sessionize.py]
OK
Time taken: 0.107 seconds
OK
Time taken: 0.932 seconds
hive.exec.compress.output=false
OK
Time taken: 0.013 seconds
OK
Time taken: 0.173 seconds
FAILED: ParseException line 24:0 missing EOF at ';' near 'abandonedShoppingCartsPageCountsPerSession'
An error occured while running command:
==========
runEngineCmd -f /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q04/q04.sql
==========
Please check the log files for details
======= q04_hive_run_query_0 time =======
Start timestamp: 2018/02/12:12:10:42 1518459042
Stop  timestamp: 2018/02/12:12:10:56 1518459056
Duration:  0h 0m 14s
q04_hive_run_query_0 FAILED exit code: 64 
----- result -----
EMPTY  bytes: 0
to display: hadoop fs -cat /user/wentingt/benchmarks/bigbench/queryResults/q04_hive_run_query_0_result/*
----- logs -----
time&status: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/times.csv
full log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q04_hive_run_query_0.log
=========================
An error occured while running command:
==========
runModule
==========
Please check the log files for details
@@@/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q05/query05.sql
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q05/engineLocalSettings.sql to hive init.
===============================================
Running query : q05
-----------------------------------------------
benchmark phase: run_query
stream number  : 0
user parameter file: 
user settings file : 
log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q05_hive_run_query_0.log
===============================================
checking existence of local: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs
creating/cleaning/set permissions for hdfs tmp and result folders for this query
hdfs client: hadoop fs
Duration for hdfs prepare:  0h 0m 16s
=========================
q05 Step 1/3: Executing hive queries
tmp output: /user/wentingt/benchmarks/bigbench/temp/q05_hive_run_query_0_temp
=========================
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q05/engineLocalSettings.sql to hive init.
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/log4j-slf4j-impl-2.6.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/users/wentingt/hadoop-3.0.0-beta1-src/hadoop-dist/target/hadoop-3.0.0-beta1/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]

Logging initialized using configuration in jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/hive-common-2.3.2.jar!/hive-log4j2.properties Async: true
hive.execution.engine=mr
hive.cbo.enable=true
hive.stats.fetch.partition.stats=true
hive.script.operator.truncate.env=false
hive.compute.query.using.stats=true
hive.vectorized.execution.enabled=false
hive.vectorized.execution.reduce.enabled=true
hive.stats.autogather=true
mapreduce.input.fileinputformat.split.minsize=1
mapreduce.input.fileinputformat.split.maxsize=256000000
hive.exec.reducers.bytes.per.reducer=256000000
hive.exec.reducers.max=1009
hive.exec.parallel=false
hive.exec.parallel.thread.number=8
hive.exec.compress.intermediate=false
hive.exec.compress.output=false
mapred.map.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
mapred.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
hive.default.fileformat=TEXTFILE
hive.auto.convert.sortmerge.join=false
hive.auto.convert.sortmerge.join.noconditionaltask is undefined
hive.optimize.bucketmapjoin=false
hive.optimize.bucketmapjoin.sortedmerge=false
hive.auto.convert.join.noconditionaltask.size=10000000
hive.auto.convert.join=true
hive.optimize.mapjoin.mapreduce is undefined
hive.mapred.local.mem=0
hive.mapjoin.smalltable.filesize=25000000
hive.mapjoin.localtask.max.memory.usage=0.9
hive.optimize.skewjoin=false
hive.optimize.skewjoin.compiletime=false
hive.optimize.ppd=true
hive.optimize.ppd.storage=true
hive.ppd.recognizetransivity=true
hive.optimize.index.filter=false
hive.optimize.sampling.orderby=false
hive.optimize.sampling.orderby.number=1000
hive.optimize.sampling.orderby.percent=0.1
bigbench.hive.optimize.sampling.orderby=true
bigbench.hive.optimize.sampling.orderby.number=20000
bigbench.hive.optimize.sampling.orderby.percent=0.1
hive.groupby.skewindata=false
hive.exec.submit.local.task.via.child=true
OK
Time taken: 0.09 seconds
OK
Time taken: 0.67 seconds
No Stats for bigbench@web_clickstreams, Columns: wcs_item_sk, wcs_user_sk
No Stats for bigbench@item, Columns: i_category, i_category_id, i_item_sk
No Stats for bigbench@customer, Columns: c_customer_sk, c_current_cdemo_sk
No Stats for bigbench@customer_demographics, Columns: cd_demo_sk, cd_education_status, cd_gender
OK
STAGE DEPENDENCIES:
  Stage-14 is a root stage
  Stage-2 depends on stages: Stage-14
  Stage-13 depends on stages: Stage-2
  Stage-10 depends on stages: Stage-13
  Stage-12 depends on stages: Stage-10
  Stage-9 depends on stages: Stage-12
  Stage-0 depends on stages: Stage-9
  Stage-5 depends on stages: Stage-0

STAGE PLANS:
  Stage: Stage-14
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_1:it 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_1:it 
          TableScan
            alias: it
            Statistics: Num rows: 17820 Data size: 31241101 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 17820 Data size: 31241101 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: bigint), i_category_id (type: int), i_category (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 17820 Data size: 31241101 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_clickstreams
            Statistics: Num rows: 6770550 Data size: 253337416 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (wcs_item_sk is not null and wcs_user_sk is not null) (type: boolean)
              Statistics: Num rows: 6770550 Data size: 253337416 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: wcs_item_sk (type: bigint), wcs_user_sk (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 6770550 Data size: 253337416 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col1, _col3, _col4
                  Statistics: Num rows: 7447605 Data size: 278671163 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col1 (type: bigint), CASE WHEN ((_col4 = 'Books')) THEN (1) ELSE (0) END (type: int), CASE WHEN ((_col3 = 1)) THEN (1) ELSE (0) END (type: int), CASE WHEN ((_col3 = 2)) THEN (1) ELSE (0) END (type: int), CASE WHEN ((_col3 = 3)) THEN (1) ELSE (0) END (type: int), CASE WHEN ((_col3 = 4)) THEN (1) ELSE (0) END (type: int), CASE WHEN ((_col3 = 5)) THEN (1) ELSE (0) END (type: int), CASE WHEN ((_col3 = 6)) THEN (1) ELSE (0) END (type: int), CASE WHEN ((_col3 = 7)) THEN (1) ELSE (0) END (type: int)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                    Statistics: Num rows: 7447605 Data size: 278671163 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col1), sum(_col2), sum(_col3), sum(_col4), sum(_col5), sum(_col6), sum(_col7), sum(_col8)
                      keys: _col0 (type: bigint)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                      Statistics: Num rows: 7447605 Data size: 278671163 Basic stats: COMPLETE Column stats: NONE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 7447605 Data size: 278671163 Basic stats: COMPLETE Column stats: NONE
                        value expressions: _col1 (type: bigint), _col2 (type: bigint), _col3 (type: bigint), _col4 (type: bigint), _col5 (type: bigint), _col6 (type: bigint), _col7 (type: bigint), _col8 (type: bigint)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), sum(VALUE._col4), sum(VALUE._col5), sum(VALUE._col6), sum(VALUE._col7)
          keys: KEY._col0 (type: bigint)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
          Statistics: Num rows: 3723802 Data size: 139335562 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-13
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:ct 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:ct 
          TableScan
            alias: ct
            Statistics: Num rows: 99000 Data size: 88009812 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_current_cdemo_sk is not null) (type: boolean)
              Statistics: Num rows: 99000 Data size: 88009812 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: bigint), c_current_cdemo_sk (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 99000 Data size: 88009812 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-10
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: bigint)
                1 _col0 (type: bigint)
              outputColumnNames: _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col10
              Statistics: Num rows: 4096182 Data size: 153269121 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-12
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:customer_demographics 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:customer_demographics 
          TableScan
            alias: customer_demographics
            Statistics: Num rows: 1920800 Data size: 718371044 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: cd_demo_sk is not null (type: boolean)
              Statistics: Num rows: 1920800 Data size: 718371044 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: bigint), cd_gender (type: string), cd_education_status (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1920800 Data size: 718371044 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col10 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-9
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col10 (type: bigint)
                1 _col0 (type: bigint)
              outputColumnNames: _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col12, _col13
              Statistics: Num rows: 4505800 Data size: 168596036 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col1 (type: bigint), UDFToLong(CASE WHEN ((_col13) IN ('Advanced Degree', 'College', '4 yr Degree', '2 yr Degree')) THEN (1) ELSE (0) END) (type: bigint), UDFToLong(CASE WHEN ((_col12 = 'M')) THEN (1) ELSE (0) END) (type: bigint), _col2 (type: bigint), _col3 (type: bigint), _col4 (type: bigint), _col5 (type: bigint), _col6 (type: bigint), _col7 (type: bigint), _col8 (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                Statistics: Num rows: 4505800 Data size: 168596036 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  Statistics: Num rows: 4505800 Data size: 168596036 Basic stats: COMPLETE Column stats: NONE
                  table:
                      input format: org.apache.hadoop.mapred.TextInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                      name: bigbench.q05_hive_run_query_0_temp
      Local Work:
        Map Reduce Local Work

  Stage: Stage-0
    Move Operator
      tables:
          replace: false
          table:
              input format: org.apache.hadoop.mapred.TextInputFormat
              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
              serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
              name: bigbench.q05_hive_run_query_0_temp

  Stage: Stage-5
    Stats-Aggr Operator

Time taken: 2.742 seconds, Fetched: 194 row(s)
=========================
q05 Step 2/3: logistic regression with spark-mllib with direct metastore access
=========================
spark-submit --class io.bigdatabenchmark.v1.queries.q05.LogisticRegression /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/Resources/bigbench-ml-spark.jar --fromHiveMetastore true -i bigbench.q05_hive_run_query_0_temp -o /user/wentingt/benchmarks/bigbench/queryResults/q05_hive_run_query_0_result// --type LBFGS --step-size 1 --iterations 20 --lambda 0 --numClasses 2 --convergenceTol 1e-5 --numCorrections 10 --saveClassificationResult false --saveMetaInfo true --verbose false
/users/wentingt/Big-Data-Benchmark-for-Big-Bench/bin/bigBench: line 64: spark-submit: command not found
An error occured while running command:
==========
spark-submit --class io.bigdatabenchmark.v1.queries.q05.LogisticRegression /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/Resources/bigbench-ml-spark.jar --fromHiveMetastore true -i bigbench.q05_hive_run_query_0_temp -o /user/wentingt/benchmarks/bigbench/queryResults/q05_hive_run_query_0_result// --type LBFGS --step-size 1 --iterations 20 --lambda 0 --numClasses 2 --convergenceTol 1e-5 --numCorrections 10 --saveClassificationResult false --saveMetaInfo true --verbose false
==========
Please check the log files for details
======= q05_hive_run_query_0 time =======
Start timestamp: 2018/02/12:12:11:14 1518459074
Stop  timestamp: 2018/02/12:12:11:30 1518459090
Duration:  0h 0m 16s
q05_hive_run_query_0 FAILED exit code: 127 
----- result -----
EMPTY  bytes: 0
to display: hadoop fs -cat /user/wentingt/benchmarks/bigbench/queryResults/q05_hive_run_query_0_result/*
----- logs -----
time&status: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/times.csv
full log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q05_hive_run_query_0.log
=========================
An error occured while running command:
==========
runModule
==========
Please check the log files for details
@@@/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q06/query06.sql
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q06/engineLocalSettings.sql to hive init.
===============================================
Running query : q06
-----------------------------------------------
benchmark phase: run_query
stream number  : 0
user parameter file: 
user settings file : 
log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q06_hive_run_query_0.log
===============================================
checking existence of local: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs
creating/cleaning/set permissions for hdfs tmp and result folders for this query
hdfs client: hadoop fs
Duration for hdfs prepare:  0h 0m 17s
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q06/engineLocalSettings.sql to hive init.
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/log4j-slf4j-impl-2.6.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/users/wentingt/hadoop-3.0.0-beta1-src/hadoop-dist/target/hadoop-3.0.0-beta1/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]

Logging initialized using configuration in jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/hive-common-2.3.2.jar!/hive-log4j2.properties Async: true
hive.execution.engine=mr
hive.cbo.enable=true
hive.stats.fetch.partition.stats=true
hive.script.operator.truncate.env=false
hive.compute.query.using.stats=true
hive.vectorized.execution.enabled=false
hive.vectorized.execution.reduce.enabled=true
hive.stats.autogather=true
mapreduce.input.fileinputformat.split.minsize=1
mapreduce.input.fileinputformat.split.maxsize=256000000
hive.exec.reducers.bytes.per.reducer=256000000
hive.exec.reducers.max=1009
hive.exec.parallel=false
hive.exec.parallel.thread.number=8
hive.exec.compress.intermediate=false
hive.exec.compress.output=false
mapred.map.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
mapred.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
hive.default.fileformat=TEXTFILE
hive.auto.convert.sortmerge.join=false
hive.auto.convert.sortmerge.join.noconditionaltask is undefined
hive.optimize.bucketmapjoin=false
hive.optimize.bucketmapjoin.sortedmerge=false
hive.auto.convert.join.noconditionaltask.size=10000000
hive.auto.convert.join=true
hive.optimize.mapjoin.mapreduce is undefined
hive.mapred.local.mem=0
hive.mapjoin.smalltable.filesize=25000000
hive.mapjoin.localtask.max.memory.usage=0.9
hive.optimize.skewjoin=false
hive.optimize.skewjoin.compiletime=false
hive.optimize.ppd=true
hive.optimize.ppd.storage=true
hive.ppd.recognizetransivity=true
hive.optimize.index.filter=false
hive.optimize.sampling.orderby=false
hive.optimize.sampling.orderby.number=1000
hive.optimize.sampling.orderby.percent=0.1
bigbench.hive.optimize.sampling.orderby=true
bigbench.hive.optimize.sampling.orderby.number=20000
bigbench.hive.optimize.sampling.orderby.percent=0.1
hive.groupby.skewindata=false
hive.exec.submit.local.task.via.child=true
OK
Time taken: 0.098 seconds
OK
Time taken: 0.009 seconds
OK
Time taken: 1.763 seconds
OK
Time taken: 0.265 seconds
hive.exec.compress.output=false
OK
Time taken: 0.007 seconds
OK
Time taken: 0.112 seconds
OK
STAGE DEPENDENCIES:
  Stage-20 is a root stage
  Stage-2 depends on stages: Stage-20
  Stage-14 depends on stages: Stage-2, Stage-8 , consists of Stage-17, Stage-18, Stage-19, Stage-3
  Stage-17 has a backup stage: Stage-3
  Stage-11 depends on stages: Stage-17
  Stage-4 depends on stages: Stage-3, Stage-11, Stage-12, Stage-13
  Stage-0 depends on stages: Stage-4
  Stage-5 depends on stages: Stage-0
  Stage-18 has a backup stage: Stage-3
  Stage-12 depends on stages: Stage-18
  Stage-19 has a backup stage: Stage-3
  Stage-13 depends on stages: Stage-19
  Stage-3
  Stage-21 is a root stage
  Stage-8 depends on stages: Stage-21

STAGE PLANS:
  Stage: Stage-20
    Map Reduce Local Work
      Alias -> Map Local Tables:
        store:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        store:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 109573 Data size: 123050479 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date_sk is not null and d_year BETWEEN 2001 AND 2002) (type: boolean)
              Statistics: Num rows: 12174 Data size: 13671402 Basic stats: COMPLETE Column stats: NONE
              HashTable Sink Operator
                keys:
                  0 ss_sold_date_sk (type: bigint)
                  1 d_date_sk (type: bigint)

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 667579 Data size: 953293700 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_customer_sk is not null) (type: boolean)
              Statistics: Num rows: 667579 Data size: 953293700 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 ss_sold_date_sk (type: bigint)
                  1 d_date_sk (type: bigint)
                outputColumnNames: _col0, _col3, _col14, _col15, _col16, _col17, _col26, _col32
                Statistics: Num rows: 734336 Data size: 1048623092 Basic stats: COMPLETE Column stats: NONE
                Filter Operator
                  predicate: (_col0 = _col26) (type: boolean)
                  Statistics: Num rows: 367168 Data size: 524311546 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col3 (type: bigint), _col32 (type: int), _col17 (type: decimal(7,2)), _col16 (type: decimal(7,2)), _col14 (type: decimal(7,2)), _col15 (type: decimal(7,2))
                    outputColumnNames: _col3, _col32, _col17, _col16, _col14, _col15
                    Statistics: Num rows: 367168 Data size: 524311546 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(CASE WHEN ((_col32 = 2001)) THEN (((((_col17 - _col16) - _col14) + _col15) / 2)) ELSE (0) END), sum(CASE WHEN ((_col32 = (2001 + 1))) THEN (((((_col17 - _col16) - _col14) + _col15) / 2)) ELSE (0) END)
                      keys: _col3 (type: bigint)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 367168 Data size: 524311546 Basic stats: COMPLETE Column stats: NONE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 367168 Data size: 524311546 Basic stats: COMPLETE Column stats: NONE
                        value expressions: _col1 (type: decimal(26,6)), _col2 (type: decimal(26,6))
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1)
          keys: KEY._col0 (type: bigint)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 183584 Data size: 262155773 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (_col1 > 0) (type: boolean)
            Statistics: Num rows: 61194 Data size: 87384305 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-14
    Conditional Operator

  Stage: Stage-17
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME1 
          Fetch Operator
            limit: -1
        c 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint)
                1 _col0 (type: bigint)
                2 c_customer_sk (type: bigint)
        c 
          TableScan
            alias: c
            Statistics: Num rows: 99000 Data size: 88009812 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: c_customer_sk is not null (type: boolean)
              Statistics: Num rows: 99000 Data size: 88009812 Basic stats: COMPLETE Column stats: NONE
              HashTable Sink Operator
                keys:
                  0 _col0 (type: bigint)
                  1 _col0 (type: bigint)
                  2 c_customer_sk (type: bigint)

  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 1 to 2
              keys:
                0 _col0 (type: bigint)
                1 _col0 (type: bigint)
                2 c_customer_sk (type: bigint)
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col14, _col15, _col16, _col20, _col21, _col22
              Statistics: Num rows: 217800 Data size: 193621590 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: ((_col3 = _col6) and ((_col5 / _col4) > (_col2 / _col1)) and (_col0 = _col3)) (type: boolean)
                Statistics: Num rows: 18150 Data size: 16135132 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: (_col5 / _col4) (type: decimal(38,12)), _col6 (type: bigint), _col14 (type: string), _col15 (type: string), _col16 (type: string), _col20 (type: string), _col21 (type: string), _col22 (type: string)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                  Statistics: Num rows: 18150 Data size: 16135132 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: decimal(38,12)), _col1 (type: bigint), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: string)
              sort order: -++++++
              Statistics: Num rows: 18150 Data size: 16135132 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col7 (type: string)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: decimal(38,12)), KEY.reducesinkkey1 (type: bigint), KEY.reducesinkkey2 (type: string), KEY.reducesinkkey3 (type: string), KEY.reducesinkkey4 (type: string), KEY.reducesinkkey5 (type: string), KEY.reducesinkkey6 (type: string), VALUE._col0 (type: string)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
          Statistics: Num rows: 18150 Data size: 16135132 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 88800 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: CAST( _col0 AS decimal(15,1)) (type: decimal(15,1)), _col1 (type: bigint), _col2 (type: string), _col3 (type: string), _col4 (type: string), _col5 (type: string), _col6 (type: string), _col7 (type: string)
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
              Statistics: Num rows: 100 Data size: 88800 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                Statistics: Num rows: 100 Data size: 88800 Basic stats: COMPLETE Column stats: NONE
                table:
                    input format: org.apache.hadoop.mapred.TextInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                    name: bigbench.q06_hive_run_query_0_result

  Stage: Stage-0
    Move Operator
      tables:
          replace: false
          table:
              input format: org.apache.hadoop.mapred.TextInputFormat
              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
              serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
              name: bigbench.q06_hive_run_query_0_result

  Stage: Stage-5
    Stats-Aggr Operator

  Stage: Stage-18
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
        c 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint)
                1 _col0 (type: bigint)
                2 c_customer_sk (type: bigint)
        c 
          TableScan
            alias: c
            Statistics: Num rows: 99000 Data size: 88009812 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: c_customer_sk is not null (type: boolean)
              Statistics: Num rows: 99000 Data size: 88009812 Basic stats: COMPLETE Column stats: NONE
              HashTable Sink Operator
                keys:
                  0 _col0 (type: bigint)
                  1 _col0 (type: bigint)
                  2 c_customer_sk (type: bigint)

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 1 to 2
              keys:
                0 _col0 (type: bigint)
                1 _col0 (type: bigint)
                2 c_customer_sk (type: bigint)
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col14, _col15, _col16, _col20, _col21, _col22
              Statistics: Num rows: 217800 Data size: 193621590 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: ((_col3 = _col6) and ((_col5 / _col4) > (_col2 / _col1)) and (_col0 = _col3)) (type: boolean)
                Statistics: Num rows: 18150 Data size: 16135132 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: (_col5 / _col4) (type: decimal(38,12)), _col6 (type: bigint), _col14 (type: string), _col15 (type: string), _col16 (type: string), _col20 (type: string), _col21 (type: string), _col22 (type: string)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                  Statistics: Num rows: 18150 Data size: 16135132 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-19
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
        $INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint)
                1 _col0 (type: bigint)
                2 c_customer_sk (type: bigint)
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint)
                1 _col0 (type: bigint)
                2 c_customer_sk (type: bigint)

  Stage: Stage-13
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: c
            Statistics: Num rows: 99000 Data size: 88009812 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: c_customer_sk is not null (type: boolean)
              Statistics: Num rows: 99000 Data size: 88009812 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                     Inner Join 1 to 2
                keys:
                  0 _col0 (type: bigint)
                  1 _col0 (type: bigint)
                  2 c_customer_sk (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col14, _col15, _col16, _col20, _col21, _col22
                Statistics: Num rows: 217800 Data size: 193621590 Basic stats: COMPLETE Column stats: NONE
                Filter Operator
                  predicate: ((_col3 = _col6) and ((_col5 / _col4) > (_col2 / _col1)) and (_col0 = _col3)) (type: boolean)
                  Statistics: Num rows: 18150 Data size: 16135132 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: (_col5 / _col4) (type: decimal(38,12)), _col6 (type: bigint), _col14 (type: string), _col15 (type: string), _col16 (type: string), _col20 (type: string), _col21 (type: string), _col22 (type: string)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                    Statistics: Num rows: 18150 Data size: 16135132 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 61194 Data size: 87384305 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: decimal(26,6)), _col2 (type: decimal(26,6))
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 61238 Data size: 111940881 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: decimal(26,6)), _col2 (type: decimal(26,6))
          TableScan
            alias: c
            Statistics: Num rows: 99000 Data size: 88009812 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: c_customer_sk is not null (type: boolean)
              Statistics: Num rows: 99000 Data size: 88009812 Basic stats: COMPLETE Column stats: NONE
              Reduce Output Operator
                key expressions: c_customer_sk (type: bigint)
                sort order: +
                Map-reduce partition columns: c_customer_sk (type: bigint)
                Statistics: Num rows: 99000 Data size: 88009812 Basic stats: COMPLETE Column stats: NONE
                value expressions: c_first_name (type: string), c_last_name (type: string), c_preferred_cust_flag (type: string), c_birth_country (type: string), c_login (type: string), c_email_address (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
               Inner Join 1 to 2
          keys:
            0 _col0 (type: bigint)
            1 _col0 (type: bigint)
            2 c_customer_sk (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col14, _col15, _col16, _col20, _col21, _col22
          Statistics: Num rows: 217800 Data size: 193621590 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: ((_col3 = _col6) and ((_col5 / _col4) > (_col2 / _col1)) and (_col0 = _col3)) (type: boolean)
            Statistics: Num rows: 18150 Data size: 16135132 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: (_col5 / _col4) (type: decimal(38,12)), _col6 (type: bigint), _col14 (type: string), _col15 (type: string), _col16 (type: string), _col20 (type: string), _col21 (type: string), _col22 (type: string)
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
              Statistics: Num rows: 18150 Data size: 16135132 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-21
    Map Reduce Local Work
      Alias -> Map Local Tables:
        web:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        web:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 109573 Data size: 123050479 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date_sk is not null and d_year BETWEEN 2001 AND 2002) (type: boolean)
              Statistics: Num rows: 12174 Data size: 13671402 Basic stats: COMPLETE Column stats: NONE
              HashTable Sink Operator
                keys:
                  0 ws_sold_date_sk (type: bigint)
                  1 d_date_sk (type: bigint)

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_sales
            Statistics: Num rows: 668052 Data size: 1221174888 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_sold_date_sk is not null and ws_bill_customer_sk is not null) (type: boolean)
              Statistics: Num rows: 668052 Data size: 1221174888 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 ws_sold_date_sk (type: bigint)
                  1 d_date_sk (type: bigint)
                outputColumnNames: _col0, _col4, _col22, _col23, _col24, _col25, _col37, _col43
                Statistics: Num rows: 734857 Data size: 1343292405 Basic stats: COMPLETE Column stats: NONE
                Filter Operator
                  predicate: (_col0 = _col37) (type: boolean)
                  Statistics: Num rows: 367428 Data size: 671645288 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col4 (type: bigint), _col43 (type: int), _col25 (type: decimal(7,2)), _col24 (type: decimal(7,2)), _col22 (type: decimal(7,2)), _col23 (type: decimal(7,2))
                    outputColumnNames: _col4, _col43, _col25, _col24, _col22, _col23
                    Statistics: Num rows: 367428 Data size: 671645288 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(CASE WHEN ((_col43 = 2001)) THEN (((((_col25 - _col24) - _col22) + _col23) / 2)) ELSE (0) END), sum(CASE WHEN ((_col43 = (2001 + 1))) THEN (((((_col25 - _col24) - _col22) + _col23) / 2)) ELSE (0) END)
                      keys: _col4 (type: bigint)
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 367428 Data size: 671645288 Basic stats: COMPLETE Column stats: NONE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 367428 Data size: 671645288 Basic stats: COMPLETE Column stats: NONE
                        value expressions: _col1 (type: decimal(26,6)), _col2 (type: decimal(26,6))
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1)
          keys: KEY._col0 (type: bigint)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 183714 Data size: 335822644 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (_col1 > 0) (type: boolean)
            Statistics: Num rows: 61238 Data size: 111940881 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

Time taken: 1.123 seconds, Fetched: 447 row(s)
OK
Time taken: 1.679 seconds
OK
Time taken: 0.084 seconds
======= q06_hive_run_query_0 time =======
Start timestamp: 2018/02/12:12:11:50 1518459110
Stop  timestamp: 2018/02/12:12:12:07 1518459127
Duration:  0h 0m 17s
q06_hive_run_query_0 SUCCESS exit code: 0 
----- result -----
EMPTY  bytes: 0
to display: hadoop fs -cat /user/wentingt/benchmarks/bigbench/queryResults/q06_hive_run_query_0_result/*
----- logs -----
time&status: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/times.csv
full log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q06_hive_run_query_0.log
=========================
@@@/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q07/query07.sql
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q07/engineLocalSettings.sql to hive init.
===============================================
Running query : q07
-----------------------------------------------
benchmark phase: run_query
stream number  : 0
user parameter file: 
user settings file : 
log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q07_hive_run_query_0.log
===============================================
checking existence of local: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs
creating/cleaning/set permissions for hdfs tmp and result folders for this query
hdfs client: hadoop fs
Duration for hdfs prepare:  0h 0m 17s
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q07/engineLocalSettings.sql to hive init.
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/log4j-slf4j-impl-2.6.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/users/wentingt/hadoop-3.0.0-beta1-src/hadoop-dist/target/hadoop-3.0.0-beta1/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]

Logging initialized using configuration in jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/hive-common-2.3.2.jar!/hive-log4j2.properties Async: true
hive.execution.engine=mr
hive.cbo.enable=true
hive.stats.fetch.partition.stats=true
hive.script.operator.truncate.env=false
hive.compute.query.using.stats=true
hive.vectorized.execution.enabled=false
hive.vectorized.execution.reduce.enabled=true
hive.stats.autogather=true
mapreduce.input.fileinputformat.split.minsize=1
mapreduce.input.fileinputformat.split.maxsize=256000000
hive.exec.reducers.bytes.per.reducer=256000000
hive.exec.reducers.max=1009
hive.exec.parallel=false
hive.exec.parallel.thread.number=8
hive.exec.compress.intermediate=false
hive.exec.compress.output=false
mapred.map.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
mapred.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
hive.default.fileformat=TEXTFILE
hive.auto.convert.sortmerge.join=false
hive.auto.convert.sortmerge.join.noconditionaltask is undefined
hive.optimize.bucketmapjoin=false
hive.optimize.bucketmapjoin.sortedmerge=false
hive.auto.convert.join.noconditionaltask.size=10000000
hive.auto.convert.join=true
hive.optimize.mapjoin.mapreduce is undefined
hive.mapred.local.mem=0
hive.mapjoin.smalltable.filesize=25000000
hive.mapjoin.localtask.max.memory.usage=0.9
hive.optimize.skewjoin=false
hive.optimize.skewjoin.compiletime=false
hive.optimize.ppd=true
hive.optimize.ppd.storage=true
hive.ppd.recognizetransivity=true
hive.optimize.index.filter=false
hive.optimize.sampling.orderby=false
hive.optimize.sampling.orderby.number=1000
hive.optimize.sampling.orderby.percent=0.1
bigbench.hive.optimize.sampling.orderby=true
bigbench.hive.optimize.sampling.orderby.number=20000
bigbench.hive.optimize.sampling.orderby.percent=0.1
hive.groupby.skewindata=false
hive.exec.submit.local.task.via.child=true
OK
Time taken: 0.062 seconds
WARNING: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = wentingt_20180212111238_6d01f3f1-0a86-44bf-b00c-853524803543
Total jobs = 2
Launching Job 1 out of 2
Number of reduce tasks not specified. Estimated from input data size: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1518452786757_0136, Tracking URL = http://dc1master-lan1:8088/proxy/application_1518452786757_0136/
Kill Command = /users/wentingt/hadoop-3.0.0-beta1-src/hadoop-dist/target/hadoop-3.0.0-beta1/bin/hadoop job  -kill job_1518452786757_0136
Hadoop job information for Stage-3: number of mappers: 1; number of reducers: 1
2018-02-12 11:12:52,651 Stage-3 map = 0%,  reduce = 0%
2018-02-12 11:13:00,007 Stage-3 map = 100%,  reduce = 0%, Cumulative CPU 6.21 sec
2018-02-12 11:13:06,239 Stage-3 map = 100%,  reduce = 100%, Cumulative CPU 12.52 sec
MapReduce Total cumulative CPU time: 12 seconds 520 msec
Ended Job = job_1518452786757_0136
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/log4j-slf4j-impl-2.6.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/users/wentingt/hadoop-3.0.0-beta1-src/hadoop-dist/target/hadoop-3.0.0-beta1/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
2018-02-12 11:13:13	Starting to launch local task to process map join;	maximum memory = 477626368
2018-02-12 11:13:15	Dump the side-table for tag: 0 with group count: 9 into file: file:/tmp/wentingt/29cd3a88-c9cf-48c9-88c3-49e9ca194dae/hive_2018-02-12_11-12-38_541_6785565147860978572-1/-local-10005/HashTable-Stage-4/MapJoin-mapfile00--.hashtable
2018-02-12 11:13:15	Uploaded 1 File to: file:/tmp/wentingt/29cd3a88-c9cf-48c9-88c3-49e9ca194dae/hive_2018-02-12_11-12-38_541_6785565147860978572-1/-local-10005/HashTable-Stage-4/MapJoin-mapfile00--.hashtable (214462 bytes)
2018-02-12 11:13:15	End of local task; Time Taken: 2.327 sec.
Execution completed successfully
MapredLocal task succeeded
Launching Job 2 out of 2
Number of reduce tasks is set to 0 since there's no reduce operator
Starting Job = job_1518452786757_0137, Tracking URL = http://dc1master-lan1:8088/proxy/application_1518452786757_0137/
Kill Command = /users/wentingt/hadoop-3.0.0-beta1-src/hadoop-dist/target/hadoop-3.0.0-beta1/bin/hadoop job  -kill job_1518452786757_0137
Hadoop job information for Stage-4: number of mappers: 1; number of reducers: 0
2018-02-12 11:13:28,190 Stage-4 map = 0%,  reduce = 0%
2018-02-12 11:13:34,543 Stage-4 map = 100%,  reduce = 0%, Cumulative CPU 5.94 sec
MapReduce Total cumulative CPU time: 5 seconds 940 msec
Ended Job = job_1518452786757_0137
Moving data to directory hdfs://dc1master:9000/user/hive/warehouse/bigbench.db/q07_hive_run_query_0_temp
MapReduce Jobs Launched: 
Stage-Stage-3: Map: 1  Reduce: 1   Cumulative CPU: 12.52 sec   HDFS Read: 76572 HDFS Write: 433 SUCCESS
Stage-Stage-4: Map: 1   Cumulative CPU: 5.94 sec   HDFS Read: 6869 HDFS Write: 38187 SUCCESS
Total MapReduce CPU Time Spent: 18 seconds 460 msec
OK
Time taken: 57.942 seconds
hive.exec.compress.output=false
OK
Time taken: 0.012 seconds
OK
Time taken: 0.07 seconds
OK
STAGE DEPENDENCIES:
  Stage-21 is a root stage
  Stage-17 depends on stages: Stage-21
  Stage-16 depends on stages: Stage-17 , consists of Stage-19, Stage-20, Stage-2
  Stage-19 has a backup stage: Stage-2
  Stage-14 depends on stages: Stage-19
  Stage-18 depends on stages: Stage-2, Stage-14, Stage-15
  Stage-5 depends on stages: Stage-18
  Stage-6 depends on stages: Stage-5
  Stage-0 depends on stages: Stage-6
  Stage-7 depends on stages: Stage-0
  Stage-20 has a backup stage: Stage-2
  Stage-15 depends on stages: Stage-20
  Stage-2

STAGE PLANS:
  Stage: Stage-21
    Map Reduce Local Work
      Alias -> Map Local Tables:
        a 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        a 
          TableScan
            alias: a
            Statistics: Num rows: 49500 Data size: 55836000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ca_address_sk is not null and ca_state is not null) (type: boolean)
              Statistics: Num rows: 49500 Data size: 55836000 Basic stats: COMPLETE Column stats: NONE
              HashTable Sink Operator
                keys:
                  0 ca_address_sk (type: bigint)
                  1 c_current_addr_sk (type: bigint)

  Stage: Stage-17
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: c
            Statistics: Num rows: 99000 Data size: 88009812 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_current_addr_sk is not null and c_customer_sk is not null) (type: boolean)
              Statistics: Num rows: 99000 Data size: 88009812 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 ca_address_sk (type: bigint)
                  1 c_current_addr_sk (type: bigint)
                outputColumnNames: _col0, _col8, _col16, _col20
                Statistics: Num rows: 108900 Data size: 96810795 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-16
    Conditional Operator

  Stage: Stage-19
    Map Reduce Local Work
      Alias -> Map Local Tables:
        s 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        s 
          TableScan
            alias: s
            Statistics: Num rows: 667579 Data size: 953293700 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_customer_sk is not null and ss_item_sk is not null and ss_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 667579 Data size: 953293700 Basic stats: COMPLETE Column stats: NONE
              HashTable Sink Operator
                keys:
                  0 _col16 (type: bigint)
                  1 ss_customer_sk (type: bigint)

  Stage: Stage-14
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col16 (type: bigint)
                1 ss_customer_sk (type: bigint)
              outputColumnNames: _col0, _col8, _col16, _col20, _col37, _col39, _col40
              Statistics: Num rows: 734336 Data size: 1048623092 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-18
    Map Reduce Local Work
      Alias -> Map Local Tables:
        highpriceitems 
          Fetch Operator
            limit: -1
        sq_1:date_dim 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        highpriceitems 
          TableScan
            alias: highpriceitems
            Statistics: Num rows: 7086 Data size: 31006 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 7086 Data size: 31006 Basic stats: COMPLETE Column stats: NONE
              HashTable Sink Operator
                keys:
                  0 _col39 (type: bigint)
                  1 i_item_sk (type: bigint)
        sq_1:date_dim 
          TableScan
            alias: date_dim
            Statistics: Num rows: 109573 Data size: 123050479 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2004) and (d_moy = 7) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 27393 Data size: 30762339 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 27393 Data size: 30762339 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  keys: _col0 (type: bigint)
                  mode: hash
                  outputColumnNames: _col0
                  Statistics: Num rows: 27393 Data size: 30762339 Basic stats: COMPLETE Column stats: NONE
                  HashTable Sink Operator
                    keys:
                      0 _col37 (type: bigint)
                      1 _col0 (type: bigint)

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col39 (type: bigint)
                1 i_item_sk (type: bigint)
              outputColumnNames: _col0, _col8, _col16, _col20, _col37, _col39, _col40, _col63
              Statistics: Num rows: 807769 Data size: 1153485426 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Left Semi Join 0 to 1
                keys:
                  0 _col37 (type: bigint)
                  1 _col0 (type: bigint)
                outputColumnNames: _col0, _col8, _col16, _col20, _col39, _col40, _col63
                Statistics: Num rows: 888545 Data size: 1268833996 Basic stats: COMPLETE Column stats: NONE
                Filter Operator
                  predicate: ((_col0 = _col20) and (_col16 = _col40) and (_col39 = _col63)) (type: boolean)
                  Statistics: Num rows: 111068 Data size: 158604071 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col8 (type: string)
                    outputColumnNames: _col8
                    Statistics: Num rows: 111068 Data size: 158604071 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: count()
                      keys: _col8 (type: string)
                      mode: hash
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 111068 Data size: 158604071 Basic stats: COMPLETE Column stats: NONE
                      Reduce Output Operator
                        key expressions: _col0 (type: string)
                        sort order: +
                        Map-reduce partition columns: _col0 (type: string)
                        Statistics: Num rows: 111068 Data size: 158604071 Basic stats: COMPLETE Column stats: NONE
                        value expressions: _col1 (type: bigint)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0)
          keys: KEY._col0 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 55534 Data size: 79302035 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (_col1 >= 10) (type: boolean)
            Statistics: Num rows: 18511 Data size: 26433535 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: bigint), _col0 (type: string)
              sort order: -+
              Statistics: Num rows: 18511 Data size: 26433535 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey1 (type: string), KEY.reducesinkkey0 (type: bigint)
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 18511 Data size: 26433535 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 10
            Statistics: Num rows: 10 Data size: 14270 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 10 Data size: 14270 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.TextInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                  name: bigbench.q07_hive_run_query_0_result

  Stage: Stage-0
    Move Operator
      tables:
          replace: false
          table:
              input format: org.apache.hadoop.mapred.TextInputFormat
              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
              serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
              name: bigbench.q07_hive_run_query_0_result

  Stage: Stage-7
    Stats-Aggr Operator

  Stage: Stage-20
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col16 (type: bigint)
                1 ss_customer_sk (type: bigint)

  Stage: Stage-15
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: s
            Statistics: Num rows: 667579 Data size: 953293700 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_customer_sk is not null and ss_item_sk is not null and ss_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 667579 Data size: 953293700 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col16 (type: bigint)
                  1 ss_customer_sk (type: bigint)
                outputColumnNames: _col0, _col8, _col16, _col20, _col37, _col39, _col40
                Statistics: Num rows: 734336 Data size: 1048623092 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col16 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col16 (type: bigint)
              Statistics: Num rows: 108900 Data size: 96810795 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint), _col8 (type: string), _col20 (type: bigint)
          TableScan
            alias: s
            Statistics: Num rows: 667579 Data size: 953293700 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_customer_sk is not null and ss_item_sk is not null and ss_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 667579 Data size: 953293700 Basic stats: COMPLETE Column stats: NONE
              Reduce Output Operator
                key expressions: ss_customer_sk (type: bigint)
                sort order: +
                Map-reduce partition columns: ss_customer_sk (type: bigint)
                Statistics: Num rows: 667579 Data size: 953293700 Basic stats: COMPLETE Column stats: NONE
                value expressions: ss_sold_date_sk (type: bigint), ss_item_sk (type: bigint)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col16 (type: bigint)
            1 ss_customer_sk (type: bigint)
          outputColumnNames: _col0, _col8, _col16, _col20, _col37, _col39, _col40
          Statistics: Num rows: 734336 Data size: 1048623092 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

Time taken: 1.155 seconds, Fetched: 321 row(s)
OK
Time taken: 1.354 seconds
======= q07_hive_run_query_0 time =======
Start timestamp: 2018/02/12:12:12:26 1518459146
Stop  timestamp: 2018/02/12:12:13:39 1518459219
Duration:  0h 1m 13s
q07_hive_run_query_0 SUCCESS exit code: 0 
----- result -----
EMPTY  bytes: 0
to display: hadoop fs -cat /user/wentingt/benchmarks/bigbench/queryResults/q07_hive_run_query_0_result/*
----- logs -----
time&status: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/times.csv
full log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q07_hive_run_query_0.log
=========================
@@@/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q08/query08.sql
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q08/engineLocalSettings.sql to hive init.
===============================================
Running query : q08
-----------------------------------------------
benchmark phase: run_query
stream number  : 0
user parameter file: 
user settings file : 
log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q08_hive_run_query_0.log
===============================================
checking existence of local: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs
creating/cleaning/set permissions for hdfs tmp and result folders for this query
hdfs client: hadoop fs
Duration for hdfs prepare:  0h 0m 16s
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q08/engineLocalSettings.sql to hive init.
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/log4j-slf4j-impl-2.6.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/users/wentingt/hadoop-3.0.0-beta1-src/hadoop-dist/target/hadoop-3.0.0-beta1/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]

Logging initialized using configuration in jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/hive-common-2.3.2.jar!/hive-log4j2.properties Async: true
hive.execution.engine=mr
hive.cbo.enable=true
hive.stats.fetch.partition.stats=true
hive.script.operator.truncate.env=false
hive.compute.query.using.stats=true
hive.vectorized.execution.enabled=false
hive.vectorized.execution.reduce.enabled=true
hive.stats.autogather=true
mapreduce.input.fileinputformat.split.minsize=1
mapreduce.input.fileinputformat.split.maxsize=256000000
hive.exec.reducers.bytes.per.reducer=256000000
hive.exec.reducers.max=1009
hive.exec.parallel=false
hive.exec.parallel.thread.number=8
hive.exec.compress.intermediate=false
hive.exec.compress.output=false
mapred.map.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
mapred.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
hive.default.fileformat=TEXTFILE
hive.auto.convert.sortmerge.join=false
hive.auto.convert.sortmerge.join.noconditionaltask is undefined
hive.optimize.bucketmapjoin=false
hive.optimize.bucketmapjoin.sortedmerge=false
hive.auto.convert.join.noconditionaltask.size=10000000
hive.auto.convert.join=true
hive.optimize.mapjoin.mapreduce is undefined
hive.mapred.local.mem=0
hive.mapjoin.smalltable.filesize=25000000
hive.mapjoin.localtask.max.memory.usage=0.9
hive.optimize.skewjoin=false
hive.optimize.skewjoin.compiletime=false
hive.optimize.ppd=true
hive.optimize.ppd.storage=true
hive.ppd.recognizetransivity=true
hive.optimize.index.filter=false
hive.optimize.sampling.orderby=false
hive.optimize.sampling.orderby.number=1000
hive.optimize.sampling.orderby.percent=0.1
bigbench.hive.optimize.sampling.orderby=true
bigbench.hive.optimize.sampling.orderby.number=20000
bigbench.hive.optimize.sampling.orderby.percent=0.1
hive.groupby.skewindata=false
hive.exec.submit.local.task.via.child=true
Added resources: [/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q08/q08_filter_sales_with_reviews_viewed_before.py]
OK
Time taken: 0.065 seconds
OK
Time taken: 0.006 seconds
OK
Time taken: 0.006 seconds
WARNING: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = wentingt_20180212111409_090d4ab5-30a2-4fe2-8c61-d331100b8986
Total jobs = 3
Launching Job 1 out of 3
Number of reduce tasks is set to 0 since there's no reduce operator
Starting Job = job_1518452786757_0138, Tracking URL = http://dc1master-lan1:8088/proxy/application_1518452786757_0138/
Kill Command = /users/wentingt/hadoop-3.0.0-beta1-src/hadoop-dist/target/hadoop-3.0.0-beta1/bin/hadoop job  -kill job_1518452786757_0138
Hadoop job information for Stage-1: number of mappers: 1; number of reducers: 0
2018-02-12 11:14:26,514 Stage-1 map = 0%,  reduce = 0%
2018-02-12 11:14:33,849 Stage-1 map = 100%,  reduce = 0%, Cumulative CPU 6.69 sec
MapReduce Total cumulative CPU time: 6 seconds 690 msec
Ended Job = job_1518452786757_0138
Stage-4 is selected by condition resolver.
Stage-3 is filtered out by condition resolver.
Stage-5 is filtered out by condition resolver.
Moving data to directory hdfs://dc1master:9000/user/hive/warehouse/bigbench.db/.hive-staging_hive_2018-02-12_11-14-09_878_502734618316183483-1/-ext-10002
Moving data to directory hdfs://dc1master:9000/user/hive/warehouse/bigbench.db/q08_hive_run_query_0_temp_daterange
MapReduce Jobs Launched: 
Stage-Stage-1: Map: 1   Cumulative CPU: 6.69 sec   HDFS Read: 282600 HDFS Write: 2299 SUCCESS
Total MapReduce CPU Time Spent: 6 seconds 690 msec
OK
Time taken: 27.023 seconds
WARNING: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = wentingt_20180212111436_e366b0db-1fb0-4fb4-a668-1e103abac577
Total jobs = 2
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/log4j-slf4j-impl-2.6.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/users/wentingt/hadoop-3.0.0-beta1-src/hadoop-dist/target/hadoop-3.0.0-beta1/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
2018-02-12 11:14:43	Starting to launch local task to process map join;	maximum memory = 477626368
2018-02-12 11:14:45	Dump the side-table for tag: 1 with group count: 60 into file: file:/tmp/wentingt/aa3b55dd-af7f-4f15-96cd-e0df33a4c71e/hive_2018-02-12_11-14-36_913_5032305227289939693-1/-local-10006/HashTable-Stage-3/MapJoin-mapfile01--.hashtable
2018-02-12 11:14:45	Uploaded 1 File to: file:/tmp/wentingt/aa3b55dd-af7f-4f15-96cd-e0df33a4c71e/hive_2018-02-12_11-14-36_913_5032305227289939693-1/-local-10006/HashTable-Stage-3/MapJoin-mapfile01--.hashtable (1834 bytes)
2018-02-12 11:14:45	Dump the side-table for tag: 1 with group count: 366 into file: file:/tmp/wentingt/aa3b55dd-af7f-4f15-96cd-e0df33a4c71e/hive_2018-02-12_11-14-36_913_5032305227289939693-1/-local-10006/HashTable-Stage-3/MapJoin-mapfile11--.hashtable
2018-02-12 11:14:45	Uploaded 1 File to: file:/tmp/wentingt/aa3b55dd-af7f-4f15-96cd-e0df33a4c71e/hive_2018-02-12_11-14-36_913_5032305227289939693-1/-local-10006/HashTable-Stage-3/MapJoin-mapfile11--.hashtable (7615 bytes)
2018-02-12 11:14:45	End of local task; Time Taken: 2.216 sec.
Execution completed successfully
MapredLocal task succeeded
Launching Job 1 out of 2
Number of reduce tasks not specified. Estimated from input data size: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1518452786757_0139, Tracking URL = http://dc1master-lan1:8088/proxy/application_1518452786757_0139/
Kill Command = /users/wentingt/hadoop-3.0.0-beta1-src/hadoop-dist/target/hadoop-3.0.0-beta1/bin/hadoop job  -kill job_1518452786757_0139
Hadoop job information for Stage-3: number of mappers: 1; number of reducers: 1
2018-02-12 11:14:57,985 Stage-3 map = 0%,  reduce = 0%
2018-02-12 11:15:11,407 Stage-3 map = 100%,  reduce = 0%, Cumulative CPU 17.15 sec
2018-02-12 11:15:22,775 Stage-3 map = 100%,  reduce = 100%, Cumulative CPU 28.11 sec
MapReduce Total cumulative CPU time: 28 seconds 110 msec
Ended Job = job_1518452786757_0139
Launching Job 2 out of 2
Number of reduce tasks not specified. Estimated from input data size: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1518452786757_0140, Tracking URL = http://dc1master-lan1:8088/proxy/application_1518452786757_0140/
Kill Command = /users/wentingt/hadoop-3.0.0-beta1-src/hadoop-dist/target/hadoop-3.0.0-beta1/bin/hadoop job  -kill job_1518452786757_0140
Hadoop job information for Stage-4: number of mappers: 1; number of reducers: 1
2018-02-12 11:15:34,563 Stage-4 map = 0%,  reduce = 0%
2018-02-12 11:15:39,889 Stage-4 map = 100%,  reduce = 0%, Cumulative CPU 6.25 sec
2018-02-12 11:15:48,140 Stage-4 map = 100%,  reduce = 100%, Cumulative CPU 12.78 sec
MapReduce Total cumulative CPU time: 12 seconds 780 msec
Ended Job = job_1518452786757_0140
Moving data to directory hdfs://dc1master:9000/user/hive/warehouse/bigbench.db/q08_hive_run_query_0_temp_sales_review
MapReduce Jobs Launched: 
Stage-Stage-3: Map: 1  Reduce: 1   Cumulative CPU: 28.11 sec   HDFS Read: 22729259 HDFS Write: 173056 SUCCESS
Stage-Stage-4: Map: 1  Reduce: 1   Cumulative CPU: 12.78 sec   HDFS Read: 177653 HDFS Write: 51990 SUCCESS
Total MapReduce CPU Time Spent: 40 seconds 890 msec
OK
Time taken: 72.623 seconds
WARNING: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = wentingt_20180212111549_b1f9beb6-0c2f-49f3-a924-ff355c6af82c
Total jobs = 1
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/log4j-slf4j-impl-2.6.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/users/wentingt/hadoop-3.0.0-beta1-src/hadoop-dist/target/hadoop-3.0.0-beta1/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
2018-02-12 11:15:55	Starting to launch local task to process map join;	maximum memory = 477626368
2018-02-12 11:15:57	Dump the side-table for tag: 1 with group count: 366 into file: file:/tmp/wentingt/aa3b55dd-af7f-4f15-96cd-e0df33a4c71e/hive_2018-02-12_11-15-49_550_6217961660470507521-1/-local-10004/HashTable-Stage-4/MapJoin-mapfile21--.hashtable
2018-02-12 11:15:57	Uploaded 1 File to: file:/tmp/wentingt/aa3b55dd-af7f-4f15-96cd-e0df33a4c71e/hive_2018-02-12_11-15-49_550_6217961660470507521-1/-local-10004/HashTable-Stage-4/MapJoin-mapfile21--.hashtable (7615 bytes)
2018-02-12 11:15:57	End of local task; Time Taken: 2.136 sec.
Execution completed successfully
MapredLocal task succeeded
Launching Job 1 out of 1
Number of reduce tasks is set to 0 since there's no reduce operator
Starting Job = job_1518452786757_0141, Tracking URL = http://dc1master-lan1:8088/proxy/application_1518452786757_0141/
Kill Command = /users/wentingt/hadoop-3.0.0-beta1-src/hadoop-dist/target/hadoop-3.0.0-beta1/bin/hadoop job  -kill job_1518452786757_0141
Hadoop job information for Stage-4: number of mappers: 1; number of reducers: 0
2018-02-12 11:16:08,971 Stage-4 map = 0%,  reduce = 0%
2018-02-12 11:16:17,224 Stage-4 map = 100%,  reduce = 0%, Cumulative CPU 9.18 sec
MapReduce Total cumulative CPU time: 9 seconds 180 msec
Ended Job = job_1518452786757_0141
Moving data to directory hdfs://dc1master:9000/user/hive/warehouse/bigbench.db/q08_hive_run_query_0_temp_websales_date
MapReduce Jobs Launched: 
Stage-Stage-4: Map: 1   Cumulative CPU: 9.18 sec   HDFS Read: 2226047 HDFS Write: 1813285 SUCCESS
Total MapReduce CPU Time Spent: 9 seconds 180 msec
OK
Time taken: 29.07 seconds
hive.exec.compress.output=false
OK
Time taken: 0.006 seconds
OK
Time taken: 0.054 seconds
No Stats for bigbench@q08_hive_run_query_0_temp_websales_date, Columns: ws_order_number, ws_net_paid
No Stats for bigbench@q08_hive_run_query_0_temp_sales_review, Columns: wcs_sales_sk
No Stats for bigbench@q08_hive_run_query_0_temp_websales_date, Columns: ws_net_paid
Warning: Map Join MAPJOIN[37][bigTable=?] in task 'Stage-8:MAPRED' is a cross product
Warning: Map Join MAPJOIN[36][bigTable=?] in task 'Stage-7:MAPRED' is a cross product
Warning: Shuffle Join JOIN[24][tables = [$hdt$_0, $hdt$_1]] in Stage 'Stage-3:MAPRED' is a cross product
OK
STAGE DEPENDENCIES:
  Stage-6 is a root stage
  Stage-9 depends on stages: Stage-2, Stage-6 , consists of Stage-11, Stage-12, Stage-3
  Stage-11 has a backup stage: Stage-3
  Stage-7 depends on stages: Stage-11
  Stage-0 depends on stages: Stage-3, Stage-7, Stage-8
  Stage-4 depends on stages: Stage-0
  Stage-12 has a backup stage: Stage-3
  Stage-8 depends on stages: Stage-12
  Stage-3
  Stage-13 is a root stage
  Stage-2 depends on stages: Stage-13

STAGE PLANS:
  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: allsalesinyear
            Statistics: Num rows: 135053 Data size: 1678119 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: ws_net_paid (type: decimal(7,2))
              outputColumnNames: ws_net_paid
              Statistics: Num rows: 135053 Data size: 1678119 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: sum(ws_net_paid)
                mode: hash
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  sort order: 
                  Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: decimal(17,2))
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-9
    Conditional Operator

  Stage: Stage-11
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 
                1 
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 1 Data size: 225 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: UDFToLong(_col0) (type: bigint), UDFToLong((_col1 - _col0)) (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1 Data size: 225 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  Statistics: Num rows: 1 Data size: 225 Basic stats: COMPLETE Column stats: NONE
                  table:
                      input format: org.apache.hadoop.mapred.TextInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                      name: bigbench.q08_hive_run_query_0_result
      Local Work:
        Map Reduce Local Work

  Stage: Stage-0
    Move Operator
      tables:
          replace: false
          table:
              input format: org.apache.hadoop.mapred.TextInputFormat
              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
              serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
              name: bigbench.q08_hive_run_query_0_result

  Stage: Stage-4
    Stats-Aggr Operator

  Stage: Stage-12
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 
                1 
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 1 Data size: 225 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: UDFToLong(_col0) (type: bigint), UDFToLong((_col1 - _col0)) (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1 Data size: 225 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  Statistics: Num rows: 1 Data size: 225 Basic stats: COMPLETE Column stats: NONE
                  table:
                      input format: org.apache.hadoop.mapred.TextInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                      name: bigbench.q08_hive_run_query_0_result
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: decimal(17,2))
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: decimal(17,2))
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 
            1 
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 1 Data size: 225 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: UDFToLong(_col0) (type: bigint), UDFToLong((_col1 - _col0)) (type: bigint)
            outputColumnNames: _col0, _col1
            Statistics: Num rows: 1 Data size: 225 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 1 Data size: 225 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.TextInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                  name: bigbench.q08_hive_run_query_0_result

  Stage: Stage-13
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:saleswithviewedreviews 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:saleswithviewedreviews 
          TableScan
            alias: saleswithviewedreviews
            Statistics: Num rows: 8647 Data size: 43235 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: wcs_sales_sk is not null (type: boolean)
              Statistics: Num rows: 8647 Data size: 43235 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: wcs_sales_sk (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 8647 Data size: 43235 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  keys: _col0 (type: bigint)
                  mode: hash
                  outputColumnNames: _col0
                  Statistics: Num rows: 8647 Data size: 43235 Basic stats: COMPLETE Column stats: NONE
                  HashTable Sink Operator
                    keys:
                      0 _col1 (type: bigint)
                      1 _col0 (type: bigint)

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: allsalesinyear
            Statistics: Num rows: 135053 Data size: 1678119 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ws_order_number is not null (type: boolean)
              Statistics: Num rows: 135053 Data size: 1678119 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_net_paid (type: decimal(7,2)), ws_order_number (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 135053 Data size: 1678119 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Left Semi Join 0 to 1
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col0
                  Statistics: Num rows: 148558 Data size: 1845930 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    aggregations: sum(_col0)
                    mode: hash
                    outputColumnNames: _col0
                    Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      sort order: 
                      Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: NONE
                      value expressions: _col0 (type: decimal(17,2))
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

Time taken: 0.939 seconds, Fetched: 252 row(s)
OK
Time taken: 1.605 seconds
OK
Time taken: 0.082 seconds
OK
Time taken: 0.088 seconds
======= q08_hive_run_query_0 time =======
Start timestamp: 2018/02/12:12:13:57 1518459238
Stop  timestamp: 2018/02/12:12:16:21 1518459381
Duration:  0h 2m 23s
q08_hive_run_query_0 SUCCESS exit code: 0 
----- result -----
EMPTY  bytes: 0
to display: hadoop fs -cat /user/wentingt/benchmarks/bigbench/queryResults/q08_hive_run_query_0_result/*
----- logs -----
time&status: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/times.csv
full log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q08_hive_run_query_0.log
=========================
@@@/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q09/query09.sql
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q09/engineLocalSettings.sql to hive init.
===============================================
Running query : q09
-----------------------------------------------
benchmark phase: run_query
stream number  : 0
user parameter file: 
user settings file : 
log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q09_hive_run_query_0.log
===============================================
checking existence of local: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs
creating/cleaning/set permissions for hdfs tmp and result folders for this query
hdfs client: hadoop fs
Duration for hdfs prepare:  0h 0m 17s
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q09/engineLocalSettings.sql to hive init.
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/log4j-slf4j-impl-2.6.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/users/wentingt/hadoop-3.0.0-beta1-src/hadoop-dist/target/hadoop-3.0.0-beta1/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]

Logging initialized using configuration in jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/hive-common-2.3.2.jar!/hive-log4j2.properties Async: true
hive.execution.engine=mr
hive.cbo.enable=true
hive.stats.fetch.partition.stats=true
hive.script.operator.truncate.env=false
hive.compute.query.using.stats=true
hive.vectorized.execution.enabled=false
hive.vectorized.execution.reduce.enabled=true
hive.stats.autogather=true
mapreduce.input.fileinputformat.split.minsize=1
mapreduce.input.fileinputformat.split.maxsize=256000000
hive.exec.reducers.bytes.per.reducer=256000000
hive.exec.reducers.max=1009
hive.exec.parallel=false
hive.exec.parallel.thread.number=8
hive.exec.compress.intermediate=false
hive.exec.compress.output=false
mapred.map.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
mapred.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
hive.default.fileformat=TEXTFILE
hive.auto.convert.sortmerge.join=false
hive.auto.convert.sortmerge.join.noconditionaltask is undefined
hive.optimize.bucketmapjoin=false
hive.optimize.bucketmapjoin.sortedmerge=false
hive.auto.convert.join.noconditionaltask.size=10000000
hive.auto.convert.join=true
hive.optimize.mapjoin.mapreduce is undefined
hive.mapred.local.mem=0
hive.mapjoin.smalltable.filesize=25000000
hive.mapjoin.localtask.max.memory.usage=0.9
hive.optimize.skewjoin=false
hive.optimize.skewjoin.compiletime=false
hive.optimize.ppd=true
hive.optimize.ppd.storage=true
hive.ppd.recognizetransivity=true
hive.optimize.index.filter=false
hive.optimize.sampling.orderby=false
hive.optimize.sampling.orderby.number=1000
hive.optimize.sampling.orderby.percent=0.1
bigbench.hive.optimize.sampling.orderby=true
bigbench.hive.optimize.sampling.orderby.number=20000
bigbench.hive.optimize.sampling.orderby.percent=0.1
hive.groupby.skewindata=false
hive.exec.submit.local.task.via.child=true
hive.exec.compress.output=false
OK
Time taken: 0.067 seconds
OK
Time taken: 0.446 seconds
No Stats for bigbench@store_sales, Columns: ss_cdemo_sk, ss_net_profit, ss_addr_sk, ss_sold_date_sk, ss_store_sk, ss_quantity, ss_sales_price
No Stats for bigbench@date_dim, Columns: d_date_sk, d_year
No Stats for bigbench@customer_address, Columns: ca_state, ca_address_sk, ca_country
No Stats for bigbench@store, Columns: s_store_sk
No Stats for bigbench@customer_demographics, Columns: cd_demo_sk, cd_education_status, cd_marital_status
OK
STAGE DEPENDENCIES:
  Stage-15 is a root stage
  Stage-5 depends on stages: Stage-15
  Stage-0 depends on stages: Stage-5
  Stage-6 depends on stages: Stage-0

STAGE PLANS:
  Stage: Stage-15
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:dd 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_2:ca1 
          Fetch Operator
            limit: -1
        $hdt$_1:s 
          Fetch Operator
            limit: -1
        $hdt$_2:cd 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:dd 
          TableScan
            alias: dd
            Statistics: Num rows: 109573 Data size: 123050479 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2001) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 54786 Data size: 61524678 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 54786 Data size: 61524678 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)
        $hdt$_0:$hdt$_2:ca1 
          TableScan
            alias: ca1
            Statistics: Num rows: 49500 Data size: 55836000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_country = 'United States') and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 24750 Data size: 27918000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: bigint), ca_state (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 24750 Data size: 27918000 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: bigint)
                    1 _col0 (type: bigint)
        $hdt$_1:s 
          TableScan
            alias: s
            Statistics: Num rows: 12 Data size: 25956 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: s_store_sk is not null (type: boolean)
              Statistics: Num rows: 12 Data size: 25956 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 12 Data size: 25956 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: bigint)
                    1 _col0 (type: bigint)
        $hdt$_2:cd 
          TableScan
            alias: cd
            Statistics: Num rows: 1920800 Data size: 718371044 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((cd_marital_status = 'M') and (cd_education_status = '4 yr Degree') and cd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 480200 Data size: 179592761 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: cd_demo_sk (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 480200 Data size: 179592761 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: ss1
            Statistics: Num rows: 667579 Data size: 953293700 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((((100 <= ss_sales_price) and (ss_sales_price <= 150)) or ((50 <= ss_sales_price) and (ss_sales_price <= 200)) or ((150 <= ss_sales_price) and (ss_sales_price <= 200))) and ss_sold_date_sk is not null and ss_addr_sk is not null and ss_store_sk is not null and ss_cdemo_sk is not null) (type: boolean)
              Statistics: Num rows: 222525 Data size: 317762662 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: bigint), ss_cdemo_sk (type: bigint), ss_addr_sk (type: bigint), ss_store_sk (type: bigint), ss_quantity (type: int), ss_net_profit (type: decimal(7,2))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col6
                Statistics: Num rows: 222525 Data size: 317762662 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col1, _col2, _col3, _col4, _col6
                  Statistics: Num rows: 244777 Data size: 349538935 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col2 (type: bigint)
                      1 _col0 (type: bigint)
                    outputColumnNames: _col1, _col3, _col4, _col6, _col10
                    Statistics: Num rows: 269254 Data size: 384492836 Basic stats: COMPLETE Column stats: NONE
                    Filter Operator
                      predicate: (((_col10) IN ('KY', 'GA', 'NM') and (0 <= _col6) and (_col6 <= 2000)) or ((_col10) IN ('MT', 'OR', 'IN') and (150 <= _col6) and (_col6 <= 3000)) or ((_col10) IN ('WI', 'MO', 'WV') and (50 <= _col6) and (_col6 <= 25000))) (type: boolean)
                      Statistics: Num rows: 44874 Data size: 64079759 Basic stats: COMPLETE Column stats: NONE
                      Select Operator
                        expressions: _col1 (type: bigint), _col3 (type: bigint), _col4 (type: int)
                        outputColumnNames: _col1, _col3, _col4
                        Statistics: Num rows: 44874 Data size: 64079759 Basic stats: COMPLETE Column stats: NONE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col3 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col1, _col4
                          Statistics: Num rows: 49361 Data size: 70487736 Basic stats: COMPLETE Column stats: NONE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col1 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col4
                            Statistics: Num rows: 528220 Data size: 197552041 Basic stats: COMPLETE Column stats: NONE
                            Group By Operator
                              aggregations: sum(_col4)
                              mode: hash
                              outputColumnNames: _col0
                              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                              Reduce Output Operator
                                sort order: 
                                Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                                value expressions: _col0 (type: bigint)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: CAST( _col0 AS decimal(15,0)) (type: decimal(15,0))
            outputColumnNames: _col0
            Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.TextInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                  name: bigbench.q09_hive_run_query_0_result

  Stage: Stage-0
    Move Operator
      tables:
          replace: false
          table:
              input format: org.apache.hadoop.mapred.TextInputFormat
              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
              serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
              name: bigbench.q09_hive_run_query_0_result

  Stage: Stage-6
    Stats-Aggr Operator

Time taken: 3.645 seconds, Fetched: 179 row(s)
======= q09_hive_run_query_0 time =======
Start timestamp: 2018/02/12:12:16:40 1518459400
Stop  timestamp: 2018/02/12:12:16:57 1518459417
Duration:  0h 0m 17s
q09_hive_run_query_0 SUCCESS exit code: 0 
----- result -----
EMPTY  bytes: 0
to display: hadoop fs -cat /user/wentingt/benchmarks/bigbench/queryResults/q09_hive_run_query_0_result/*
----- logs -----
time&status: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/times.csv
full log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q09_hive_run_query_0.log
=========================
@@@/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q10/query10.sql
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q10/engineLocalSettings.sql to hive init.
===============================================
Running query : q10
-----------------------------------------------
benchmark phase: run_query
stream number  : 0
user parameter file: 
user settings file : 
log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q10_hive_run_query_0.log
===============================================
checking existence of local: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs
creating/cleaning/set permissions for hdfs tmp and result folders for this query
hdfs client: hadoop fs
Duration for hdfs prepare:  0h 0m 17s
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q10/engineLocalSettings.sql to hive init.
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/log4j-slf4j-impl-2.6.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/users/wentingt/hadoop-3.0.0-beta1-src/hadoop-dist/target/hadoop-3.0.0-beta1/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]

Logging initialized using configuration in jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/hive-common-2.3.2.jar!/hive-log4j2.properties Async: true
hive.execution.engine=mr
hive.cbo.enable=true
hive.stats.fetch.partition.stats=true
hive.script.operator.truncate.env=false
hive.compute.query.using.stats=true
hive.vectorized.execution.enabled=false
hive.vectorized.execution.reduce.enabled=true
hive.stats.autogather=true
mapreduce.input.fileinputformat.split.minsize=1
mapreduce.input.fileinputformat.split.maxsize=256000000
hive.exec.reducers.bytes.per.reducer=256000000
hive.exec.reducers.max=1009
hive.exec.parallel=false
hive.exec.parallel.thread.number=8
hive.exec.compress.intermediate=false
hive.exec.compress.output=false
mapred.map.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
mapred.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
hive.default.fileformat=TEXTFILE
hive.auto.convert.sortmerge.join=false
hive.auto.convert.sortmerge.join.noconditionaltask is undefined
hive.optimize.bucketmapjoin=false
hive.optimize.bucketmapjoin.sortedmerge=false
hive.auto.convert.join.noconditionaltask.size=10000000
hive.auto.convert.join=true
hive.optimize.mapjoin.mapreduce is undefined
hive.mapred.local.mem=0
hive.mapjoin.smalltable.filesize=25000000
hive.mapjoin.localtask.max.memory.usage=0.9
hive.optimize.skewjoin=false
hive.optimize.skewjoin.compiletime=false
hive.optimize.ppd=true
hive.optimize.ppd.storage=true
hive.ppd.recognizetransivity=true
hive.optimize.index.filter=false
hive.optimize.sampling.orderby=false
hive.optimize.sampling.orderby.number=1000
hive.optimize.sampling.orderby.percent=0.1
bigbench.hive.optimize.sampling.orderby=true
bigbench.hive.optimize.sampling.orderby.number=20000
bigbench.hive.optimize.sampling.orderby.percent=0.1
hive.groupby.skewindata=false
hive.exec.submit.local.task.via.child=true
Added [/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/Resources/opennlp-maxent-3.0.3.jar] to class path
Added resources: [/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/Resources/opennlp-maxent-3.0.3.jar]
Added [/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/Resources/opennlp-tools-1.6.0.jar] to class path
Added resources: [/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/Resources/opennlp-tools-1.6.0.jar]
Added [/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/Resources/bigbenchqueriesmr.jar] to class path
Added resources: [/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/Resources/bigbenchqueriesmr.jar]
initialize io.bigdatabenchmark.v1.queries.q10.SentimentUDF()
initialize io.bigdatabenchmark.v1.queries.q10.SentimentUDF() done
OK
Time taken: 0.197 seconds
hive.exec.compress.output=false
hive.optimize.sampling.orderby=true
hive.optimize.sampling.orderby.number=20000
hive.optimize.sampling.orderby.percent=0.1
OK
Time taken: 0.083 seconds
OK
Time taken: 0.537 seconds
initialize io.bigdatabenchmark.v1.queries.q10.SentimentUDF()
initialize io.bigdatabenchmark.v1.queries.q10.SentimentUDF() done
initialize io.bigdatabenchmark.v1.queries.q10.SentimentUDF()
initialize io.bigdatabenchmark.v1.queries.q10.SentimentUDF() done
initialize() io.bigdatabenchmark.v1.queries.q10.SentimentUDF
initialize() io.bigdatabenchmark.v1.queries.q10.SentimentUDF done
initialize io.bigdatabenchmark.v1.queries.q10.SentimentUDF()
initialize io.bigdatabenchmark.v1.queries.q10.SentimentUDF() done
initialize() io.bigdatabenchmark.v1.queries.q10.SentimentUDF
initialize() io.bigdatabenchmark.v1.queries.q10.SentimentUDF done
OK
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1
  Stage-2 depends on stages: Stage-0

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: product_reviews
            Statistics: Num rows: 89991 Data size: 79597045 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: pr_item_sk (type: bigint), pr_review_content (type: string)
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 89991 Data size: 79597045 Basic stats: COMPLETE Column stats: NONE
              UDTF Operator
                Statistics: Num rows: 89991 Data size: 79597045 Basic stats: COMPLETE Column stats: NONE
                function name: io.bigdatabenchmark.v1.queries.q10.SentimentUDF@3ee200ae
                Select Operator
                  expressions: item_sk (type: bigint), sentence (type: string), sentiment (type: string), sentiment_word (type: string)
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 89991 Data size: 79597045 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: bigint), _col1 (type: string), _col2 (type: string), _col3 (type: string)
                    sort order: ++++
                    Statistics: Num rows: 89991 Data size: 79597045 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: string), KEY.reducesinkkey2 (type: string), KEY.reducesinkkey3 (type: string)
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 89991 Data size: 79597045 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 89991 Data size: 79597045 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.TextInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                name: bigbench.q10_hive_run_query_0_result

  Stage: Stage-0
    Move Operator
      tables:
          replace: false
          table:
              input format: org.apache.hadoop.mapred.TextInputFormat
              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
              serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
              name: bigbench.q10_hive_run_query_0_result

  Stage: Stage-2
    Stats-Aggr Operator

Time taken: 2.252 seconds, Fetched: 54 row(s)
======= q10_hive_run_query_0 time =======
Start timestamp: 2018/02/12:12:17:16 1518459436
Stop  timestamp: 2018/02/12:12:17:31 1518459451
Duration:  0h 0m 15s
q10_hive_run_query_0 SUCCESS exit code: 0 
----- result -----
EMPTY  bytes: 0
to display: hadoop fs -cat /user/wentingt/benchmarks/bigbench/queryResults/q10_hive_run_query_0_result/*
----- logs -----
time&status: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/times.csv
full log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q10_hive_run_query_0.log
=========================
@@@/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q11/query11.sql
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q11/engineLocalSettings.sql to hive init.
===============================================
Running query : q11
-----------------------------------------------
benchmark phase: run_query
stream number  : 0
user parameter file: 
user settings file : 
log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q11_hive_run_query_0.log
===============================================
checking existence of local: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs
creating/cleaning/set permissions for hdfs tmp and result folders for this query
hdfs client: hadoop fs
Duration for hdfs prepare:  0h 0m 17s
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q11/engineLocalSettings.sql to hive init.
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/log4j-slf4j-impl-2.6.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/users/wentingt/hadoop-3.0.0-beta1-src/hadoop-dist/target/hadoop-3.0.0-beta1/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]

Logging initialized using configuration in jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/hive-common-2.3.2.jar!/hive-log4j2.properties Async: true
hive.execution.engine=mr
hive.cbo.enable=true
hive.stats.fetch.partition.stats=true
hive.script.operator.truncate.env=false
hive.compute.query.using.stats=true
hive.vectorized.execution.enabled=false
hive.vectorized.execution.reduce.enabled=true
hive.stats.autogather=true
mapreduce.input.fileinputformat.split.minsize=1
mapreduce.input.fileinputformat.split.maxsize=256000000
hive.exec.reducers.bytes.per.reducer=256000000
hive.exec.reducers.max=1009
hive.exec.parallel=false
hive.exec.parallel.thread.number=8
hive.exec.compress.intermediate=false
hive.exec.compress.output=false
mapred.map.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
mapred.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
hive.default.fileformat=TEXTFILE
hive.auto.convert.sortmerge.join=false
hive.auto.convert.sortmerge.join.noconditionaltask is undefined
hive.optimize.bucketmapjoin=false
hive.optimize.bucketmapjoin.sortedmerge=false
hive.auto.convert.join.noconditionaltask.size=10000000
hive.auto.convert.join=true
hive.optimize.mapjoin.mapreduce is undefined
hive.mapred.local.mem=0
hive.mapjoin.smalltable.filesize=25000000
hive.mapjoin.localtask.max.memory.usage=0.9
hive.optimize.skewjoin=false
hive.optimize.skewjoin.compiletime=false
hive.optimize.ppd=true
hive.optimize.ppd.storage=true
hive.ppd.recognizetransivity=true
hive.optimize.index.filter=false
hive.optimize.sampling.orderby=false
hive.optimize.sampling.orderby.number=1000
hive.optimize.sampling.orderby.percent=0.1
bigbench.hive.optimize.sampling.orderby=true
bigbench.hive.optimize.sampling.orderby.number=20000
bigbench.hive.optimize.sampling.orderby.percent=0.1
hive.groupby.skewindata=false
hive.exec.submit.local.task.via.child=true
hive.exec.compress.output=false
OK
Time taken: 0.067 seconds
OK
Time taken: 0.422 seconds
No Stats for bigbench@product_reviews, Columns: pr_review_rating, pr_item_sk
No Stats for bigbench@web_sales, Columns: ws_item_sk, ws_sold_date_sk, ws_net_paid
No Stats for bigbench@date_dim, Columns: d_date, d_date_sk
OK
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-10 depends on stages: Stage-1, Stage-6 , consists of Stage-12, Stage-13, Stage-2
  Stage-12 has a backup stage: Stage-2
  Stage-8 depends on stages: Stage-12
  Stage-3 depends on stages: Stage-2, Stage-8, Stage-9
  Stage-0 depends on stages: Stage-3
  Stage-4 depends on stages: Stage-0
  Stage-13 has a backup stage: Stage-2
  Stage-9 depends on stages: Stage-13
  Stage-2
  Stage-14 is a root stage
  Stage-6 depends on stages: Stage-14

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: product_reviews
            Statistics: Num rows: 89991 Data size: 79597045 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: pr_item_sk is not null (type: boolean)
              Statistics: Num rows: 89991 Data size: 79597045 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: pr_item_sk (type: bigint), pr_review_rating (type: int)
                outputColumnNames: pr_item_sk, pr_review_rating
                Statistics: Num rows: 89991 Data size: 79597045 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: count(), avg(pr_review_rating)
                  keys: pr_item_sk (type: bigint)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 89991 Data size: 79597045 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: bigint)
                    sort order: +
                    Map-reduce partition columns: _col0 (type: bigint)
                    Statistics: Num rows: 89991 Data size: 79597045 Basic stats: COMPLETE Column stats: NONE
                    value expressions: _col1 (type: bigint), _col2 (type: struct<count:bigint,sum:double,input:int>)
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0), avg(VALUE._col1)
          keys: KEY._col0 (type: bigint)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 44995 Data size: 39798080 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-10
    Conditional Operator

  Stage: Stage-12
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint)
                1 _col0 (type: bigint)

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: bigint)
                1 _col0 (type: bigint)
              outputColumnNames: _col1, _col2
              Statistics: Num rows: 404170 Data size: 738809832 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: corr(_col1, _col2)
                mode: hash
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 128 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 128 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: struct<count:bigint,xavg:double,yavg:double,xvar:double,yvar:double,covar:double>)
      Reduce Operator Tree:
        Group By Operator
          aggregations: corr(VALUE._col0)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 128 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: CAST( _col0 AS decimal(15,7)) (type: decimal(15,7))
            outputColumnNames: _col0
            Statistics: Num rows: 1 Data size: 128 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 1 Data size: 128 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.TextInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                  name: bigbench.q11_hive_run_query_0_result

  Stage: Stage-0
    Move Operator
      tables:
          replace: false
          table:
              input format: org.apache.hadoop.mapred.TextInputFormat
              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
              serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
              name: bigbench.q11_hive_run_query_0_result

  Stage: Stage-4
    Stats-Aggr Operator

  Stage: Stage-13
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint)
                1 _col0 (type: bigint)

  Stage: Stage-9
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: bigint)
                1 _col0 (type: bigint)
              outputColumnNames: _col1, _col2
              Statistics: Num rows: 404170 Data size: 738809832 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: corr(_col1, _col2)
                mode: hash
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 128 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 44995 Data size: 39798080 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: bigint), _col2 (type: double)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 367428 Data size: 671645288 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: bigint)
            1 _col0 (type: bigint)
          outputColumnNames: _col1, _col2
          Statistics: Num rows: 404170 Data size: 738809832 Basic stats: COMPLETE Column stats: NONE
          Group By Operator
            aggregations: corr(_col1, _col2)
            mode: hash
            outputColumnNames: _col0
            Statistics: Num rows: 1 Data size: 128 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-14
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_2:d 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_2:d 
          TableScan
            alias: d
            Statistics: Num rows: 109573 Data size: 123050479 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_date >= '2003-01-02') and (d_date <= '2003-02-02') and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 12174 Data size: 13671402 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 12174 Data size: 13671402 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  keys: _col0 (type: bigint)
                  mode: hash
                  outputColumnNames: _col0
                  Statistics: Num rows: 12174 Data size: 13671402 Basic stats: COMPLETE Column stats: NONE
                  HashTable Sink Operator
                    keys:
                      0 _col0 (type: bigint)
                      1 _col0 (type: bigint)

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: ws
            Statistics: Num rows: 668052 Data size: 1221174888 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_sold_date_sk is not null and ws_item_sk is not null) (type: boolean)
              Statistics: Num rows: 668052 Data size: 1221174888 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_sold_date_sk (type: bigint), ws_item_sk (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 668052 Data size: 1221174888 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Left Semi Join 0 to 1
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col1
                  Statistics: Num rows: 734857 Data size: 1343292405 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    keys: _col1 (type: bigint)
                    mode: hash
                    outputColumnNames: _col0
                    Statistics: Num rows: 734857 Data size: 1343292405 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 734857 Data size: 1343292405 Basic stats: COMPLETE Column stats: NONE
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: bigint)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 367428 Data size: 671645288 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

Time taken: 3.005 seconds, Fetched: 288 row(s)
======= q11_hive_run_query_0 time =======
Start timestamp: 2018/02/12:12:17:50 1518459470
Stop  timestamp: 2018/02/12:12:18:06 1518459486
Duration:  0h 0m 16s
q11_hive_run_query_0 SUCCESS exit code: 0 
----- result -----
EMPTY  bytes: 0
to display: hadoop fs -cat /user/wentingt/benchmarks/bigbench/queryResults/q11_hive_run_query_0_result/*
----- logs -----
time&status: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/times.csv
full log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q11_hive_run_query_0.log
=========================
@@@/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q12/query12.sql
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q12/engineLocalSettings.sql to hive init.
===============================================
Running query : q12
-----------------------------------------------
benchmark phase: run_query
stream number  : 0
user parameter file: 
user settings file : 
log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q12_hive_run_query_0.log
===============================================
checking existence of local: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs
creating/cleaning/set permissions for hdfs tmp and result folders for this query
hdfs client: hadoop fs
Duration for hdfs prepare:  0h 0m 17s
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q12/engineLocalSettings.sql to hive init.
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/log4j-slf4j-impl-2.6.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/users/wentingt/hadoop-3.0.0-beta1-src/hadoop-dist/target/hadoop-3.0.0-beta1/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]

Logging initialized using configuration in jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/hive-common-2.3.2.jar!/hive-log4j2.properties Async: true
hive.execution.engine=mr
hive.cbo.enable=true
hive.stats.fetch.partition.stats=true
hive.script.operator.truncate.env=false
hive.compute.query.using.stats=true
hive.vectorized.execution.enabled=false
hive.vectorized.execution.reduce.enabled=true
hive.stats.autogather=true
mapreduce.input.fileinputformat.split.minsize=1
mapreduce.input.fileinputformat.split.maxsize=256000000
hive.exec.reducers.bytes.per.reducer=256000000
hive.exec.reducers.max=1009
hive.exec.parallel=false
hive.exec.parallel.thread.number=8
hive.exec.compress.intermediate=false
hive.exec.compress.output=false
mapred.map.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
mapred.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
hive.default.fileformat=TEXTFILE
hive.auto.convert.sortmerge.join=false
hive.auto.convert.sortmerge.join.noconditionaltask is undefined
hive.optimize.bucketmapjoin=false
hive.optimize.bucketmapjoin.sortedmerge=false
hive.auto.convert.join.noconditionaltask.size=10000000
hive.auto.convert.join=true
hive.optimize.mapjoin.mapreduce is undefined
hive.mapred.local.mem=0
hive.mapjoin.smalltable.filesize=25000000
hive.mapjoin.localtask.max.memory.usage=0.9
hive.optimize.skewjoin=false
hive.optimize.skewjoin.compiletime=false
hive.optimize.ppd=true
hive.optimize.ppd.storage=true
hive.ppd.recognizetransivity=true
hive.optimize.index.filter=false
hive.optimize.sampling.orderby=false
hive.optimize.sampling.orderby.number=1000
hive.optimize.sampling.orderby.percent=0.1
bigbench.hive.optimize.sampling.orderby=true
bigbench.hive.optimize.sampling.orderby.number=20000
bigbench.hive.optimize.sampling.orderby.percent=0.1
hive.groupby.skewindata=false
hive.exec.submit.local.task.via.child=true
hive.exec.compress.output=false
hive.optimize.sampling.orderby=true
hive.optimize.sampling.orderby.number=20000
hive.optimize.sampling.orderby.percent=0.1
OK
Time taken: 0.067 seconds
OK
Time taken: 0.54 seconds
No Stats for bigbench@web_clickstreams, Columns: wcs_click_date_sk, wcs_item_sk, wcs_user_sk, wcs_sales_sk
No Stats for bigbench@item, Columns: i_category, i_item_sk
No Stats for bigbench@store_sales, Columns: ss_customer_sk, ss_sold_date_sk, ss_item_sk
No Stats for bigbench@item, Columns: i_category, i_item_sk
OK
STAGE DEPENDENCIES:
  Stage-16 is a root stage
  Stage-12 depends on stages: Stage-16
  Stage-11 depends on stages: Stage-12, Stage-13 , consists of Stage-14, Stage-15, Stage-2
  Stage-14 has a backup stage: Stage-2
  Stage-9 depends on stages: Stage-14
  Stage-3 depends on stages: Stage-2, Stage-9, Stage-10
  Stage-4 depends on stages: Stage-3
  Stage-0 depends on stages: Stage-4
  Stage-5 depends on stages: Stage-0
  Stage-15 has a backup stage: Stage-2
  Stage-10 depends on stages: Stage-15
  Stage-2
  Stage-17 is a root stage
  Stage-13 depends on stages: Stage-17

STAGE PLANS:
  Stage: Stage-16
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:item 
          TableScan
            alias: item
            Statistics: Num rows: 17820 Data size: 31241101 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_category) IN ('Books', 'Electronics') and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 8910 Data size: 15620550 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 8910 Data size: 15620550 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: web_clickstreams
            Statistics: Num rows: 6770550 Data size: 253337416 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (wcs_click_date_sk BETWEEN 37134 AND 37164 and wcs_sales_sk is null and wcs_user_sk is not null and wcs_item_sk is not null) (type: boolean)
              Statistics: Num rows: 376141 Data size: 14074275 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: wcs_click_date_sk (type: bigint), wcs_item_sk (type: bigint), wcs_user_sk (type: bigint)
                outputColumnNames: _col0, _col2, _col3
                Statistics: Num rows: 376141 Data size: 14074275 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col2 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col0, _col3
                  Statistics: Num rows: 413755 Data size: 15481702 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col3 (type: bigint), _col0 (type: bigint)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 413755 Data size: 15481702 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-11
    Conditional Operator

  Stage: Stage-14
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint)
                1 _col0 (type: bigint)

  Stage: Stage-9
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: bigint)
                1 _col0 (type: bigint)
              outputColumnNames: _col0, _col1, _col3
              Statistics: Num rows: 455130 Data size: 17029872 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: (_col1 < _col3) (type: boolean)
                Statistics: Num rows: 151710 Data size: 5676624 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col0 (type: bigint)
                  outputColumnNames: _col0
                  Statistics: Num rows: 151710 Data size: 5676624 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    keys: _col0 (type: bigint)
                    mode: hash
                    outputColumnNames: _col0
                    Statistics: Num rows: 151710 Data size: 5676624 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 151710 Data size: 5676624 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Group By Operator
          keys: KEY._col0 (type: bigint)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 75855 Data size: 2838312 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Statistics: Num rows: 75855 Data size: 2838312 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: bigint)
          outputColumnNames: _col0
          Statistics: Num rows: 75855 Data size: 2838312 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 75855 Data size: 2838312 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.TextInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                name: bigbench.q12_hive_run_query_0_result

  Stage: Stage-0
    Move Operator
      tables:
          replace: false
          table:
              input format: org.apache.hadoop.mapred.TextInputFormat
              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
              serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
              name: bigbench.q12_hive_run_query_0_result

  Stage: Stage-5
    Stats-Aggr Operator

  Stage: Stage-15
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint)
                1 _col0 (type: bigint)

  Stage: Stage-10
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: bigint)
                1 _col0 (type: bigint)
              outputColumnNames: _col0, _col1, _col3
              Statistics: Num rows: 455130 Data size: 17029872 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: (_col1 < _col3) (type: boolean)
                Statistics: Num rows: 151710 Data size: 5676624 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col0 (type: bigint)
                  outputColumnNames: _col0
                  Statistics: Num rows: 151710 Data size: 5676624 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    keys: _col0 (type: bigint)
                    mode: hash
                    outputColumnNames: _col0
                    Statistics: Num rows: 151710 Data size: 5676624 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 413755 Data size: 15481702 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: bigint)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 81592 Data size: 116512978 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: bigint)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: bigint)
            1 _col0 (type: bigint)
          outputColumnNames: _col0, _col1, _col3
          Statistics: Num rows: 455130 Data size: 17029872 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (_col1 < _col3) (type: boolean)
            Statistics: Num rows: 151710 Data size: 5676624 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col0 (type: bigint)
              outputColumnNames: _col0
              Statistics: Num rows: 151710 Data size: 5676624 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                keys: _col0 (type: bigint)
                mode: hash
                outputColumnNames: _col0
                Statistics: Num rows: 151710 Data size: 5676624 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-17
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_2:item 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_2:item 
          TableScan
            alias: item
            Statistics: Num rows: 17820 Data size: 31241101 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_category) IN ('Books', 'Electronics') and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 8910 Data size: 15620550 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 8910 Data size: 15620550 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-13
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_sales
            Statistics: Num rows: 667579 Data size: 953293700 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk BETWEEN 37134 AND 37224 and ss_customer_sk is not null and ss_item_sk is not null) (type: boolean)
              Statistics: Num rows: 74175 Data size: 105920887 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: bigint), ss_item_sk (type: bigint), ss_customer_sk (type: bigint)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 74175 Data size: 105920887 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col0, _col2
                  Statistics: Num rows: 81592 Data size: 116512978 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col2 (type: bigint), _col0 (type: bigint)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 81592 Data size: 116512978 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

Time taken: 2.923 seconds, Fetched: 330 row(s)
======= q12_hive_run_query_0 time =======
Start timestamp: 2018/02/12:12:18:25 1518459505
Stop  timestamp: 2018/02/12:12:18:41 1518459521
Duration:  0h 0m 16s
q12_hive_run_query_0 SUCCESS exit code: 0 
----- result -----
EMPTY  bytes: 0
to display: hadoop fs -cat /user/wentingt/benchmarks/bigbench/queryResults/q12_hive_run_query_0_result/*
----- logs -----
time&status: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/times.csv
full log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q12_hive_run_query_0.log
=========================
@@@/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q13/query13.sql
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q13/engineLocalSettings.sql to hive init.
===============================================
Running query : q13
-----------------------------------------------
benchmark phase: run_query
stream number  : 0
user parameter file: 
user settings file : 
log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q13_hive_run_query_0.log
===============================================
checking existence of local: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs
creating/cleaning/set permissions for hdfs tmp and result folders for this query
hdfs client: hadoop fs
Duration for hdfs prepare:  0h 0m 16s
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q13/engineLocalSettings.sql to hive init.
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/log4j-slf4j-impl-2.6.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/users/wentingt/hadoop-3.0.0-beta1-src/hadoop-dist/target/hadoop-3.0.0-beta1/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]

Logging initialized using configuration in jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/hive-common-2.3.2.jar!/hive-log4j2.properties Async: true
hive.execution.engine=mr
hive.cbo.enable=true
hive.stats.fetch.partition.stats=true
hive.script.operator.truncate.env=false
hive.compute.query.using.stats=true
hive.vectorized.execution.enabled=false
hive.vectorized.execution.reduce.enabled=true
hive.stats.autogather=true
mapreduce.input.fileinputformat.split.minsize=1
mapreduce.input.fileinputformat.split.maxsize=256000000
hive.exec.reducers.bytes.per.reducer=256000000
hive.exec.reducers.max=1009
hive.exec.parallel=false
hive.exec.parallel.thread.number=8
hive.exec.compress.intermediate=false
hive.exec.compress.output=false
mapred.map.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
mapred.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
hive.default.fileformat=TEXTFILE
hive.auto.convert.sortmerge.join=false
hive.auto.convert.sortmerge.join.noconditionaltask is undefined
hive.optimize.bucketmapjoin=false
hive.optimize.bucketmapjoin.sortedmerge=false
hive.auto.convert.join.noconditionaltask.size=10000000
hive.auto.convert.join=true
hive.optimize.mapjoin.mapreduce is undefined
hive.mapred.local.mem=0
hive.mapjoin.smalltable.filesize=25000000
hive.mapjoin.localtask.max.memory.usage=0.9
hive.optimize.skewjoin=false
hive.optimize.skewjoin.compiletime=false
hive.optimize.ppd=true
hive.optimize.ppd.storage=true
hive.ppd.recognizetransivity=true
hive.optimize.index.filter=false
hive.optimize.sampling.orderby=false
hive.optimize.sampling.orderby.number=1000
hive.optimize.sampling.orderby.percent=0.1
bigbench.hive.optimize.sampling.orderby=true
bigbench.hive.optimize.sampling.orderby.number=20000
bigbench.hive.optimize.sampling.orderby.percent=0.1
hive.groupby.skewindata=false
hive.exec.submit.local.task.via.child=true
OK
Time taken: 0.096 seconds
OK
Time taken: 0.008 seconds
OK
Time taken: 1.92 seconds
OK
Time taken: 0.237 seconds
hive.exec.compress.output=false
OK
Time taken: 0.012 seconds
OK
Time taken: 0.143 seconds
OK
STAGE DEPENDENCIES:
  Stage-20 is a root stage
  Stage-2 depends on stages: Stage-20
  Stage-14 depends on stages: Stage-2, Stage-8 , consists of Stage-17, Stage-18, Stage-19, Stage-3
  Stage-17 has a backup stage: Stage-3
  Stage-11 depends on stages: Stage-17
  Stage-4 depends on stages: Stage-3, Stage-11, Stage-12, Stage-13
  Stage-0 depends on stages: Stage-4
  Stage-5 depends on stages: Stage-0
  Stage-18 has a backup stage: Stage-3
  Stage-12 depends on stages: Stage-18
  Stage-19 has a backup stage: Stage-3
  Stage-13 depends on stages: Stage-19
  Stage-3
  Stage-21 is a root stage
  Stage-8 depends on stages: Stage-21

STAGE PLANS:
  Stage: Stage-20
    Map Reduce Local Work
      Alias -> Map Local Tables:
        store:dd:d 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        store:dd:d 
          TableScan
            alias: d
            Statistics: Num rows: 109573 Data size: 123050479 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year) IN (2001, 2002) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 54787 Data size: 61525801 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: bigint), d_year (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 54787 Data size: 61525801 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 ss_sold_date_sk (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: ss
            Statistics: Num rows: 667579 Data size: 953293700 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_customer_sk is not null) (type: boolean)
              Statistics: Num rows: 667579 Data size: 953293700 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 ss_sold_date_sk (type: bigint)
                  1 _col0 (type: bigint)
                outputColumnNames: _col3, _col20, _col27
                Statistics: Num rows: 734336 Data size: 1048623092 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col3 (type: bigint), _col27 (type: int), _col20 (type: decimal(7,2))
                  outputColumnNames: _col3, _col27, _col20
                  Statistics: Num rows: 734336 Data size: 1048623092 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    aggregations: sum(CASE WHEN ((_col27 = 2001)) THEN (_col20) ELSE (0) END), sum(CASE WHEN ((_col27 = (2001 + 1))) THEN (_col20) ELSE (0) END)
                    keys: _col3 (type: bigint)
                    mode: hash
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 734336 Data size: 1048623092 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 734336 Data size: 1048623092 Basic stats: COMPLETE Column stats: NONE
                      value expressions: _col1 (type: decimal(22,2)), _col2 (type: decimal(22,2))
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1)
          keys: KEY._col0 (type: bigint)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 367168 Data size: 524311546 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (_col1 > 0) (type: boolean)
            Statistics: Num rows: 122389 Data size: 174770039 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-14
    Conditional Operator

  Stage: Stage-17
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME1 
          Fetch Operator
            limit: -1
        c 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint)
                1 _col0 (type: bigint)
                2 c_customer_sk (type: bigint)
        c 
          TableScan
            alias: c
            Statistics: Num rows: 99000 Data size: 88009812 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: c_customer_sk is not null (type: boolean)
              Statistics: Num rows: 99000 Data size: 88009812 Basic stats: COMPLETE Column stats: NONE
              HashTable Sink Operator
                keys:
                  0 _col0 (type: bigint)
                  1 _col0 (type: bigint)
                  2 c_customer_sk (type: bigint)

  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 1 to 2
              keys:
                0 _col0 (type: bigint)
                1 _col0 (type: bigint)
                2 c_customer_sk (type: bigint)
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col14, _col15
              Statistics: Num rows: 269447 Data size: 492539887 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: ((_col3 = _col6) and ((_col5 / _col4) > (_col2 / _col1)) and (_col0 = _col3)) (type: boolean)
                Statistics: Num rows: 22453 Data size: 41043314 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col6 (type: bigint), _col14 (type: string), _col15 (type: string), (_col2 / _col1) (type: decimal(38,16)), (_col5 / _col4) (type: decimal(38,16))
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4
                  Statistics: Num rows: 22453 Data size: 41043314 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col4 (type: decimal(38,16)), _col0 (type: bigint), _col1 (type: string), _col2 (type: string)
              sort order: -+++
              Statistics: Num rows: 22453 Data size: 41043314 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col3 (type: decimal(38,16))
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey1 (type: bigint), KEY.reducesinkkey2 (type: string), KEY.reducesinkkey3 (type: string), VALUE._col0 (type: decimal(38,16)), KEY.reducesinkkey0 (type: decimal(38,16))
          outputColumnNames: _col0, _col1, _col2, _col3, _col4
          Statistics: Num rows: 22453 Data size: 41043314 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 182700 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col0 (type: bigint), _col1 (type: string), _col2 (type: string), CAST( _col3 AS decimal(15,2)) (type: decimal(15,2)), CAST( _col4 AS decimal(15,2)) (type: decimal(15,2))
              outputColumnNames: _col0, _col1, _col2, _col3, _col4
              Statistics: Num rows: 100 Data size: 182700 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                Statistics: Num rows: 100 Data size: 182700 Basic stats: COMPLETE Column stats: NONE
                table:
                    input format: org.apache.hadoop.mapred.TextInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                    name: bigbench.q13_hive_run_query_0_result

  Stage: Stage-0
    Move Operator
      tables:
          replace: false
          table:
              input format: org.apache.hadoop.mapred.TextInputFormat
              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
              serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
              name: bigbench.q13_hive_run_query_0_result

  Stage: Stage-5
    Stats-Aggr Operator

  Stage: Stage-18
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
        c 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint)
                1 _col0 (type: bigint)
                2 c_customer_sk (type: bigint)
        c 
          TableScan
            alias: c
            Statistics: Num rows: 99000 Data size: 88009812 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: c_customer_sk is not null (type: boolean)
              Statistics: Num rows: 99000 Data size: 88009812 Basic stats: COMPLETE Column stats: NONE
              HashTable Sink Operator
                keys:
                  0 _col0 (type: bigint)
                  1 _col0 (type: bigint)
                  2 c_customer_sk (type: bigint)

  Stage: Stage-12
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 1 to 2
              keys:
                0 _col0 (type: bigint)
                1 _col0 (type: bigint)
                2 c_customer_sk (type: bigint)
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col14, _col15
              Statistics: Num rows: 269447 Data size: 492539887 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: ((_col3 = _col6) and ((_col5 / _col4) > (_col2 / _col1)) and (_col0 = _col3)) (type: boolean)
                Statistics: Num rows: 22453 Data size: 41043314 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col6 (type: bigint), _col14 (type: string), _col15 (type: string), (_col2 / _col1) (type: decimal(38,16)), (_col5 / _col4) (type: decimal(38,16))
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4
                  Statistics: Num rows: 22453 Data size: 41043314 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-19
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
        $INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint)
                1 _col0 (type: bigint)
                2 c_customer_sk (type: bigint)
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint)
                1 _col0 (type: bigint)
                2 c_customer_sk (type: bigint)

  Stage: Stage-13
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: c
            Statistics: Num rows: 99000 Data size: 88009812 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: c_customer_sk is not null (type: boolean)
              Statistics: Num rows: 99000 Data size: 88009812 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                     Inner Join 1 to 2
                keys:
                  0 _col0 (type: bigint)
                  1 _col0 (type: bigint)
                  2 c_customer_sk (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col14, _col15
                Statistics: Num rows: 269447 Data size: 492539887 Basic stats: COMPLETE Column stats: NONE
                Filter Operator
                  predicate: ((_col3 = _col6) and ((_col5 / _col4) > (_col2 / _col1)) and (_col0 = _col3)) (type: boolean)
                  Statistics: Num rows: 22453 Data size: 41043314 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col6 (type: bigint), _col14 (type: string), _col15 (type: string), (_col2 / _col1) (type: decimal(38,16)), (_col5 / _col4) (type: decimal(38,16))
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4
                    Statistics: Num rows: 22453 Data size: 41043314 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 122389 Data size: 174770039 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: decimal(22,2)), _col2 (type: decimal(22,2))
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 122476 Data size: 223881762 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: decimal(22,2)), _col2 (type: decimal(22,2))
          TableScan
            alias: c
            Statistics: Num rows: 99000 Data size: 88009812 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: c_customer_sk is not null (type: boolean)
              Statistics: Num rows: 99000 Data size: 88009812 Basic stats: COMPLETE Column stats: NONE
              Reduce Output Operator
                key expressions: c_customer_sk (type: bigint)
                sort order: +
                Map-reduce partition columns: c_customer_sk (type: bigint)
                Statistics: Num rows: 99000 Data size: 88009812 Basic stats: COMPLETE Column stats: NONE
                value expressions: c_first_name (type: string), c_last_name (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
               Inner Join 1 to 2
          keys:
            0 _col0 (type: bigint)
            1 _col0 (type: bigint)
            2 c_customer_sk (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col14, _col15
          Statistics: Num rows: 269447 Data size: 492539887 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: ((_col3 = _col6) and ((_col5 / _col4) > (_col2 / _col1)) and (_col0 = _col3)) (type: boolean)
            Statistics: Num rows: 22453 Data size: 41043314 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col6 (type: bigint), _col14 (type: string), _col15 (type: string), (_col2 / _col1) (type: decimal(38,16)), (_col5 / _col4) (type: decimal(38,16))
              outputColumnNames: _col0, _col1, _col2, _col3, _col4
              Statistics: Num rows: 22453 Data size: 41043314 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-21
    Map Reduce Local Work
      Alias -> Map Local Tables:
        web:dd:d 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        web:dd:d 
          TableScan
            alias: d
            Statistics: Num rows: 109573 Data size: 123050479 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year) IN (2001, 2002) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 54787 Data size: 61525801 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: bigint), d_year (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 54787 Data size: 61525801 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 ws_sold_date_sk (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: ws
            Statistics: Num rows: 668052 Data size: 1221174888 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_sold_date_sk is not null and ws_bill_customer_sk is not null) (type: boolean)
              Statistics: Num rows: 668052 Data size: 1221174888 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 ws_sold_date_sk (type: bigint)
                  1 _col0 (type: bigint)
                outputColumnNames: _col4, _col29, _col38
                Statistics: Num rows: 734857 Data size: 1343292405 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col4 (type: bigint), _col38 (type: int), _col29 (type: decimal(7,2))
                  outputColumnNames: _col4, _col38, _col29
                  Statistics: Num rows: 734857 Data size: 1343292405 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    aggregations: sum(CASE WHEN ((_col38 = 2001)) THEN (_col29) ELSE (0) END), sum(CASE WHEN ((_col38 = (2001 + 1))) THEN (_col29) ELSE (0) END)
                    keys: _col4 (type: bigint)
                    mode: hash
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 734857 Data size: 1343292405 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 734857 Data size: 1343292405 Basic stats: COMPLETE Column stats: NONE
                      value expressions: _col1 (type: decimal(22,2)), _col2 (type: decimal(22,2))
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1)
          keys: KEY._col0 (type: bigint)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 367428 Data size: 671645288 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (_col1 > 0) (type: boolean)
            Statistics: Num rows: 122476 Data size: 223881762 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

Time taken: 1.34 seconds, Fetched: 449 row(s)
OK
Time taken: 1.594 seconds
OK
Time taken: 0.096 seconds
======= q13_hive_run_query_0 time =======
Start timestamp: 2018/02/12:12:18:59 1518459539
Stop  timestamp: 2018/02/12:12:19:17 1518459557
Duration:  0h 0m 18s
q13_hive_run_query_0 SUCCESS exit code: 0 
----- result -----
EMPTY  bytes: 0
to display: hadoop fs -cat /user/wentingt/benchmarks/bigbench/queryResults/q13_hive_run_query_0_result/*
----- logs -----
time&status: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/times.csv
full log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q13_hive_run_query_0.log
=========================
@@@/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q14/query14.sql
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q14/engineLocalSettings.sql to hive init.
===============================================
Running query : q14
-----------------------------------------------
benchmark phase: run_query
stream number  : 0
user parameter file: 
user settings file : 
log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q14_hive_run_query_0.log
===============================================
checking existence of local: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs
creating/cleaning/set permissions for hdfs tmp and result folders for this query
hdfs client: hadoop fs
Duration for hdfs prepare:  0h 0m 16s
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q14/engineLocalSettings.sql to hive init.
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/log4j-slf4j-impl-2.6.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/users/wentingt/hadoop-3.0.0-beta1-src/hadoop-dist/target/hadoop-3.0.0-beta1/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]

Logging initialized using configuration in jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/hive-common-2.3.2.jar!/hive-log4j2.properties Async: true
hive.execution.engine=mr
hive.cbo.enable=true
hive.stats.fetch.partition.stats=true
hive.script.operator.truncate.env=false
hive.compute.query.using.stats=true
hive.vectorized.execution.enabled=false
hive.vectorized.execution.reduce.enabled=true
hive.stats.autogather=true
mapreduce.input.fileinputformat.split.minsize=1
mapreduce.input.fileinputformat.split.maxsize=256000000
hive.exec.reducers.bytes.per.reducer=256000000
hive.exec.reducers.max=1009
hive.exec.parallel=false
hive.exec.parallel.thread.number=8
hive.exec.compress.intermediate=false
hive.exec.compress.output=false
mapred.map.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
mapred.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
hive.default.fileformat=TEXTFILE
hive.auto.convert.sortmerge.join=false
hive.auto.convert.sortmerge.join.noconditionaltask is undefined
hive.optimize.bucketmapjoin=false
hive.optimize.bucketmapjoin.sortedmerge=false
hive.auto.convert.join.noconditionaltask.size=10000000
hive.auto.convert.join=true
hive.optimize.mapjoin.mapreduce is undefined
hive.mapred.local.mem=0
hive.mapjoin.smalltable.filesize=25000000
hive.mapjoin.localtask.max.memory.usage=0.9
hive.optimize.skewjoin=false
hive.optimize.skewjoin.compiletime=false
hive.optimize.ppd=true
hive.optimize.ppd.storage=true
hive.ppd.recognizetransivity=true
hive.optimize.index.filter=false
hive.optimize.sampling.orderby=false
hive.optimize.sampling.orderby.number=1000
hive.optimize.sampling.orderby.percent=0.1
bigbench.hive.optimize.sampling.orderby=true
bigbench.hive.optimize.sampling.orderby.number=20000
bigbench.hive.optimize.sampling.orderby.percent=0.1
hive.groupby.skewindata=false
hive.exec.submit.local.task.via.child=true
hive.exec.compress.output=false
OK
Time taken: 0.069 seconds
OK
Time taken: 0.537 seconds
No Stats for bigbench@web_sales, Columns: ws_ship_hdemo_sk, ws_sold_time_sk, ws_web_page_sk
No Stats for bigbench@household_demographics, Columns: hd_demo_sk, hd_dep_count
No Stats for bigbench@time_dim, Columns: t_hour, t_time_sk
No Stats for bigbench@web_page, Columns: wp_char_count, wp_web_page_sk
No Stats for bigbench@web_sales, Columns: ws_ship_hdemo_sk, ws_sold_time_sk, ws_web_page_sk
No Stats for bigbench@household_demographics, Columns: hd_demo_sk, hd_dep_count
No Stats for bigbench@time_dim, Columns: t_hour, t_time_sk
No Stats for bigbench@web_page, Columns: wp_char_count, wp_web_page_sk
Warning: Map Join MAPJOIN[83][bigTable=?] in task 'Stage-18:MAPRED' is a cross product
Warning: Map Join MAPJOIN[82][bigTable=?] in task 'Stage-17:MAPRED' is a cross product
Warning: Shuffle Join JOIN[54][tables = [$hdt$_0, $hdt$_1]] in Stage 'Stage-5:MAPRED' is a cross product
OK
STAGE DEPENDENCIES:
  Stage-28 is a root stage
  Stage-4 depends on stages: Stage-28
  Stage-19 depends on stages: Stage-4, Stage-13 , consists of Stage-26, Stage-27, Stage-5
  Stage-26 has a backup stage: Stage-5
  Stage-17 depends on stages: Stage-26
  Stage-0 depends on stages: Stage-5, Stage-17, Stage-18
  Stage-6 depends on stages: Stage-0
  Stage-27 has a backup stage: Stage-5
  Stage-18 depends on stages: Stage-27
  Stage-5
  Stage-29 is a root stage
  Stage-13 depends on stages: Stage-29

STAGE PLANS:
  Stage: Stage-28
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:hd 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_2:td 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_3:wp 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:hd 
          TableScan
            alias: hd
            Statistics: Num rows: 7200 Data size: 835168 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((hd_dep_count = 5) and hd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 3600 Data size: 417584 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 3600 Data size: 417584 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)
        $hdt$_0:$hdt$_2:td 
          TableScan
            alias: td
            Statistics: Num rows: 86400 Data size: 41040000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((t_hour >= 7) and (t_hour <= 8) and t_time_sk is not null) (type: boolean)
              Statistics: Num rows: 9600 Data size: 4560000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: t_time_sk (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 9600 Data size: 4560000 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)
        $hdt$_0:$hdt$_3:wp 
          TableScan
            alias: wp
            Statistics: Num rows: 60 Data size: 38703 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((wp_char_count >= 5000) and (wp_char_count <= 6000) and wp_web_page_sk is not null) (type: boolean)
              Statistics: Num rows: 6 Data size: 3870 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: wp_web_page_sk (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 6 Data size: 3870 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: ws
            Statistics: Num rows: 668052 Data size: 1221174888 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_ship_hdemo_sk is not null and ws_sold_time_sk is not null and ws_web_page_sk is not null) (type: boolean)
              Statistics: Num rows: 668052 Data size: 1221174888 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_sold_time_sk (type: bigint), ws_ship_hdemo_sk (type: bigint), ws_web_page_sk (type: bigint)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 668052 Data size: 1221174888 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col0, _col2
                  Statistics: Num rows: 734857 Data size: 1343292405 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: bigint)
                      1 _col0 (type: bigint)
                    outputColumnNames: _col2
                    Statistics: Num rows: 808342 Data size: 1477621677 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: bigint)
                        1 _col0 (type: bigint)
                      Statistics: Num rows: 889176 Data size: 1625383879 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: count()
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          sort order: 
                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col0 (type: bigint)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-19
    Conditional Operator

  Stage: Stage-26
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 

  Stage: Stage-17
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 
                1 
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 1 Data size: 17 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: CAST( (UDFToDouble(_col0) / UDFToDouble(_col1)) AS decimal(15,4)) (type: decimal(15,4))
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 17 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  Statistics: Num rows: 1 Data size: 17 Basic stats: COMPLETE Column stats: NONE
                  table:
                      input format: org.apache.hadoop.mapred.TextInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                      name: bigbench.q14_hive_run_query_0_result
      Local Work:
        Map Reduce Local Work

  Stage: Stage-0
    Move Operator
      tables:
          replace: false
          table:
              input format: org.apache.hadoop.mapred.TextInputFormat
              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
              serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
              name: bigbench.q14_hive_run_query_0_result

  Stage: Stage-6
    Stats-Aggr Operator

  Stage: Stage-27
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 

  Stage: Stage-18
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 
                1 
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 1 Data size: 17 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: CAST( (UDFToDouble(_col0) / UDFToDouble(_col1)) AS decimal(15,4)) (type: decimal(15,4))
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 17 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  Statistics: Num rows: 1 Data size: 17 Basic stats: COMPLETE Column stats: NONE
                  table:
                      input format: org.apache.hadoop.mapred.TextInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                      name: bigbench.q14_hive_run_query_0_result
      Local Work:
        Map Reduce Local Work

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint)
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 
            1 
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 1 Data size: 17 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: CAST( (UDFToDouble(_col0) / UDFToDouble(_col1)) AS decimal(15,4)) (type: decimal(15,4))
            outputColumnNames: _col0
            Statistics: Num rows: 1 Data size: 17 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 1 Data size: 17 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.TextInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                  name: bigbench.q14_hive_run_query_0_result

  Stage: Stage-29
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_2:hd 
          Fetch Operator
            limit: -1
        $hdt$_1:$hdt$_3:td 
          Fetch Operator
            limit: -1
        $hdt$_1:$hdt$_4:wp 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_2:hd 
          TableScan
            alias: hd
            Statistics: Num rows: 7200 Data size: 835168 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((hd_dep_count = 5) and hd_demo_sk is not null) (type: boolean)
              Statistics: Num rows: 3600 Data size: 417584 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: hd_demo_sk (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 3600 Data size: 417584 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)
        $hdt$_1:$hdt$_3:td 
          TableScan
            alias: td
            Statistics: Num rows: 86400 Data size: 41040000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((t_hour >= 19) and (t_hour <= 20) and t_time_sk is not null) (type: boolean)
              Statistics: Num rows: 9600 Data size: 4560000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: t_time_sk (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 9600 Data size: 4560000 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)
        $hdt$_1:$hdt$_4:wp 
          TableScan
            alias: wp
            Statistics: Num rows: 60 Data size: 38703 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((wp_char_count >= 5000) and (wp_char_count <= 6000) and wp_web_page_sk is not null) (type: boolean)
              Statistics: Num rows: 6 Data size: 3870 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: wp_web_page_sk (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 6 Data size: 3870 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-13
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: ws
            Statistics: Num rows: 668052 Data size: 1221174888 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_ship_hdemo_sk is not null and ws_sold_time_sk is not null and ws_web_page_sk is not null) (type: boolean)
              Statistics: Num rows: 668052 Data size: 1221174888 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_sold_time_sk (type: bigint), ws_ship_hdemo_sk (type: bigint), ws_web_page_sk (type: bigint)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 668052 Data size: 1221174888 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col0, _col2
                  Statistics: Num rows: 734857 Data size: 1343292405 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: bigint)
                      1 _col0 (type: bigint)
                    outputColumnNames: _col2
                    Statistics: Num rows: 808342 Data size: 1477621677 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: bigint)
                        1 _col0 (type: bigint)
                      Statistics: Num rows: 889176 Data size: 1625383879 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: count()
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          sort order: 
                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col0 (type: bigint)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

Time taken: 3.611 seconds, Fetched: 386 row(s)
======= q14_hive_run_query_0 time =======
Start timestamp: 2018/02/12:12:19:36 1518459576
Stop  timestamp: 2018/02/12:12:19:53 1518459593
Duration:  0h 0m 17s
q14_hive_run_query_0 SUCCESS exit code: 0 
----- result -----
EMPTY  bytes: 0
to display: hadoop fs -cat /user/wentingt/benchmarks/bigbench/queryResults/q14_hive_run_query_0_result/*
----- logs -----
time&status: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/times.csv
full log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q14_hive_run_query_0.log
=========================
@@@/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q15/query15.sql
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q15/engineLocalSettings.sql to hive init.
===============================================
Running query : q15
-----------------------------------------------
benchmark phase: run_query
stream number  : 0
user parameter file: 
user settings file : 
log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q15_hive_run_query_0.log
===============================================
checking existence of local: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs
creating/cleaning/set permissions for hdfs tmp and result folders for this query
hdfs client: hadoop fs
Duration for hdfs prepare:  0h 0m 17s
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q15/engineLocalSettings.sql to hive init.
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/log4j-slf4j-impl-2.6.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/users/wentingt/hadoop-3.0.0-beta1-src/hadoop-dist/target/hadoop-3.0.0-beta1/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]

Logging initialized using configuration in jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/hive-common-2.3.2.jar!/hive-log4j2.properties Async: true
hive.execution.engine=mr
hive.cbo.enable=true
hive.stats.fetch.partition.stats=true
hive.script.operator.truncate.env=false
hive.compute.query.using.stats=true
hive.vectorized.execution.enabled=false
hive.vectorized.execution.reduce.enabled=true
hive.stats.autogather=true
mapreduce.input.fileinputformat.split.minsize=1
mapreduce.input.fileinputformat.split.maxsize=256000000
hive.exec.reducers.bytes.per.reducer=256000000
hive.exec.reducers.max=1009
hive.exec.parallel=false
hive.exec.parallel.thread.number=8
hive.exec.compress.intermediate=false
hive.exec.compress.output=false
mapred.map.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
mapred.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
hive.default.fileformat=TEXTFILE
hive.auto.convert.sortmerge.join=false
hive.auto.convert.sortmerge.join.noconditionaltask is undefined
hive.optimize.bucketmapjoin=false
hive.optimize.bucketmapjoin.sortedmerge=false
hive.auto.convert.join.noconditionaltask.size=10000000
hive.auto.convert.join=true
hive.optimize.mapjoin.mapreduce is undefined
hive.mapred.local.mem=0
hive.mapjoin.smalltable.filesize=25000000
hive.mapjoin.localtask.max.memory.usage=0.9
hive.optimize.skewjoin=false
hive.optimize.skewjoin.compiletime=false
hive.optimize.ppd=true
hive.optimize.ppd.storage=true
hive.ppd.recognizetransivity=true
hive.optimize.index.filter=false
hive.optimize.sampling.orderby=false
hive.optimize.sampling.orderby.number=1000
hive.optimize.sampling.orderby.percent=0.1
bigbench.hive.optimize.sampling.orderby=true
bigbench.hive.optimize.sampling.orderby.number=20000
bigbench.hive.optimize.sampling.orderby.percent=0.1
hive.groupby.skewindata=false
hive.exec.submit.local.task.via.child=true
hive.exec.compress.output=false
OK
Time taken: 0.073 seconds
OK
Time taken: 0.498 seconds
No Stats for bigbench@store_sales, Columns: ss_net_paid, ss_sold_date_sk, ss_item_sk, ss_store_sk
No Stats for bigbench@date_dim, Columns: d_date, d_date_sk
No Stats for bigbench@item, Columns: i_category_id, i_item_sk
OK
STAGE DEPENDENCIES:
  Stage-10 is a root stage
  Stage-3 depends on stages: Stage-10
  Stage-4 depends on stages: Stage-3
  Stage-0 depends on stages: Stage-4
  Stage-5 depends on stages: Stage-0

STAGE PLANS:
  Stage: Stage-10
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_1:d 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_0:$hdt$_2:i 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_1:d 
          TableScan
            alias: d
            Statistics: Num rows: 109573 Data size: 123050479 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_date >= '2001-09-02') and (d_date <= '2002-09-02') and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 12174 Data size: 13671402 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 12174 Data size: 13671402 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  keys: _col0 (type: bigint)
                  mode: hash
                  outputColumnNames: _col0
                  Statistics: Num rows: 12174 Data size: 13671402 Basic stats: COMPLETE Column stats: NONE
                  HashTable Sink Operator
                    keys:
                      0 _col0 (type: bigint)
                      1 _col0 (type: bigint)
        $hdt$_0:$hdt$_0:$hdt$_2:i 
          TableScan
            alias: i
            Statistics: Num rows: 17820 Data size: 31241101 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_sk is not null and i_category_id is not null) (type: boolean)
              Statistics: Num rows: 17820 Data size: 31241101 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: bigint), i_category_id (type: int)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 17820 Data size: 31241101 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: s
            Statistics: Num rows: 667579 Data size: 953293700 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ss_store_sk = 10) and ss_sold_date_sk is not null and ss_item_sk is not null) (type: boolean)
              Statistics: Num rows: 333789 Data size: 476646136 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: bigint), ss_item_sk (type: bigint), ss_net_paid (type: decimal(7,2))
                outputColumnNames: _col0, _col1, _col3
                Statistics: Num rows: 333789 Data size: 476646136 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Left Semi Join 0 to 1
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col0, _col1, _col3
                  Statistics: Num rows: 367167 Data size: 524310760 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col1 (type: bigint)
                      1 _col0 (type: bigint)
                    outputColumnNames: _col0, _col3, _col5
                    Statistics: Num rows: 403883 Data size: 576741848 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: _col5 (type: int), _col0 (type: bigint), _col3 (type: decimal(7,2))
                      outputColumnNames: _col5, _col0, _col3
                      Statistics: Num rows: 403883 Data size: 576741848 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: sum(_col3)
                        keys: _col5 (type: int), _col0 (type: bigint)
                        mode: hash
                        outputColumnNames: _col0, _col1, _col2
                        Statistics: Num rows: 403883 Data size: 576741848 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          key expressions: _col0 (type: int), _col1 (type: bigint)
                          sort order: ++
                          Map-reduce partition columns: _col0 (type: int)
                          Statistics: Num rows: 403883 Data size: 576741848 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col2 (type: decimal(17,2))
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: int), KEY._col1 (type: bigint)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 201941 Data size: 288370210 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: int), _col1 (type: bigint), (CAST( _col1 AS decimal(19,0)) * _col2) (type: decimal(37,2)), _col2 (type: decimal(17,2)), (_col1 * _col1) (type: bigint)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4
            Statistics: Num rows: 201941 Data size: 288370210 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: count(_col1), sum(_col2), sum(_col1), sum(_col3), sum(_col4)
              keys: _col0 (type: int)
              mode: complete
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
              Statistics: Num rows: 100970 Data size: 144184391 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: ((((CAST( _col1 AS decimal(19,0)) * _col2) - (CAST( _col3 AS decimal(19,0)) * _col4)) / CAST( ((_col1 * _col5) - (_col3 * _col3)) AS decimal(19,0))) <= 0) (type: boolean)
                Statistics: Num rows: 33656 Data size: 48060511 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col0 (type: int), (((CAST( _col1 AS decimal(19,0)) * _col2) - (CAST( _col3 AS decimal(19,0)) * _col4)) / CAST( ((_col1 * _col5) - (_col3 * _col3)) AS decimal(19,0))) (type: decimal(38,6)), ((_col4 - ((((CAST( _col1 AS decimal(19,0)) * _col2) - (CAST( _col3 AS decimal(19,0)) * _col4)) / CAST( ((_col1 * _col5) - (_col3 * _col3)) AS decimal(19,0))) * CAST( _col3 AS decimal(19,0)))) / CAST( _col1 AS decimal(19,0))) (type: decimal(38,6))
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 33656 Data size: 48060511 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: int)
              sort order: +
              Statistics: Num rows: 33656 Data size: 48060511 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: decimal(38,6)), _col2 (type: decimal(38,6))
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: int), CAST( VALUE._col0 AS decimal(15,7)) (type: decimal(15,7)), CAST( VALUE._col1 AS decimal(15,7)) (type: decimal(15,7))
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 33656 Data size: 48060511 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 33656 Data size: 48060511 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.TextInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                name: bigbench.q15_hive_run_query_0_result

  Stage: Stage-0
    Move Operator
      tables:
          replace: false
          table:
              input format: org.apache.hadoop.mapred.TextInputFormat
              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
              serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
              name: bigbench.q15_hive_run_query_0_result

  Stage: Stage-5
    Stats-Aggr Operator

Time taken: 2.872 seconds, Fetched: 168 row(s)
======= q15_hive_run_query_0 time =======
Start timestamp: 2018/02/12:12:20:12 1518459612
Stop  timestamp: 2018/02/12:12:20:28 1518459628
Duration:  0h 0m 16s
q15_hive_run_query_0 SUCCESS exit code: 0 
----- result -----
EMPTY  bytes: 0
to display: hadoop fs -cat /user/wentingt/benchmarks/bigbench/queryResults/q15_hive_run_query_0_result/*
----- logs -----
time&status: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/times.csv
full log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q15_hive_run_query_0.log
=========================
@@@/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q16/query16.sql
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q16/engineLocalSettings.sql to hive init.
===============================================
Running query : q16
-----------------------------------------------
benchmark phase: run_query
stream number  : 0
user parameter file: 
user settings file : 
log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q16_hive_run_query_0.log
===============================================
checking existence of local: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs
creating/cleaning/set permissions for hdfs tmp and result folders for this query
hdfs client: hadoop fs
Duration for hdfs prepare:  0h 0m 17s
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q16/engineLocalSettings.sql to hive init.
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/log4j-slf4j-impl-2.6.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/users/wentingt/hadoop-3.0.0-beta1-src/hadoop-dist/target/hadoop-3.0.0-beta1/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]

Logging initialized using configuration in jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/hive-common-2.3.2.jar!/hive-log4j2.properties Async: true
hive.execution.engine=mr
hive.cbo.enable=true
hive.stats.fetch.partition.stats=true
hive.script.operator.truncate.env=false
hive.compute.query.using.stats=true
hive.vectorized.execution.enabled=false
hive.vectorized.execution.reduce.enabled=true
hive.stats.autogather=true
mapreduce.input.fileinputformat.split.minsize=1
mapreduce.input.fileinputformat.split.maxsize=256000000
hive.exec.reducers.bytes.per.reducer=256000000
hive.exec.reducers.max=1009
hive.exec.parallel=false
hive.exec.parallel.thread.number=8
hive.exec.compress.intermediate=false
hive.exec.compress.output=false
mapred.map.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
mapred.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
hive.default.fileformat=TEXTFILE
hive.auto.convert.sortmerge.join=false
hive.auto.convert.sortmerge.join.noconditionaltask is undefined
hive.optimize.bucketmapjoin=false
hive.optimize.bucketmapjoin.sortedmerge=false
hive.auto.convert.join.noconditionaltask.size=10000000
hive.auto.convert.join=true
hive.optimize.mapjoin.mapreduce is undefined
hive.mapred.local.mem=0
hive.mapjoin.smalltable.filesize=25000000
hive.mapjoin.localtask.max.memory.usage=0.9
hive.optimize.skewjoin=false
hive.optimize.skewjoin.compiletime=false
hive.optimize.ppd=true
hive.optimize.ppd.storage=true
hive.ppd.recognizetransivity=true
hive.optimize.index.filter=false
hive.optimize.sampling.orderby=false
hive.optimize.sampling.orderby.number=1000
hive.optimize.sampling.orderby.percent=0.1
bigbench.hive.optimize.sampling.orderby=true
bigbench.hive.optimize.sampling.orderby.number=20000
bigbench.hive.optimize.sampling.orderby.percent=0.1
hive.groupby.skewindata=false
hive.exec.submit.local.task.via.child=true
hive.exec.compress.output=false
OK
Time taken: 0.068 seconds
OK
Time taken: 0.495 seconds
No Stats for bigbench@web_sales, Columns: ws_warehouse_sk, ws_order_number, ws_item_sk, ws_sold_date_sk, ws_sales_price
No Stats for bigbench@web_returns, Columns: wr_order_number, wr_refunded_cash, wr_item_sk
No Stats for bigbench@item, Columns: i_item_id, i_item_sk
No Stats for bigbench@warehouse, Columns: w_state, w_warehouse_sk
No Stats for bigbench@date_dim, Columns: d_date, d_date_sk
OK
STAGE DEPENDENCIES:
  Stage-16 is a root stage
  Stage-5 depends on stages: Stage-16
  Stage-6 depends on stages: Stage-5
  Stage-0 depends on stages: Stage-6
  Stage-7 depends on stages: Stage-0

STAGE PLANS:
  Stage: Stage-16
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_1:wr 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_1:i 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_2:w 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_3:d 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_1:wr 
          TableScan
            alias: wr
            Statistics: Num rows: 38487 Data size: 43257220 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: wr_item_sk is not null (type: boolean)
              Statistics: Num rows: 38487 Data size: 43257220 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: wr_item_sk (type: bigint), wr_order_number (type: bigint), wr_refunded_cash (type: decimal(7,2))
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 38487 Data size: 43257220 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: bigint), _col3 (type: bigint)
                    1 _col0 (type: bigint), _col1 (type: bigint)
        $hdt$_0:$hdt$_1:i 
          TableScan
            alias: i
            Statistics: Num rows: 17820 Data size: 31241101 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 17820 Data size: 31241101 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: bigint), i_item_id (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 17820 Data size: 31241101 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)
        $hdt$_0:$hdt$_2:w 
          TableScan
            alias: w
            Statistics: Num rows: 5 Data size: 5695 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: w_warehouse_sk is not null (type: boolean)
              Statistics: Num rows: 5 Data size: 5695 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: w_warehouse_sk (type: bigint), w_state (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 5 Data size: 5695 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: bigint)
                    1 _col0 (type: bigint)
        $hdt$_0:$hdt$_3:d 
          TableScan
            alias: d
            Statistics: Num rows: 109573 Data size: 123050479 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((to_unix_timestamp(d_date,'yyyy-MM-dd') >= 982134000) and (to_unix_timestamp(d_date,'yyyy-MM-dd') <= 987318000) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 12174 Data size: 13671402 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: bigint), d_date (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 12174 Data size: 13671402 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: ws
            Statistics: Num rows: 668052 Data size: 1221174888 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_item_sk is not null and ws_warehouse_sk is not null and ws_sold_date_sk is not null) (type: boolean)
              Statistics: Num rows: 668052 Data size: 1221174888 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_sold_date_sk (type: bigint), ws_item_sk (type: bigint), ws_warehouse_sk (type: bigint), ws_order_number (type: bigint), ws_sales_price (type: decimal(7,2))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 668052 Data size: 1221174888 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Left Outer Join0 to 1
                  keys:
                    0 _col1 (type: bigint), _col3 (type: bigint)
                    1 _col0 (type: bigint), _col1 (type: bigint)
                  outputColumnNames: _col0, _col1, _col2, _col4, _col7
                  Statistics: Num rows: 734857 Data size: 1343292405 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: bigint), _col4 (type: decimal(7,2)), _col7 (type: decimal(7,2))
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4
                    Statistics: Num rows: 734857 Data size: 1343292405 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col1 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0, _col2, _col3, _col4, _col6
                      Statistics: Num rows: 808342 Data size: 1477621677 Basic stats: COMPLETE Column stats: NONE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col2 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col3, _col4, _col6, _col8
                        Statistics: Num rows: 889176 Data size: 1625383879 Basic stats: COMPLETE Column stats: NONE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col0 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col3, _col4, _col6, _col8, _col10
                          Statistics: Num rows: 978093 Data size: 1787922305 Basic stats: COMPLETE Column stats: NONE
                          Select Operator
                            expressions: _col8 (type: string), _col6 (type: string), CASE WHEN ((to_unix_timestamp(_col10,'yyyy-MM-dd') < 984726000)) THEN ((_col3 - COALESCE(_col4,0))) ELSE (0) END (type: decimal(13,2)), CASE WHEN ((to_unix_timestamp(_col10,'yyyy-MM-dd') >= 984726000)) THEN ((_col3 - COALESCE(_col4,0))) ELSE (0) END (type: decimal(13,2))
                            outputColumnNames: _col0, _col1, _col2, _col3
                            Statistics: Num rows: 978093 Data size: 1787922305 Basic stats: COMPLETE Column stats: NONE
                            Group By Operator
                              aggregations: sum(_col2), sum(_col3)
                              keys: _col0 (type: string), _col1 (type: string)
                              mode: hash
                              outputColumnNames: _col0, _col1, _col2, _col3
                              Statistics: Num rows: 978093 Data size: 1787922305 Basic stats: COMPLETE Column stats: NONE
                              Reduce Output Operator
                                key expressions: _col0 (type: string), _col1 (type: string)
                                sort order: ++
                                Map-reduce partition columns: _col0 (type: string), _col1 (type: string)
                                Statistics: Num rows: 978093 Data size: 1787922305 Basic stats: COMPLETE Column stats: NONE
                                TopN Hash Memory Usage: 0.1
                                value expressions: _col2 (type: decimal(23,2)), _col3 (type: decimal(23,2))
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1)
          keys: KEY._col0 (type: string), KEY._col1 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 489046 Data size: 893960238 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string)
              sort order: ++
              Statistics: Num rows: 489046 Data size: 893960238 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col2 (type: decimal(23,2)), _col3 (type: decimal(23,2))
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), VALUE._col0 (type: decimal(23,2)), VALUE._col1 (type: decimal(23,2))
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 489046 Data size: 893960238 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 182700 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col0 (type: string), _col1 (type: string), CAST( _col2 AS decimal(15,2)) (type: decimal(15,2)), CAST( _col3 AS decimal(15,2)) (type: decimal(15,2))
              outputColumnNames: _col0, _col1, _col2, _col3
              Statistics: Num rows: 100 Data size: 182700 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                Statistics: Num rows: 100 Data size: 182700 Basic stats: COMPLETE Column stats: NONE
                table:
                    input format: org.apache.hadoop.mapred.TextInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                    name: bigbench.q16_hive_run_query_0_result

  Stage: Stage-0
    Move Operator
      tables:
          replace: false
          table:
              input format: org.apache.hadoop.mapred.TextInputFormat
              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
              serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
              name: bigbench.q16_hive_run_query_0_result

  Stage: Stage-7
    Stats-Aggr Operator

Time taken: 3.112 seconds, Fetched: 211 row(s)
======= q16_hive_run_query_0 time =======
Start timestamp: 2018/02/12:12:20:47 1518459647
Stop  timestamp: 2018/02/12:12:21:03 1518459663
Duration:  0h 0m 16s
q16_hive_run_query_0 SUCCESS exit code: 0 
----- result -----
EMPTY  bytes: 0
to display: hadoop fs -cat /user/wentingt/benchmarks/bigbench/queryResults/q16_hive_run_query_0_result/*
----- logs -----
time&status: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/times.csv
full log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q16_hive_run_query_0.log
=========================
@@@/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q17/query17.sql
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q17/engineLocalSettings.sql to hive init.
===============================================
Running query : q17
-----------------------------------------------
benchmark phase: run_query
stream number  : 0
user parameter file: 
user settings file : 
log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q17_hive_run_query_0.log
===============================================
checking existence of local: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs
creating/cleaning/set permissions for hdfs tmp and result folders for this query
hdfs client: hadoop fs
Duration for hdfs prepare:  0h 0m 17s
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q17/engineLocalSettings.sql to hive init.
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/log4j-slf4j-impl-2.6.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/users/wentingt/hadoop-3.0.0-beta1-src/hadoop-dist/target/hadoop-3.0.0-beta1/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]

Logging initialized using configuration in jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/hive-common-2.3.2.jar!/hive-log4j2.properties Async: true
hive.execution.engine=mr
hive.cbo.enable=true
hive.stats.fetch.partition.stats=true
hive.script.operator.truncate.env=false
hive.compute.query.using.stats=true
hive.vectorized.execution.enabled=false
hive.vectorized.execution.reduce.enabled=true
hive.stats.autogather=true
mapreduce.input.fileinputformat.split.minsize=1
mapreduce.input.fileinputformat.split.maxsize=256000000
hive.exec.reducers.bytes.per.reducer=256000000
hive.exec.reducers.max=1009
hive.exec.parallel=false
hive.exec.parallel.thread.number=8
hive.exec.compress.intermediate=false
hive.exec.compress.output=false
mapred.map.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
mapred.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
hive.default.fileformat=TEXTFILE
hive.auto.convert.sortmerge.join=false
hive.auto.convert.sortmerge.join.noconditionaltask is undefined
hive.optimize.bucketmapjoin=false
hive.optimize.bucketmapjoin.sortedmerge=false
hive.auto.convert.join.noconditionaltask.size=10000000
hive.auto.convert.join=true
hive.optimize.mapjoin.mapreduce is undefined
hive.mapred.local.mem=0
hive.mapjoin.smalltable.filesize=25000000
hive.mapjoin.localtask.max.memory.usage=0.9
hive.optimize.skewjoin=false
hive.optimize.skewjoin.compiletime=false
hive.optimize.ppd=true
hive.optimize.ppd.storage=true
hive.ppd.recognizetransivity=true
hive.optimize.index.filter=false
hive.optimize.sampling.orderby=false
hive.optimize.sampling.orderby.number=1000
hive.optimize.sampling.orderby.percent=0.1
bigbench.hive.optimize.sampling.orderby=true
bigbench.hive.optimize.sampling.orderby.number=20000
bigbench.hive.optimize.sampling.orderby.percent=0.1
hive.groupby.skewindata=false
hive.exec.submit.local.task.via.child=true
hive.exec.compress.output=false
OK
Time taken: 0.09 seconds
OK
Time taken: 0.476 seconds
No Stats for bigbench@store_sales, Columns: ss_customer_sk, ss_promo_sk, ss_ext_sales_price, ss_sold_date_sk, ss_item_sk, ss_store_sk
No Stats for bigbench@date_dim, Columns: d_moy, d_date_sk, d_year
No Stats for bigbench@item, Columns: i_category, i_item_sk
No Stats for bigbench@store, Columns: s_gmt_offset, s_store_sk
No Stats for bigbench@promotion, Columns: p_channel_email, p_promo_sk, p_channel_dmail, p_channel_tv
No Stats for bigbench@customer, Columns: c_current_addr_sk, c_customer_sk
No Stats for bigbench@customer_address, Columns: ca_address_sk, ca_gmt_offset
No Stats for bigbench@store_sales, Columns: ss_customer_sk, ss_promo_sk, ss_ext_sales_price, ss_sold_date_sk, ss_item_sk, ss_store_sk
No Stats for bigbench@date_dim, Columns: d_moy, d_date_sk, d_year
No Stats for bigbench@item, Columns: i_category, i_item_sk
No Stats for bigbench@store, Columns: s_gmt_offset, s_store_sk
No Stats for bigbench@promotion, Columns: p_promo_sk
No Stats for bigbench@customer, Columns: c_current_addr_sk, c_customer_sk
No Stats for bigbench@customer_address, Columns: ca_address_sk, ca_gmt_offset
Warning: Map Join MAPJOIN[141][bigTable=?] in task 'Stage-30:MAPRED' is a cross product
Warning: Map Join MAPJOIN[142][bigTable=?] in task 'Stage-31:MAPRED' is a cross product
Warning: Shuffle Join JOIN[90][tables = [$hdt$_0, $hdt$_1]] in Stage 'Stage-8:MAPRED' is a cross product
OK
STAGE DEPENDENCIES:
  Stage-47 is a root stage
  Stage-7 depends on stages: Stage-47
  Stage-32 depends on stages: Stage-7, Stage-23 , consists of Stage-45, Stage-46, Stage-8
  Stage-45 has a backup stage: Stage-8
  Stage-30 depends on stages: Stage-45
  Stage-9 depends on stages: Stage-8, Stage-30, Stage-31
  Stage-0 depends on stages: Stage-9
  Stage-10 depends on stages: Stage-0
  Stage-46 has a backup stage: Stage-8
  Stage-31 depends on stages: Stage-46
  Stage-8
  Stage-48 is a root stage
  Stage-23 depends on stages: Stage-48

STAGE PLANS:
  Stage: Stage-47
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:dd 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_2:i 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_3:s 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_4:p 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_5:c 
          Fetch Operator
            limit: -1
        $hdt$_0:$hdt$_6:ca 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:dd 
          TableScan
            alias: dd
            Statistics: Num rows: 109573 Data size: 123050479 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2001) and (d_moy = 12) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 27393 Data size: 30762339 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 27393 Data size: 30762339 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)
        $hdt$_0:$hdt$_2:i 
          TableScan
            alias: i
            Statistics: Num rows: 17820 Data size: 31241101 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_category) IN ('Books', 'Music') and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 8910 Data size: 15620550 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 8910 Data size: 15620550 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)
        $hdt$_0:$hdt$_3:s 
          TableScan
            alias: s
            Statistics: Num rows: 12 Data size: 25956 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((s_gmt_offset = -5) and s_store_sk is not null) (type: boolean)
              Statistics: Num rows: 6 Data size: 12978 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 6 Data size: 12978 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: bigint)
                    1 _col0 (type: bigint)
        $hdt$_0:$hdt$_4:p 
          TableScan
            alias: p
            Statistics: Num rows: 300 Data size: 404700 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (((p_channel_dmail = 'Y') or (p_channel_email = 'Y') or (p_channel_tv = 'Y')) and p_promo_sk is not null) (type: boolean)
              Statistics: Num rows: 300 Data size: 404700 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: p_promo_sk (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 300 Data size: 404700 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col4 (type: bigint)
                    1 _col0 (type: bigint)
        $hdt$_0:$hdt$_5:c 
          TableScan
            alias: c
            Statistics: Num rows: 99000 Data size: 88009812 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_current_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 99000 Data size: 88009812 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: bigint), c_current_addr_sk (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 99000 Data size: 88009812 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: bigint)
                    1 _col0 (type: bigint)
        $hdt$_0:$hdt$_6:ca 
          TableScan
            alias: ca
            Statistics: Num rows: 49500 Data size: 55836000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_gmt_offset = -5) and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 24750 Data size: 27918000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 24750 Data size: 27918000 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col18 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: ss
            Statistics: Num rows: 667579 Data size: 953293700 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_item_sk is not null and ss_store_sk is not null and ss_promo_sk is not null and ss_customer_sk is not null) (type: boolean)
              Statistics: Num rows: 667579 Data size: 953293700 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: bigint), ss_item_sk (type: bigint), ss_customer_sk (type: bigint), ss_store_sk (type: bigint), ss_promo_sk (type: bigint), ss_ext_sales_price (type: decimal(7,2))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 667579 Data size: 953293700 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col1, _col2, _col3, _col4, _col5
                  Statistics: Num rows: 734336 Data size: 1048623092 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col1 (type: bigint)
                      1 _col0 (type: bigint)
                    outputColumnNames: _col2, _col3, _col4, _col5
                    Statistics: Num rows: 807769 Data size: 1153485426 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col3 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col2, _col4, _col5
                      Statistics: Num rows: 888545 Data size: 1268833996 Basic stats: COMPLETE Column stats: NONE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col4 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col2, _col5
                        Statistics: Num rows: 977399 Data size: 1395717425 Basic stats: COMPLETE Column stats: NONE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col2 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col5, _col18
                          Statistics: Num rows: 1075138 Data size: 1535289200 Basic stats: COMPLETE Column stats: NONE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col18 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col5
                            Statistics: Num rows: 1182651 Data size: 1688818156 Basic stats: COMPLETE Column stats: NONE
                            Group By Operator
                              aggregations: sum(_col5)
                              mode: hash
                              outputColumnNames: _col0
                              Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: NONE
                              Reduce Output Operator
                                sort order: 
                                Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: NONE
                                value expressions: _col0 (type: decimal(17,2))
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-32
    Conditional Operator

  Stage: Stage-45
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 

  Stage: Stage-30
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 
                1 
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 1 Data size: 225 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col0 (type: decimal(17,2)), _col1 (type: decimal(17,2)), ((_col0 / _col1) * 100) (type: decimal(38,17))
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 225 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-9
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: decimal(17,2)), _col1 (type: decimal(17,2))
              sort order: ++
              Statistics: Num rows: 1 Data size: 225 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col2 (type: decimal(38,17))
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: decimal(17,2)), KEY.reducesinkkey1 (type: decimal(17,2)), VALUE._col0 (type: decimal(38,17))
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 1 Data size: 225 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 1 Data size: 225 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: CAST( _col0 AS decimal(15,2)) (type: decimal(15,2)), CAST( _col1 AS decimal(15,2)) (type: decimal(15,2)), CAST( _col2 AS decimal(15,2)) (type: decimal(15,2))
              outputColumnNames: _col0, _col1, _col2
              Statistics: Num rows: 1 Data size: 225 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                Statistics: Num rows: 1 Data size: 225 Basic stats: COMPLETE Column stats: NONE
                table:
                    input format: org.apache.hadoop.mapred.TextInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                    name: bigbench.q17_hive_run_query_0_result

  Stage: Stage-0
    Move Operator
      tables:
          replace: false
          table:
              input format: org.apache.hadoop.mapred.TextInputFormat
              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
              serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
              name: bigbench.q17_hive_run_query_0_result

  Stage: Stage-10
    Stats-Aggr Operator

  Stage: Stage-46
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 
                1 

  Stage: Stage-31
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 
                1 
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 1 Data size: 225 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col0 (type: decimal(17,2)), _col1 (type: decimal(17,2)), ((_col0 / _col1) * 100) (type: decimal(38,17))
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 225 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: decimal(17,2))
          TableScan
            Reduce Output Operator
              sort order: 
              Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: decimal(17,2))
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 
            1 
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 1 Data size: 225 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: decimal(17,2)), _col1 (type: decimal(17,2)), ((_col0 / _col1) * 100) (type: decimal(38,17))
            outputColumnNames: _col0, _col1, _col2
            Statistics: Num rows: 1 Data size: 225 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-48
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_2:dd 
          Fetch Operator
            limit: -1
        $hdt$_1:$hdt$_3:i 
          Fetch Operator
            limit: -1
        $hdt$_1:$hdt$_4:s 
          Fetch Operator
            limit: -1
        $hdt$_1:$hdt$_5:p 
          Fetch Operator
            limit: -1
        $hdt$_1:$hdt$_6:c 
          Fetch Operator
            limit: -1
        $hdt$_1:$hdt$_7:ca 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_2:dd 
          TableScan
            alias: dd
            Statistics: Num rows: 109573 Data size: 123050479 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2001) and (d_moy = 12) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 27393 Data size: 30762339 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 27393 Data size: 30762339 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)
        $hdt$_1:$hdt$_3:i 
          TableScan
            alias: i
            Statistics: Num rows: 17820 Data size: 31241101 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((i_category) IN ('Books', 'Music') and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 8910 Data size: 15620550 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 8910 Data size: 15620550 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)
        $hdt$_1:$hdt$_4:s 
          TableScan
            alias: s
            Statistics: Num rows: 12 Data size: 25956 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((s_gmt_offset = -5) and s_store_sk is not null) (type: boolean)
              Statistics: Num rows: 6 Data size: 12978 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 6 Data size: 12978 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: bigint)
                    1 _col0 (type: bigint)
        $hdt$_1:$hdt$_5:p 
          TableScan
            alias: p
            Statistics: Num rows: 300 Data size: 404700 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: p_promo_sk is not null (type: boolean)
              Statistics: Num rows: 300 Data size: 404700 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: p_promo_sk (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 300 Data size: 404700 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col4 (type: bigint)
                    1 _col0 (type: bigint)
        $hdt$_1:$hdt$_6:c 
          TableScan
            alias: c
            Statistics: Num rows: 99000 Data size: 88009812 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (c_customer_sk is not null and c_current_addr_sk is not null) (type: boolean)
              Statistics: Num rows: 99000 Data size: 88009812 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: c_customer_sk (type: bigint), c_current_addr_sk (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 99000 Data size: 88009812 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col2 (type: bigint)
                    1 _col0 (type: bigint)
        $hdt$_1:$hdt$_7:ca 
          TableScan
            alias: ca
            Statistics: Num rows: 49500 Data size: 55836000 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((ca_gmt_offset = -5) and ca_address_sk is not null) (type: boolean)
              Statistics: Num rows: 24750 Data size: 27918000 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ca_address_sk (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 24750 Data size: 27918000 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col15 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-23
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: ss
            Statistics: Num rows: 667579 Data size: 953293700 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_item_sk is not null and ss_store_sk is not null and ss_promo_sk is not null and ss_customer_sk is not null) (type: boolean)
              Statistics: Num rows: 667579 Data size: 953293700 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: bigint), ss_item_sk (type: bigint), ss_customer_sk (type: bigint), ss_store_sk (type: bigint), ss_promo_sk (type: bigint), ss_ext_sales_price (type: decimal(7,2))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 667579 Data size: 953293700 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col1, _col2, _col3, _col4, _col5
                  Statistics: Num rows: 734336 Data size: 1048623092 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col1 (type: bigint)
                      1 _col0 (type: bigint)
                    outputColumnNames: _col2, _col3, _col4, _col5
                    Statistics: Num rows: 807769 Data size: 1153485426 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col3 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col2, _col4, _col5
                      Statistics: Num rows: 888545 Data size: 1268833996 Basic stats: COMPLETE Column stats: NONE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col4 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col2, _col5
                        Statistics: Num rows: 977399 Data size: 1395717425 Basic stats: COMPLETE Column stats: NONE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col2 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col5, _col15
                          Statistics: Num rows: 1075138 Data size: 1535289200 Basic stats: COMPLETE Column stats: NONE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col15 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col5
                            Statistics: Num rows: 1182651 Data size: 1688818156 Basic stats: COMPLETE Column stats: NONE
                            Group By Operator
                              aggregations: sum(_col5)
                              mode: hash
                              outputColumnNames: _col0
                              Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: NONE
                              Reduce Output Operator
                                sort order: 
                                Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: NONE
                                value expressions: _col0 (type: decimal(17,2))
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          mode: mergepartial
          outputColumnNames: _col0
          Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

Time taken: 4.524 seconds, Fetched: 570 row(s)
======= q17_hive_run_query_0 time =======
Start timestamp: 2018/02/12:12:21:22 1518459682
Stop  timestamp: 2018/02/12:12:21:39 1518459699
Duration:  0h 0m 17s
q17_hive_run_query_0 SUCCESS exit code: 0 
----- result -----
EMPTY  bytes: 0
to display: hadoop fs -cat /user/wentingt/benchmarks/bigbench/queryResults/q17_hive_run_query_0_result/*
----- logs -----
time&status: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/times.csv
full log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q17_hive_run_query_0.log
=========================
@@@/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q18/query18.sql
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q18/engineLocalSettings.sql to hive init.
===============================================
Running query : q18
-----------------------------------------------
benchmark phase: run_query
stream number  : 0
user parameter file: 
user settings file : 
log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q18_hive_run_query_0.log
===============================================
checking existence of local: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs
creating/cleaning/set permissions for hdfs tmp and result folders for this query
hdfs client: hadoop fs
Duration for hdfs prepare:  0h 0m 17s
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q18/engineLocalSettings.sql to hive init.
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/log4j-slf4j-impl-2.6.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/users/wentingt/hadoop-3.0.0-beta1-src/hadoop-dist/target/hadoop-3.0.0-beta1/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]

Logging initialized using configuration in jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/hive-common-2.3.2.jar!/hive-log4j2.properties Async: true
hive.execution.engine=mr
hive.cbo.enable=true
hive.stats.fetch.partition.stats=true
hive.script.operator.truncate.env=false
hive.compute.query.using.stats=true
hive.vectorized.execution.enabled=false
hive.vectorized.execution.reduce.enabled=true
hive.stats.autogather=true
mapreduce.input.fileinputformat.split.minsize=1
mapreduce.input.fileinputformat.split.maxsize=256000000
hive.exec.reducers.bytes.per.reducer=256000000
hive.exec.reducers.max=1009
hive.exec.parallel=false
hive.exec.parallel.thread.number=8
hive.exec.compress.intermediate=false
hive.exec.compress.output=false
mapred.map.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
mapred.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
hive.default.fileformat=TEXTFILE
hive.auto.convert.sortmerge.join=false
hive.auto.convert.sortmerge.join.noconditionaltask is undefined
hive.optimize.bucketmapjoin=false
hive.optimize.bucketmapjoin.sortedmerge=false
hive.auto.convert.join.noconditionaltask.size=10000000
hive.auto.convert.join=true
hive.optimize.mapjoin.mapreduce is undefined
hive.mapred.local.mem=0
hive.mapjoin.smalltable.filesize=25000000
hive.mapjoin.localtask.max.memory.usage=0.9
hive.optimize.skewjoin=false
hive.optimize.skewjoin.compiletime=false
hive.optimize.ppd=true
hive.optimize.ppd.storage=true
hive.ppd.recognizetransivity=true
hive.optimize.index.filter=false
hive.optimize.sampling.orderby=false
hive.optimize.sampling.orderby.number=1000
hive.optimize.sampling.orderby.percent=0.1
bigbench.hive.optimize.sampling.orderby=true
bigbench.hive.optimize.sampling.orderby.number=20000
bigbench.hive.optimize.sampling.orderby.percent=0.1
hive.groupby.skewindata=false
hive.exec.submit.local.task.via.child=true
Added [/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/Resources/opennlp-maxent-3.0.3.jar] to class path
Added resources: [/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/Resources/opennlp-maxent-3.0.3.jar]
Added [/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/Resources/opennlp-tools-1.6.0.jar] to class path
Added resources: [/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/Resources/opennlp-tools-1.6.0.jar]
Added [/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/Resources/bigbenchqueriesmr.jar] to class path
Added resources: [/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/Resources/bigbenchqueriesmr.jar]
new io.bigdatabenchmark.v1.queries.q18.NegativeSentimentUDF()
new io.bigdatabenchmark.v1.queries.q18.NegativeSentimentUDF() done
OK
Time taken: 0.154 seconds
OK
Time taken: 0.091 seconds
NoViableAltException(350@[()* loopback of 430:20: ( ( LSQUARE ^ expression RSQUARE !) | ( DOT ^ identifier ) )*])
	at org.antlr.runtime.DFA.noViableAlt(DFA.java:158)
	at org.antlr.runtime.DFA.predict(DFA.java:116)
	at org.apache.hadoop.hive.ql.parse.HiveParser_IdentifiersParser.precedenceFieldExpression(HiveParser_IdentifiersParser.java:6997)
	at org.apache.hadoop.hive.ql.parse.HiveParser_IdentifiersParser.precedenceUnaryPrefixExpression(HiveParser_IdentifiersParser.java:7324)
	at org.apache.hadoop.hive.ql.parse.HiveParser_IdentifiersParser.precedenceUnarySuffixExpression(HiveParser_IdentifiersParser.java:7380)
	at org.apache.hadoop.hive.ql.parse.HiveParser_IdentifiersParser.precedenceBitwiseXorExpression(HiveParser_IdentifiersParser.java:7542)
	at org.apache.hadoop.hive.ql.parse.HiveParser_IdentifiersParser.precedenceStarExpression(HiveParser_IdentifiersParser.java:7685)
	at org.apache.hadoop.hive.ql.parse.HiveParser_IdentifiersParser.precedencePlusExpression(HiveParser_IdentifiersParser.java:7828)
	at org.apache.hadoop.hive.ql.parse.HiveParser_IdentifiersParser.precedenceConcatenateExpression(HiveParser_IdentifiersParser.java:7967)
	at org.apache.hadoop.hive.ql.parse.HiveParser_IdentifiersParser.precedenceAmpersandExpression(HiveParser_IdentifiersParser.java:8177)
	at org.apache.hadoop.hive.ql.parse.HiveParser_IdentifiersParser.precedenceBitwiseOrExpression(HiveParser_IdentifiersParser.java:8314)
	at org.apache.hadoop.hive.ql.parse.HiveParser_IdentifiersParser.precedenceSimilarExpressionMain(HiveParser_IdentifiersParser.java:8801)
	at org.apache.hadoop.hive.ql.parse.HiveParser_IdentifiersParser.precedenceSimilarExpression(HiveParser_IdentifiersParser.java:8697)
	at org.apache.hadoop.hive.ql.parse.HiveParser_IdentifiersParser.precedenceEqualExpression(HiveParser_IdentifiersParser.java:9561)
	at org.apache.hadoop.hive.ql.parse.HiveParser_IdentifiersParser.precedenceNotExpression(HiveParser_IdentifiersParser.java:9703)
	at org.apache.hadoop.hive.ql.parse.HiveParser_IdentifiersParser.precedenceAndExpression(HiveParser_IdentifiersParser.java:9836)
	at org.apache.hadoop.hive.ql.parse.HiveParser_IdentifiersParser.precedenceOrExpression(HiveParser_IdentifiersParser.java:9953)
	at org.apache.hadoop.hive.ql.parse.HiveParser_IdentifiersParser.expression(HiveParser_IdentifiersParser.java:6686)
	at org.apache.hadoop.hive.ql.parse.HiveParser.expression(HiveParser.java:41942)
	at org.apache.hadoop.hive.ql.parse.HiveParser_FromClauseParser.searchCondition(HiveParser_FromClauseParser.java:6446)
	at org.apache.hadoop.hive.ql.parse.HiveParser_FromClauseParser.whereClause(HiveParser_FromClauseParser.java:6364)
	at org.apache.hadoop.hive.ql.parse.HiveParser.whereClause(HiveParser.java:42024)
	at org.apache.hadoop.hive.ql.parse.HiveParser.atomSelectStatement(HiveParser.java:36755)
	at org.apache.hadoop.hive.ql.parse.HiveParser.selectStatement(HiveParser.java:36987)
	at org.apache.hadoop.hive.ql.parse.HiveParser.selectStatementWithCTE(HiveParser.java:37675)
	at org.apache.hadoop.hive.ql.parse.HiveParser.createTableStatement(HiveParser.java:6361)
	at org.apache.hadoop.hive.ql.parse.HiveParser.ddlStatement(HiveParser.java:3808)
	at org.apache.hadoop.hive.ql.parse.HiveParser.execStatement(HiveParser.java:2382)
	at org.apache.hadoop.hive.ql.parse.HiveParser.statement(HiveParser.java:1333)
	at org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:208)
	at org.apache.hadoop.hive.ql.parse.ParseUtils.parse(ParseUtils.java:77)
	at org.apache.hadoop.hive.ql.parse.ParseUtils.parse(ParseUtils.java:70)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:468)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:1317)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:1457)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:1237)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:1227)
	at org.apache.hadoop.hive.cli.CliDriver.processLocalCmd(CliDriver.java:233)
	at org.apache.hadoop.hive.cli.CliDriver.processCmd(CliDriver.java:184)
	at org.apache.hadoop.hive.cli.CliDriver.processLine(CliDriver.java:403)
	at org.apache.hadoop.hive.cli.CliDriver.processLine(CliDriver.java:336)
	at org.apache.hadoop.hive.cli.CliDriver.processReader(CliDriver.java:474)
	at org.apache.hadoop.hive.cli.CliDriver.processFile(CliDriver.java:490)
	at org.apache.hadoop.hive.cli.CliDriver.executeDriver(CliDriver.java:793)
	at org.apache.hadoop.hive.cli.CliDriver.run(CliDriver.java:759)
	at org.apache.hadoop.hive.cli.CliDriver.main(CliDriver.java:686)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.util.RunJar.run(RunJar.java:239)
	at org.apache.hadoop.util.RunJar.main(RunJar.java:153)
FAILED: ParseException line 52:0 cannot recognize input near ';' 'DROP' 'TABLE' in expression specification
An error occured while running command:
==========
runEngineCmd -f /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q18/q18.sql
==========
Please check the log files for details
======= q18_hive_run_query_0 time =======
Start timestamp: 2018/02/12:12:21:58 1518459718
Stop  timestamp: 2018/02/12:12:22:10 1518459730
Duration:  0h 0m 12s
q18_hive_run_query_0 FAILED exit code: 64 
----- result -----
EMPTY  bytes: 0
to display: hadoop fs -cat /user/wentingt/benchmarks/bigbench/queryResults/q18_hive_run_query_0_result/*
----- logs -----
time&status: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/times.csv
full log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q18_hive_run_query_0.log
=========================
An error occured while running command:
==========
runModule
==========
Please check the log files for details
@@@/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q19/query19.sql
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q19/engineLocalSettings.sql to hive init.
===============================================
Running query : q19
-----------------------------------------------
benchmark phase: run_query
stream number  : 0
user parameter file: 
user settings file : 
log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q19_hive_run_query_0.log
===============================================
checking existence of local: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs
creating/cleaning/set permissions for hdfs tmp and result folders for this query
hdfs client: hadoop fs
Duration for hdfs prepare:  0h 0m 16s
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q19/engineLocalSettings.sql to hive init.
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/log4j-slf4j-impl-2.6.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/users/wentingt/hadoop-3.0.0-beta1-src/hadoop-dist/target/hadoop-3.0.0-beta1/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]

Logging initialized using configuration in jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/hive-common-2.3.2.jar!/hive-log4j2.properties Async: true
hive.execution.engine=mr
hive.cbo.enable=true
hive.stats.fetch.partition.stats=true
hive.script.operator.truncate.env=false
hive.compute.query.using.stats=true
hive.vectorized.execution.enabled=false
hive.vectorized.execution.reduce.enabled=true
hive.stats.autogather=true
mapreduce.input.fileinputformat.split.minsize=1
mapreduce.input.fileinputformat.split.maxsize=256000000
hive.exec.reducers.bytes.per.reducer=256000000
hive.exec.reducers.max=1009
hive.exec.parallel=false
hive.exec.parallel.thread.number=8
hive.exec.compress.intermediate=false
hive.exec.compress.output=false
mapred.map.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
mapred.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
hive.default.fileformat=TEXTFILE
hive.auto.convert.sortmerge.join=false
hive.auto.convert.sortmerge.join.noconditionaltask is undefined
hive.optimize.bucketmapjoin=false
hive.optimize.bucketmapjoin.sortedmerge=false
hive.auto.convert.join.noconditionaltask.size=10000000
hive.auto.convert.join=true
hive.optimize.mapjoin.mapreduce is undefined
hive.mapred.local.mem=0
hive.mapjoin.smalltable.filesize=25000000
hive.mapjoin.localtask.max.memory.usage=0.9
hive.optimize.skewjoin=false
hive.optimize.skewjoin.compiletime=false
hive.optimize.ppd=true
hive.optimize.ppd.storage=true
hive.ppd.recognizetransivity=true
hive.optimize.index.filter=false
hive.optimize.sampling.orderby=false
hive.optimize.sampling.orderby.number=1000
hive.optimize.sampling.orderby.percent=0.1
bigbench.hive.optimize.sampling.orderby=true
bigbench.hive.optimize.sampling.orderby.number=20000
bigbench.hive.optimize.sampling.orderby.percent=0.1
hive.groupby.skewindata=false
hive.exec.submit.local.task.via.child=true
Added [/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/Resources/opennlp-maxent-3.0.3.jar] to class path
Added resources: [/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/Resources/opennlp-maxent-3.0.3.jar]
Added [/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/Resources/opennlp-tools-1.6.0.jar] to class path
Added resources: [/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/Resources/opennlp-tools-1.6.0.jar]
Added [/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/Resources/bigbenchqueriesmr.jar] to class path
Added resources: [/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/Resources/bigbenchqueriesmr.jar]
initialize io.bigdatabenchmark.v1.queries.q10.SentimentUDF()
initialize io.bigdatabenchmark.v1.queries.q10.SentimentUDF() done
OK
Time taken: 0.161 seconds
hive.exec.compress.output=false
hive.optimize.sampling.orderby=true
hive.optimize.sampling.orderby.number=20000
hive.optimize.sampling.orderby.percent=0.1
OK
Time taken: 0.082 seconds
OK
Time taken: 0.518 seconds
initialize io.bigdatabenchmark.v1.queries.q10.SentimentUDF()
initialize io.bigdatabenchmark.v1.queries.q10.SentimentUDF() done
initialize() io.bigdatabenchmark.v1.queries.q10.SentimentUDF
initialize() io.bigdatabenchmark.v1.queries.q10.SentimentUDF done
initialize io.bigdatabenchmark.v1.queries.q10.SentimentUDF()
initialize io.bigdatabenchmark.v1.queries.q10.SentimentUDF() done
initialize io.bigdatabenchmark.v1.queries.q10.SentimentUDF()
initialize io.bigdatabenchmark.v1.queries.q10.SentimentUDF() done
initialize io.bigdatabenchmark.v1.queries.q10.SentimentUDF()
initialize io.bigdatabenchmark.v1.queries.q10.SentimentUDF() done
OK
STAGE DEPENDENCIES:
  Stage-26 is a root stage
  Stage-3 depends on stages: Stage-26
  Stage-18 depends on stages: Stage-3, Stage-11 , consists of Stage-23, Stage-24, Stage-25, Stage-4
  Stage-23 has a backup stage: Stage-4
  Stage-15 depends on stages: Stage-23
  Stage-5 depends on stages: Stage-4, Stage-15, Stage-16, Stage-17
  Stage-0 depends on stages: Stage-5
  Stage-6 depends on stages: Stage-0
  Stage-24 has a backup stage: Stage-4
  Stage-16 depends on stages: Stage-24
  Stage-25 has a backup stage: Stage-4
  Stage-17 depends on stages: Stage-25
  Stage-4
  Stage-27 is a root stage
  Stage-11 depends on stages: Stage-27

STAGE PLANS:
  Stage: Stage-26
    Map Reduce Local Work
      Alias -> Map Local Tables:
        extractedsentiments:fsr:sr 
          Fetch Operator
            limit: -1
        extractedsentiments:fsr:sr_datefilter:d1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        extractedsentiments:fsr:sr 
          TableScan
            alias: sr
            Statistics: Num rows: 37902 Data size: 41388272 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (sr_returned_date_sk is not null and sr_item_sk is not null) (type: boolean)
              Statistics: Num rows: 37902 Data size: 41388272 Basic stats: COMPLETE Column stats: NONE
              HashTable Sink Operator
                keys:
                  0 sr_returned_date_sk (type: bigint)
                  1 _col0 (type: bigint)
        extractedsentiments:fsr:sr_datefilter:d1 
          TableScan
            alias: d1
            Statistics: Num rows: 109573 Data size: 123050479 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_week_seq is not null and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 109573 Data size: 123050479 Basic stats: COMPLETE Column stats: NONE
              HashTable Sink Operator
                keys:
                  0 d_week_seq (type: int)
                  1 d_week_seq (type: int)

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: d2
            Statistics: Num rows: 109573 Data size: 123050479 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_week_seq is not null and (d_date) IN ('2004-03-8', '2004-08-02', '2004-11-15', '2004-12-20')) (type: boolean)
              Statistics: Num rows: 54787 Data size: 61525801 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 d_week_seq (type: int)
                  1 d_week_seq (type: int)
                outputColumnNames: _col0, _col4, _col35
                Statistics: Num rows: 120530 Data size: 135355529 Basic stats: COMPLETE Column stats: NONE
                Filter Operator
                  predicate: (_col4 = _col35) (type: boolean)
                  Statistics: Num rows: 60265 Data size: 67677764 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col0 (type: bigint)
                    outputColumnNames: _col0
                    Statistics: Num rows: 60265 Data size: 67677764 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 sr_returned_date_sk (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0, _col2, _col10, _col23
                      Statistics: Num rows: 66291 Data size: 74445542 Basic stats: COMPLETE Column stats: NONE
                      Filter Operator
                        predicate: (_col0 = _col23) (type: boolean)
                        Statistics: Num rows: 33145 Data size: 37222209 Basic stats: COMPLETE Column stats: NONE
                        Select Operator
                          expressions: _col2 (type: bigint), _col10 (type: int)
                          outputColumnNames: _col2, _col10
                          Statistics: Num rows: 33145 Data size: 37222209 Basic stats: COMPLETE Column stats: NONE
                          Group By Operator
                            aggregations: sum(_col10)
                            keys: _col2 (type: bigint)
                            mode: hash
                            outputColumnNames: _col0, _col1
                            Statistics: Num rows: 33145 Data size: 37222209 Basic stats: COMPLETE Column stats: NONE
                            Reduce Output Operator
                              key expressions: _col0 (type: bigint)
                              sort order: +
                              Map-reduce partition columns: _col0 (type: bigint)
                              Statistics: Num rows: 33145 Data size: 37222209 Basic stats: COMPLETE Column stats: NONE
                              value expressions: _col1 (type: bigint)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: bigint)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 16572 Data size: 18610542 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (_col1 > 0) (type: boolean)
            Statistics: Num rows: 5524 Data size: 6203514 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-18
    Conditional Operator

  Stage: Stage-23
    Map Reduce Local Work
      Alias -> Map Local Tables:
        extractedsentiments:$INTNAME 
          Fetch Operator
            limit: -1
        extractedsentiments:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        extractedsentiments:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 pr_item_sk (type: bigint)
                1 _col0 (type: bigint)
                2 _col0 (type: bigint)
        extractedsentiments:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 pr_item_sk (type: bigint)
                1 _col0 (type: bigint)
                2 _col0 (type: bigint)

  Stage: Stage-15
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: pr
            Statistics: Num rows: 89991 Data size: 79597045 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: pr_item_sk is not null (type: boolean)
              Statistics: Num rows: 89991 Data size: 79597045 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                     Inner Join 1 to 2
                keys:
                  0 pr_item_sk (type: bigint)
                  1 _col0 (type: bigint)
                  2 _col0 (type: bigint)
                outputColumnNames: _col4, _col7, _col11, _col12, _col13, _col14
                Statistics: Num rows: 197980 Data size: 175113502 Basic stats: COMPLETE Column stats: NONE
                Filter Operator
                  predicate: ((abs(((_col12 - _col14) / ((_col12 + _col14) / 2))) <= 0.1) and (_col4 = _col11) and (_col11 = _col13)) (type: boolean)
                  Statistics: Num rows: 16498 Data size: 14592496 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col4 (type: bigint), _col7 (type: string)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 16498 Data size: 14592496 Basic stats: COMPLETE Column stats: NONE
                    UDTF Operator
                      Statistics: Num rows: 16498 Data size: 14592496 Basic stats: COMPLETE Column stats: NONE
                      function name: io.bigdatabenchmark.v1.queries.q10.SentimentUDF@1802f60c
                      Filter Operator
                        predicate: (sentiment = 'NEG') (type: boolean)
                        Statistics: Num rows: 8249 Data size: 7296248 Basic stats: COMPLETE Column stats: NONE
                        Select Operator
                          expressions: item_sk (type: bigint), sentence (type: string), sentiment_word (type: string)
                          outputColumnNames: _col0, _col1, _col3
                          Statistics: Num rows: 8249 Data size: 7296248 Basic stats: COMPLETE Column stats: NONE
                          File Output Operator
                            compressed: false
                            table:
                                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint), _col1 (type: string), 'NEG' (type: string), _col3 (type: string)
              sort order: ++++
              Statistics: Num rows: 8249 Data size: 7296248 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: string), 'NEG' (type: string), KEY.reducesinkkey3 (type: string)
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 8249 Data size: 7296248 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 8249 Data size: 7296248 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.TextInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                name: bigbench.q19_hive_run_query_0_result

  Stage: Stage-0
    Move Operator
      tables:
          replace: false
          table:
              input format: org.apache.hadoop.mapred.TextInputFormat
              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
              serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
              name: bigbench.q19_hive_run_query_0_result

  Stage: Stage-6
    Stats-Aggr Operator

  Stage: Stage-24
    Map Reduce Local Work
      Alias -> Map Local Tables:
        extractedsentiments:$INTNAME1 
          Fetch Operator
            limit: -1
        extractedsentiments:pr 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        extractedsentiments:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 pr_item_sk (type: bigint)
                1 _col0 (type: bigint)
                2 _col0 (type: bigint)
        extractedsentiments:pr 
          TableScan
            alias: pr
            Statistics: Num rows: 89991 Data size: 79597045 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: pr_item_sk is not null (type: boolean)
              Statistics: Num rows: 89991 Data size: 79597045 Basic stats: COMPLETE Column stats: NONE
              HashTable Sink Operator
                keys:
                  0 pr_item_sk (type: bigint)
                  1 _col0 (type: bigint)
                  2 _col0 (type: bigint)

  Stage: Stage-16
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 1 to 2
              keys:
                0 pr_item_sk (type: bigint)
                1 _col0 (type: bigint)
                2 _col0 (type: bigint)
              outputColumnNames: _col4, _col7, _col11, _col12, _col13, _col14
              Statistics: Num rows: 197980 Data size: 175113502 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: ((abs(((_col12 - _col14) / ((_col12 + _col14) / 2))) <= 0.1) and (_col4 = _col11) and (_col11 = _col13)) (type: boolean)
                Statistics: Num rows: 16498 Data size: 14592496 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col4 (type: bigint), _col7 (type: string)
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 16498 Data size: 14592496 Basic stats: COMPLETE Column stats: NONE
                  UDTF Operator
                    Statistics: Num rows: 16498 Data size: 14592496 Basic stats: COMPLETE Column stats: NONE
                    function name: io.bigdatabenchmark.v1.queries.q10.SentimentUDF@56ed2baf
                    Filter Operator
                      predicate: (sentiment = 'NEG') (type: boolean)
                      Statistics: Num rows: 8249 Data size: 7296248 Basic stats: COMPLETE Column stats: NONE
                      Select Operator
                        expressions: item_sk (type: bigint), sentence (type: string), sentiment_word (type: string)
                        outputColumnNames: _col0, _col1, _col3
                        Statistics: Num rows: 8249 Data size: 7296248 Basic stats: COMPLETE Column stats: NONE
                        File Output Operator
                          compressed: false
                          table:
                              input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                              output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                              serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-25
    Map Reduce Local Work
      Alias -> Map Local Tables:
        extractedsentiments:$INTNAME 
          Fetch Operator
            limit: -1
        extractedsentiments:pr 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        extractedsentiments:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 pr_item_sk (type: bigint)
                1 _col0 (type: bigint)
                2 _col0 (type: bigint)
        extractedsentiments:pr 
          TableScan
            alias: pr
            Statistics: Num rows: 89991 Data size: 79597045 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: pr_item_sk is not null (type: boolean)
              Statistics: Num rows: 89991 Data size: 79597045 Basic stats: COMPLETE Column stats: NONE
              HashTable Sink Operator
                keys:
                  0 pr_item_sk (type: bigint)
                  1 _col0 (type: bigint)
                  2 _col0 (type: bigint)

  Stage: Stage-17
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
                   Inner Join 1 to 2
              keys:
                0 pr_item_sk (type: bigint)
                1 _col0 (type: bigint)
                2 _col0 (type: bigint)
              outputColumnNames: _col4, _col7, _col11, _col12, _col13, _col14
              Statistics: Num rows: 197980 Data size: 175113502 Basic stats: COMPLETE Column stats: NONE
              Filter Operator
                predicate: ((abs(((_col12 - _col14) / ((_col12 + _col14) / 2))) <= 0.1) and (_col4 = _col11) and (_col11 = _col13)) (type: boolean)
                Statistics: Num rows: 16498 Data size: 14592496 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col4 (type: bigint), _col7 (type: string)
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 16498 Data size: 14592496 Basic stats: COMPLETE Column stats: NONE
                  UDTF Operator
                    Statistics: Num rows: 16498 Data size: 14592496 Basic stats: COMPLETE Column stats: NONE
                    function name: io.bigdatabenchmark.v1.queries.q10.SentimentUDF@24ac87a
                    Filter Operator
                      predicate: (sentiment = 'NEG') (type: boolean)
                      Statistics: Num rows: 8249 Data size: 7296248 Basic stats: COMPLETE Column stats: NONE
                      Select Operator
                        expressions: item_sk (type: bigint), sentence (type: string), sentiment_word (type: string)
                        outputColumnNames: _col0, _col1, _col3
                        Statistics: Num rows: 8249 Data size: 7296248 Basic stats: COMPLETE Column stats: NONE
                        File Output Operator
                          compressed: false
                          table:
                              input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                              output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                              serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 5524 Data size: 6203514 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: bigint)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 5524 Data size: 6203514 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: bigint)
          TableScan
            alias: pr
            Statistics: Num rows: 89991 Data size: 79597045 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: pr_item_sk is not null (type: boolean)
              Statistics: Num rows: 89991 Data size: 79597045 Basic stats: COMPLETE Column stats: NONE
              Reduce Output Operator
                key expressions: pr_item_sk (type: bigint)
                sort order: +
                Map-reduce partition columns: pr_item_sk (type: bigint)
                Statistics: Num rows: 89991 Data size: 79597045 Basic stats: COMPLETE Column stats: NONE
                value expressions: pr_review_content (type: string)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
               Inner Join 1 to 2
          keys:
            0 pr_item_sk (type: bigint)
            1 _col0 (type: bigint)
            2 _col0 (type: bigint)
          outputColumnNames: _col4, _col7, _col11, _col12, _col13, _col14
          Statistics: Num rows: 197980 Data size: 175113502 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: ((abs(((_col12 - _col14) / ((_col12 + _col14) / 2))) <= 0.1) and (_col4 = _col11) and (_col11 = _col13)) (type: boolean)
            Statistics: Num rows: 16498 Data size: 14592496 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col4 (type: bigint), _col7 (type: string)
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 16498 Data size: 14592496 Basic stats: COMPLETE Column stats: NONE
              UDTF Operator
                Statistics: Num rows: 16498 Data size: 14592496 Basic stats: COMPLETE Column stats: NONE
                function name: io.bigdatabenchmark.v1.queries.q10.SentimentUDF@d763b06
                Filter Operator
                  predicate: (sentiment = 'NEG') (type: boolean)
                  Statistics: Num rows: 8249 Data size: 7296248 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: item_sk (type: bigint), sentence (type: string), sentiment_word (type: string)
                    outputColumnNames: _col0, _col1, _col3
                    Statistics: Num rows: 8249 Data size: 7296248 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-27
    Map Reduce Local Work
      Alias -> Map Local Tables:
        extractedsentiments:fwr:wr 
          Fetch Operator
            limit: -1
        extractedsentiments:fwr:wr_datefilter:d1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        extractedsentiments:fwr:wr 
          TableScan
            alias: wr
            Statistics: Num rows: 38487 Data size: 43257220 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (wr_returned_date_sk is not null and wr_item_sk is not null) (type: boolean)
              Statistics: Num rows: 38487 Data size: 43257220 Basic stats: COMPLETE Column stats: NONE
              HashTable Sink Operator
                keys:
                  0 wr_returned_date_sk (type: bigint)
                  1 _col0 (type: bigint)
        extractedsentiments:fwr:wr_datefilter:d1 
          TableScan
            alias: d1
            Statistics: Num rows: 109573 Data size: 123050479 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_week_seq is not null and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 109573 Data size: 123050479 Basic stats: COMPLETE Column stats: NONE
              HashTable Sink Operator
                keys:
                  0 d_week_seq (type: int)
                  1 d_week_seq (type: int)

  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: d2
            Statistics: Num rows: 109573 Data size: 123050479 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_week_seq is not null and (d_date) IN ('2004-03-8', '2004-08-02', '2004-11-15', '2004-12-20')) (type: boolean)
              Statistics: Num rows: 54787 Data size: 61525801 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 d_week_seq (type: int)
                  1 d_week_seq (type: int)
                outputColumnNames: _col0, _col4, _col35
                Statistics: Num rows: 120530 Data size: 135355529 Basic stats: COMPLETE Column stats: NONE
                Filter Operator
                  predicate: (_col4 = _col35) (type: boolean)
                  Statistics: Num rows: 60265 Data size: 67677764 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col0 (type: bigint)
                    outputColumnNames: _col0
                    Statistics: Num rows: 60265 Data size: 67677764 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 wr_returned_date_sk (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0, _col2, _col14, _col27
                      Statistics: Num rows: 66291 Data size: 74445542 Basic stats: COMPLETE Column stats: NONE
                      Filter Operator
                        predicate: (_col0 = _col27) (type: boolean)
                        Statistics: Num rows: 33145 Data size: 37222209 Basic stats: COMPLETE Column stats: NONE
                        Select Operator
                          expressions: _col2 (type: bigint), _col14 (type: int)
                          outputColumnNames: _col2, _col14
                          Statistics: Num rows: 33145 Data size: 37222209 Basic stats: COMPLETE Column stats: NONE
                          Group By Operator
                            aggregations: sum(_col14)
                            keys: _col2 (type: bigint)
                            mode: hash
                            outputColumnNames: _col0, _col1
                            Statistics: Num rows: 33145 Data size: 37222209 Basic stats: COMPLETE Column stats: NONE
                            Reduce Output Operator
                              key expressions: _col0 (type: bigint)
                              sort order: +
                              Map-reduce partition columns: _col0 (type: bigint)
                              Statistics: Num rows: 33145 Data size: 37222209 Basic stats: COMPLETE Column stats: NONE
                              value expressions: _col1 (type: bigint)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0)
          keys: KEY._col0 (type: bigint)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 16572 Data size: 18610542 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (_col1 > 0) (type: boolean)
            Statistics: Num rows: 5524 Data size: 6203514 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

Time taken: 2.957 seconds, Fetched: 536 row(s)
======= q19_hive_run_query_0 time =======
Start timestamp: 2018/02/12:12:22:28 1518459748
Stop  timestamp: 2018/02/12:12:22:44 1518459764
Duration:  0h 0m 16s
q19_hive_run_query_0 SUCCESS exit code: 0 
----- result -----
EMPTY  bytes: 0
to display: hadoop fs -cat /user/wentingt/benchmarks/bigbench/queryResults/q19_hive_run_query_0_result/*
----- logs -----
time&status: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/times.csv
full log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q19_hive_run_query_0.log
=========================
@@@/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q20/query20.sql
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q20/engineLocalSettings.sql to hive init.
===============================================
Running query : q20
-----------------------------------------------
benchmark phase: run_query
stream number  : 0
user parameter file: 
user settings file : 
log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q20_hive_run_query_0.log
===============================================
checking existence of local: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs
creating/cleaning/set permissions for hdfs tmp and result folders for this query
hdfs client: hadoop fs
Duration for hdfs prepare:  0h 0m 17s
=========================
q20 Step 1/3: Executing hive queries
tmp output: /user/wentingt/benchmarks/bigbench/temp/q20_hive_run_query_0_temp
=========================
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q20/engineLocalSettings.sql to hive init.
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/log4j-slf4j-impl-2.6.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/users/wentingt/hadoop-3.0.0-beta1-src/hadoop-dist/target/hadoop-3.0.0-beta1/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]

Logging initialized using configuration in jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/hive-common-2.3.2.jar!/hive-log4j2.properties Async: true
hive.execution.engine=mr
hive.cbo.enable=true
hive.stats.fetch.partition.stats=true
hive.script.operator.truncate.env=false
hive.compute.query.using.stats=true
hive.vectorized.execution.enabled=false
hive.vectorized.execution.reduce.enabled=true
hive.stats.autogather=true
mapreduce.input.fileinputformat.split.minsize=1
mapreduce.input.fileinputformat.split.maxsize=256000000
hive.exec.reducers.bytes.per.reducer=256000000
hive.exec.reducers.max=1009
hive.exec.parallel=false
hive.exec.parallel.thread.number=8
hive.exec.compress.intermediate=false
hive.exec.compress.output=false
mapred.map.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
mapred.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
hive.default.fileformat=TEXTFILE
hive.auto.convert.sortmerge.join=false
hive.auto.convert.sortmerge.join.noconditionaltask is undefined
hive.optimize.bucketmapjoin=false
hive.optimize.bucketmapjoin.sortedmerge=false
hive.auto.convert.join.noconditionaltask.size=10000000
hive.auto.convert.join=true
hive.optimize.mapjoin.mapreduce is undefined
hive.mapred.local.mem=0
hive.mapjoin.smalltable.filesize=25000000
hive.mapjoin.localtask.max.memory.usage=0.9
hive.optimize.skewjoin=false
hive.optimize.skewjoin.compiletime=false
hive.optimize.ppd=true
hive.optimize.ppd.storage=true
hive.ppd.recognizetransivity=true
hive.optimize.index.filter=false
hive.optimize.sampling.orderby=false
hive.optimize.sampling.orderby.number=1000
hive.optimize.sampling.orderby.percent=0.1
bigbench.hive.optimize.sampling.orderby=true
bigbench.hive.optimize.sampling.orderby.number=20000
bigbench.hive.optimize.sampling.orderby.percent=0.1
hive.groupby.skewindata=false
hive.exec.submit.local.task.via.child=true
hive.optimize.sampling.orderby=true
hive.optimize.sampling.orderby.number=20000
hive.optimize.sampling.orderby.percent=0.1
OK
Time taken: 0.098 seconds
OK
Time taken: 0.754 seconds
OK
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-7 depends on stages: Stage-1, Stage-5 , consists of Stage-8, Stage-2
  Stage-8 has a backup stage: Stage-2
  Stage-6 depends on stages: Stage-8
  Stage-3 depends on stages: Stage-2, Stage-6
  Stage-0 depends on stages: Stage-3
  Stage-4 depends on stages: Stage-0
  Stage-2
  Stage-5 is a root stage

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: s
            Statistics: Num rows: 667579 Data size: 953293700 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: ss_customer_sk (type: bigint), ss_ticket_number (type: bigint), ss_item_sk (type: bigint), ss_net_paid (type: decimal(7,2))
              outputColumnNames: ss_customer_sk, ss_ticket_number, ss_item_sk, ss_net_paid
              Statistics: Num rows: 667579 Data size: 953293700 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: count(DISTINCT ss_ticket_number), count(ss_item_sk), sum(ss_net_paid)
                keys: ss_customer_sk (type: bigint), ss_ticket_number (type: bigint)
                mode: hash
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 667579 Data size: 953293700 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 667579 Data size: 953293700 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col3 (type: bigint), _col4 (type: decimal(17,2))
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(DISTINCT KEY._col1:0._col0), count(VALUE._col1), sum(VALUE._col2)
          keys: KEY._col0 (type: bigint)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 333789 Data size: 476646136 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-7
    Conditional Operator

  Stage: Stage-8
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint)
                1 _col0 (type: bigint)

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Left Outer Join0 to 1
              keys:
                0 _col0 (type: bigint)
                1 _col0 (type: bigint)
              outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col6, _col7
              Statistics: Num rows: 367167 Data size: 524310760 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col0 (type: bigint), round(CASE WHEN ((_col5 is null or _col1 is null or (UDFToDouble(_col5) / UDFToDouble(_col1)) is null)) THEN (0) ELSE ((UDFToDouble(_col5) / UDFToDouble(_col1))) END, 7) (type: double), round(CASE WHEN ((_col6 is null or _col2 is null or (UDFToDouble(_col6) / UDFToDouble(_col2)) is null)) THEN (0) ELSE ((UDFToDouble(_col6) / UDFToDouble(_col2))) END, 7) (type: double), round(CASE WHEN ((_col7 is null or _col3 is null or (_col7 / _col3) is null)) THEN (0) ELSE ((_col7 / _col3)) END, 7) (type: decimal(25,7)), round(CASE WHEN (_col5 is null) THEN (0) ELSE (_col5) END, 0) (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 367167 Data size: 524310760 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Statistics: Num rows: 367167 Data size: 524310760 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: double), _col2 (type: double), _col3 (type: decimal(25,7)), _col4 (type: bigint)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: bigint), VALUE._col0 (type: double), VALUE._col1 (type: double), UDFToDouble(VALUE._col2) (type: double), UDFToDouble(VALUE._col3) (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4
          Statistics: Num rows: 367167 Data size: 524310760 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 367167 Data size: 524310760 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.TextInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                name: bigbench.q20_hive_run_query_0_temp

  Stage: Stage-0
    Move Operator
      tables:
          replace: false
          table:
              input format: org.apache.hadoop.mapred.TextInputFormat
              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
              serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
              name: bigbench.q20_hive_run_query_0_temp

  Stage: Stage-4
    Stats-Aggr Operator

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 333789 Data size: 476646136 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: bigint), _col2 (type: bigint), _col3 (type: decimal(17,2))
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 18951 Data size: 20694136 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: bigint), _col2 (type: bigint), _col3 (type: decimal(17,2))
      Reduce Operator Tree:
        Join Operator
          condition map:
               Left Outer Join0 to 1
          keys:
            0 _col0 (type: bigint)
            1 _col0 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col6, _col7
          Statistics: Num rows: 367167 Data size: 524310760 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: bigint), round(CASE WHEN ((_col5 is null or _col1 is null or (UDFToDouble(_col5) / UDFToDouble(_col1)) is null)) THEN (0) ELSE ((UDFToDouble(_col5) / UDFToDouble(_col1))) END, 7) (type: double), round(CASE WHEN ((_col6 is null or _col2 is null or (UDFToDouble(_col6) / UDFToDouble(_col2)) is null)) THEN (0) ELSE ((UDFToDouble(_col6) / UDFToDouble(_col2))) END, 7) (type: double), round(CASE WHEN ((_col7 is null or _col3 is null or (_col7 / _col3) is null)) THEN (0) ELSE ((_col7 / _col3)) END, 7) (type: decimal(25,7)), round(CASE WHEN (_col5 is null) THEN (0) ELSE (_col5) END, 0) (type: bigint)
            outputColumnNames: _col0, _col1, _col2, _col3, _col4
            Statistics: Num rows: 367167 Data size: 524310760 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: store_returns
            Statistics: Num rows: 37902 Data size: 41388272 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: sr_customer_sk (type: bigint), sr_ticket_number (type: bigint), sr_item_sk (type: bigint), sr_return_amt (type: decimal(7,2))
              outputColumnNames: sr_customer_sk, sr_ticket_number, sr_item_sk, sr_return_amt
              Statistics: Num rows: 37902 Data size: 41388272 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: count(DISTINCT sr_ticket_number), count(sr_item_sk), sum(sr_return_amt)
                keys: sr_customer_sk (type: bigint), sr_ticket_number (type: bigint)
                mode: hash
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 37902 Data size: 41388272 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint), _col1 (type: bigint)
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 37902 Data size: 41388272 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col3 (type: bigint), _col4 (type: decimal(17,2))
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(DISTINCT KEY._col1:0._col0), count(VALUE._col1), sum(VALUE._col2)
          keys: KEY._col0 (type: bigint)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 18951 Data size: 20694136 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

Time taken: 3.211 seconds, Fetched: 199 row(s)
=========================
q20 Step 2/3: Calculating KMeans with spark
intput: --fromHiveMetastore true --input bigbench.q20_hive_run_query_0_temp
result output: /user/wentingt/benchmarks/bigbench/queryResults/q20_hive_run_query_0_result/
=========================
spark-submit --class io.bigdatabenchmark.v1.queries.KMeansClustering /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/Resources/bigbench-ml-spark.jar --fromHiveMetastore true --input bigbench.q20_hive_run_query_0_temp --output /user/wentingt/benchmarks/bigbench/queryResults/q20_hive_run_query_0_result/ --num-clusters 8 --iterations 20 --query-num q20 --saveClassificationResult true --saveMetaInfo true --verbose false
/users/wentingt/Big-Data-Benchmark-for-Big-Bench/bin/bigBench: line 64: spark-submit: command not found
An error occured while running command:
==========
spark-submit --class io.bigdatabenchmark.v1.queries.KMeansClustering /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/Resources/bigbench-ml-spark.jar --fromHiveMetastore true --input bigbench.q20_hive_run_query_0_temp --output /user/wentingt/benchmarks/bigbench/queryResults/q20_hive_run_query_0_result/ --num-clusters 8 --iterations 20 --query-num q20 --saveClassificationResult true --saveMetaInfo true --verbose false
==========
Please check the log files for details
======= q20_hive_run_query_0 time =======
Start timestamp: 2018/02/12:12:23:03 1518459783
Stop  timestamp: 2018/02/12:12:23:20 1518459800
Duration:  0h 0m 17s
q20_hive_run_query_0 FAILED exit code: 127 
----- result -----
EMPTY  bytes: 0
to display: hadoop fs -cat /user/wentingt/benchmarks/bigbench/queryResults/q20_hive_run_query_0_result/*
----- logs -----
time&status: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/times.csv
full log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q20_hive_run_query_0.log
=========================
An error occured while running command:
==========
runModule
==========
Please check the log files for details
@@@/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q21/query21.sql
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q21/engineLocalSettings.sql to hive init.
===============================================
Running query : q21
-----------------------------------------------
benchmark phase: run_query
stream number  : 0
user parameter file: 
user settings file : 
log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q21_hive_run_query_0.log
===============================================
checking existence of local: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs
creating/cleaning/set permissions for hdfs tmp and result folders for this query
hdfs client: hadoop fs
Duration for hdfs prepare:  0h 0m 17s
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q21/engineLocalSettings.sql to hive init.
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/log4j-slf4j-impl-2.6.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/users/wentingt/hadoop-3.0.0-beta1-src/hadoop-dist/target/hadoop-3.0.0-beta1/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]

Logging initialized using configuration in jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/hive-common-2.3.2.jar!/hive-log4j2.properties Async: true
hive.execution.engine=mr
hive.cbo.enable=true
hive.stats.fetch.partition.stats=true
hive.script.operator.truncate.env=false
hive.compute.query.using.stats=true
hive.vectorized.execution.enabled=false
hive.vectorized.execution.reduce.enabled=true
hive.stats.autogather=true
mapreduce.input.fileinputformat.split.minsize=1
mapreduce.input.fileinputformat.split.maxsize=256000000
hive.exec.reducers.bytes.per.reducer=256000000
hive.exec.reducers.max=1009
hive.exec.parallel=false
hive.exec.parallel.thread.number=8
hive.exec.compress.intermediate=false
hive.exec.compress.output=false
mapred.map.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
mapred.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
hive.default.fileformat=TEXTFILE
hive.auto.convert.sortmerge.join=false
hive.auto.convert.sortmerge.join.noconditionaltask is undefined
hive.optimize.bucketmapjoin=false
hive.optimize.bucketmapjoin.sortedmerge=false
hive.auto.convert.join.noconditionaltask.size=10000000
hive.auto.convert.join=true
hive.optimize.mapjoin.mapreduce is undefined
hive.mapred.local.mem=0
hive.mapjoin.smalltable.filesize=25000000
hive.mapjoin.localtask.max.memory.usage=0.9
hive.optimize.skewjoin=false
hive.optimize.skewjoin.compiletime=false
hive.optimize.ppd=true
hive.optimize.ppd.storage=true
hive.ppd.recognizetransivity=true
hive.optimize.index.filter=false
hive.optimize.sampling.orderby=false
hive.optimize.sampling.orderby.number=1000
hive.optimize.sampling.orderby.percent=0.1
bigbench.hive.optimize.sampling.orderby=true
bigbench.hive.optimize.sampling.orderby.number=20000
bigbench.hive.optimize.sampling.orderby.percent=0.1
hive.groupby.skewindata=false
hive.exec.submit.local.task.via.child=true
hive.exec.compress.output=false
OK
Time taken: 0.063 seconds
OK
Time taken: 0.568 seconds
No Stats for bigbench@store_returns, Columns: sr_returned_date_sk, sr_ticket_number, sr_item_sk, sr_return_quantity, sr_customer_sk
No Stats for bigbench@date_dim, Columns: d_moy, d_date_sk, d_year
No Stats for bigbench@web_sales, Columns: ws_item_sk, ws_quantity, ws_sold_date_sk, ws_bill_customer_sk
No Stats for bigbench@date_dim, Columns: d_date_sk, d_year
No Stats for bigbench@store_sales, Columns: ss_customer_sk, ss_ticket_number, ss_sold_date_sk, ss_item_sk, ss_store_sk, ss_quantity
No Stats for bigbench@date_dim, Columns: d_moy, d_date_sk, d_year
No Stats for bigbench@store, Columns: s_store_id, s_store_name, s_store_sk
No Stats for bigbench@item, Columns: i_item_desc, i_item_id, i_item_sk
OK
STAGE DEPENDENCIES:
  Stage-32 is a root stage
  Stage-24 depends on stages: Stage-32
  Stage-23 depends on stages: Stage-24, Stage-25 , consists of Stage-30, Stage-31, Stage-2
  Stage-30 has a backup stage: Stage-2
  Stage-21 depends on stages: Stage-30
  Stage-20 depends on stages: Stage-2, Stage-21, Stage-22, Stage-26 , consists of Stage-28, Stage-29, Stage-3
  Stage-28 has a backup stage: Stage-3
  Stage-18 depends on stages: Stage-28
  Stage-27 depends on stages: Stage-3, Stage-18, Stage-19
  Stage-6 depends on stages: Stage-27
  Stage-7 depends on stages: Stage-6
  Stage-0 depends on stages: Stage-7
  Stage-8 depends on stages: Stage-0
  Stage-29 has a backup stage: Stage-3
  Stage-19 depends on stages: Stage-29
  Stage-3
  Stage-31 has a backup stage: Stage-2
  Stage-22 depends on stages: Stage-31
  Stage-2
  Stage-33 is a root stage
  Stage-25 depends on stages: Stage-33
  Stage-34 is a root stage
  Stage-26 depends on stages: Stage-34

STAGE PLANS:
  Stage: Stage-32
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:sr 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:sr 
          TableScan
            alias: sr
            Statistics: Num rows: 37902 Data size: 41388272 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (sr_returned_date_sk is not null and sr_item_sk is not null and sr_customer_sk is not null and sr_ticket_number is not null) (type: boolean)
              Statistics: Num rows: 37902 Data size: 41388272 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: sr_returned_date_sk (type: bigint), sr_item_sk (type: bigint), sr_customer_sk (type: bigint), sr_ticket_number (type: bigint), sr_return_quantity (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 37902 Data size: 41388272 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-24
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: d2
            Statistics: Num rows: 109573 Data size: 123050479 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2003) and d_moy BETWEEN 1 AND 7 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 6087 Data size: 6835701 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 6087 Data size: 6835701 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col1, _col2, _col3, _col4
                  Statistics: Num rows: 41692 Data size: 45527100 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col1 (type: bigint), _col2 (type: bigint), _col3 (type: bigint), _col4 (type: int)
                    outputColumnNames: _col0, _col1, _col2, _col3
                    Statistics: Num rows: 41692 Data size: 45527100 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-23
    Conditional Operator

  Stage: Stage-30
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint), _col1 (type: bigint)
                1 _col0 (type: bigint), _col1 (type: bigint)

  Stage: Stage-21
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: bigint), _col1 (type: bigint)
                1 _col0 (type: bigint), _col1 (type: bigint)
              outputColumnNames: _col0, _col1, _col2, _col3, _col6
              Statistics: Num rows: 808342 Data size: 1477621677 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-20
    Conditional Operator

  Stage: Stage-28
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint), _col1 (type: bigint), _col2 (type: bigint)
                1 _col0 (type: bigint), _col2 (type: bigint), _col3 (type: bigint)

  Stage: Stage-18
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: bigint), _col1 (type: bigint), _col2 (type: bigint)
                1 _col0 (type: bigint), _col2 (type: bigint), _col3 (type: bigint)
              outputColumnNames: _col3, _col6, _col7, _col8, _col11
              Statistics: Num rows: 889176 Data size: 1625383879 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-27
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_3:part_s 
          Fetch Operator
            limit: -1
        $hdt$_4:part_i 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_3:part_s 
          TableScan
            alias: part_s
            Statistics: Num rows: 12 Data size: 25956 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: s_store_sk is not null (type: boolean)
              Statistics: Num rows: 12 Data size: 25956 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: s_store_sk (type: bigint), s_store_id (type: string), s_store_name (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 12 Data size: 25956 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col8 (type: bigint)
                    1 _col0 (type: bigint)
        $hdt$_4:part_i 
          TableScan
            alias: part_i
            Statistics: Num rows: 17820 Data size: 31241101 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 17820 Data size: 31241101 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: bigint), i_item_id (type: string), i_item_desc (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 17820 Data size: 31241101 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col7 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-6
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col8 (type: bigint)
                1 _col0 (type: bigint)
              outputColumnNames: _col3, _col6, _col7, _col11, _col13, _col14
              Statistics: Num rows: 978093 Data size: 1787922305 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 _col7 (type: bigint)
                  1 _col0 (type: bigint)
                outputColumnNames: _col3, _col6, _col11, _col13, _col14, _col16, _col17
                Statistics: Num rows: 1075902 Data size: 1966714578 Basic stats: COMPLETE Column stats: NONE
                Select Operator
                  expressions: _col16 (type: string), _col17 (type: string), _col13 (type: string), _col14 (type: string), _col11 (type: int), _col3 (type: int), _col6 (type: int)
                  outputColumnNames: _col16, _col17, _col13, _col14, _col11, _col3, _col6
                  Statistics: Num rows: 1075902 Data size: 1966714578 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    aggregations: sum(_col11), sum(_col3), sum(_col6)
                    keys: _col16 (type: string), _col17 (type: string), _col13 (type: string), _col14 (type: string)
                    mode: hash
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                    Statistics: Num rows: 1075902 Data size: 1966714578 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string)
                      sort order: ++++
                      Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string)
                      Statistics: Num rows: 1075902 Data size: 1966714578 Basic stats: COMPLETE Column stats: NONE
                      TopN Hash Memory Usage: 0.1
                      value expressions: _col4 (type: bigint), _col5 (type: bigint), _col6 (type: bigint)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2)
          keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: string), KEY._col3 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
          Statistics: Num rows: 537951 Data size: 983357289 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-7
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string)
              sort order: ++++
              Statistics: Num rows: 537951 Data size: 983357289 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col4 (type: bigint), _col5 (type: bigint), _col6 (type: bigint)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), KEY.reducesinkkey2 (type: string), KEY.reducesinkkey3 (type: string), VALUE._col0 (type: bigint), VALUE._col1 (type: bigint), VALUE._col2 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
          Statistics: Num rows: 537951 Data size: 983357289 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 182700 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 182700 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.TextInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                  name: bigbench.q21_hive_run_query_0_result

  Stage: Stage-0
    Move Operator
      tables:
          replace: false
          table:
              input format: org.apache.hadoop.mapred.TextInputFormat
              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
              serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
              name: bigbench.q21_hive_run_query_0_result

  Stage: Stage-8
    Stats-Aggr Operator

  Stage: Stage-29
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint), _col1 (type: bigint), _col2 (type: bigint)
                1 _col0 (type: bigint), _col2 (type: bigint), _col3 (type: bigint)

  Stage: Stage-19
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: bigint), _col1 (type: bigint), _col2 (type: bigint)
                1 _col0 (type: bigint), _col2 (type: bigint), _col3 (type: bigint)
              outputColumnNames: _col3, _col6, _col7, _col8, _col11
              Statistics: Num rows: 889176 Data size: 1625383879 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: bigint)
              sort order: +++
              Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: bigint)
              Statistics: Num rows: 808342 Data size: 1477621677 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: int), _col6 (type: int)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint), _col2 (type: bigint), _col3 (type: bigint)
              sort order: +++
              Map-reduce partition columns: _col0 (type: bigint), _col2 (type: bigint), _col3 (type: bigint)
              Statistics: Num rows: 734336 Data size: 1048623092 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: bigint), _col4 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: bigint), _col1 (type: bigint), _col2 (type: bigint)
            1 _col0 (type: bigint), _col2 (type: bigint), _col3 (type: bigint)
          outputColumnNames: _col3, _col6, _col7, _col8, _col11
          Statistics: Num rows: 889176 Data size: 1625383879 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-31
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint), _col1 (type: bigint)
                1 _col0 (type: bigint), _col1 (type: bigint)

  Stage: Stage-22
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: bigint), _col1 (type: bigint)
                1 _col0 (type: bigint), _col1 (type: bigint)
              outputColumnNames: _col0, _col1, _col2, _col3, _col6
              Statistics: Num rows: 808342 Data size: 1477621677 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint), _col1 (type: bigint)
              sort order: ++
              Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
              Statistics: Num rows: 41692 Data size: 45527100 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: bigint), _col3 (type: int)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint), _col1 (type: bigint)
              sort order: ++
              Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
              Statistics: Num rows: 734857 Data size: 1343292405 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: int)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: bigint), _col1 (type: bigint)
            1 _col0 (type: bigint), _col1 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col3, _col6
          Statistics: Num rows: 808342 Data size: 1477621677 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-33
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_1:$hdt$_2:d3 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_1:$hdt$_2:d3 
          TableScan
            alias: d3
            Statistics: Num rows: 109573 Data size: 123050479 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_year BETWEEN 2003 AND 2005 and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 12174 Data size: 13671402 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 12174 Data size: 13671402 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-25
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: ws
            Statistics: Num rows: 668052 Data size: 1221174888 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ws_sold_date_sk is not null and ws_item_sk is not null and ws_bill_customer_sk is not null) (type: boolean)
              Statistics: Num rows: 668052 Data size: 1221174888 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_sold_date_sk (type: bigint), ws_item_sk (type: bigint), ws_bill_customer_sk (type: bigint), ws_quantity (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 668052 Data size: 1221174888 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col1, _col2, _col3
                  Statistics: Num rows: 734857 Data size: 1343292405 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col1 (type: bigint), _col2 (type: bigint), _col3 (type: int)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 734857 Data size: 1343292405 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-34
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_2:$hdt$_3:d1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_2:$hdt$_3:d1 
          TableScan
            alias: d1
            Statistics: Num rows: 109573 Data size: 123050479 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ((d_year = 2003) and (d_moy = 1) and d_date_sk is not null) (type: boolean)
              Statistics: Num rows: 27393 Data size: 30762339 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: d_date_sk (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 27393 Data size: 30762339 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-26
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: ss
            Statistics: Num rows: 667579 Data size: 953293700 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (ss_sold_date_sk is not null and ss_item_sk is not null and ss_customer_sk is not null and ss_ticket_number is not null and ss_store_sk is not null) (type: boolean)
              Statistics: Num rows: 667579 Data size: 953293700 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: bigint), ss_item_sk (type: bigint), ss_customer_sk (type: bigint), ss_store_sk (type: bigint), ss_ticket_number (type: bigint), ss_quantity (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 667579 Data size: 953293700 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col1, _col2, _col3, _col4, _col5
                  Statistics: Num rows: 734336 Data size: 1048623092 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col1 (type: bigint), _col3 (type: bigint), _col2 (type: bigint), _col4 (type: bigint), _col5 (type: int)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4
                    Statistics: Num rows: 734336 Data size: 1048623092 Basic stats: COMPLETE Column stats: NONE
                    File Output Operator
                      compressed: false
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

Time taken: 3.226 seconds, Fetched: 543 row(s)
======= q21_hive_run_query_0 time =======
Start timestamp: 2018/02/12:12:23:39 1518459819
Stop  timestamp: 2018/02/12:12:23:55 1518459835
Duration:  0h 0m 16s
q21_hive_run_query_0 SUCCESS exit code: 0 
----- result -----
EMPTY  bytes: 0
to display: hadoop fs -cat /user/wentingt/benchmarks/bigbench/queryResults/q21_hive_run_query_0_result/*
----- logs -----
time&status: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/times.csv
full log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q21_hive_run_query_0.log
=========================
@@@/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q22/query22.sql
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q22/engineLocalSettings.sql to hive init.
===============================================
Running query : q22
-----------------------------------------------
benchmark phase: run_query
stream number  : 0
user parameter file: 
user settings file : 
log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q22_hive_run_query_0.log
===============================================
checking existence of local: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs
creating/cleaning/set permissions for hdfs tmp and result folders for this query
hdfs client: hadoop fs
Duration for hdfs prepare:  0h 0m 16s
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q22/engineLocalSettings.sql to hive init.
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/log4j-slf4j-impl-2.6.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/users/wentingt/hadoop-3.0.0-beta1-src/hadoop-dist/target/hadoop-3.0.0-beta1/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]

Logging initialized using configuration in jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/hive-common-2.3.2.jar!/hive-log4j2.properties Async: true
hive.execution.engine=mr
hive.cbo.enable=true
hive.stats.fetch.partition.stats=true
hive.script.operator.truncate.env=false
hive.compute.query.using.stats=true
hive.vectorized.execution.enabled=false
hive.vectorized.execution.reduce.enabled=true
hive.stats.autogather=true
mapreduce.input.fileinputformat.split.minsize=1
mapreduce.input.fileinputformat.split.maxsize=256000000
hive.exec.reducers.bytes.per.reducer=256000000
hive.exec.reducers.max=1009
hive.exec.parallel=false
hive.exec.parallel.thread.number=8
hive.exec.compress.intermediate=false
hive.exec.compress.output=false
mapred.map.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
mapred.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
hive.default.fileformat=TEXTFILE
hive.auto.convert.sortmerge.join=false
hive.auto.convert.sortmerge.join.noconditionaltask is undefined
hive.optimize.bucketmapjoin=false
hive.optimize.bucketmapjoin.sortedmerge=false
hive.auto.convert.join.noconditionaltask.size=10000000
hive.auto.convert.join=true
hive.optimize.mapjoin.mapreduce is undefined
hive.mapred.local.mem=0
hive.mapjoin.smalltable.filesize=25000000
hive.mapjoin.localtask.max.memory.usage=0.9
hive.optimize.skewjoin=false
hive.optimize.skewjoin.compiletime=false
hive.optimize.ppd=true
hive.optimize.ppd.storage=true
hive.ppd.recognizetransivity=true
hive.optimize.index.filter=false
hive.optimize.sampling.orderby=false
hive.optimize.sampling.orderby.number=1000
hive.optimize.sampling.orderby.percent=0.1
bigbench.hive.optimize.sampling.orderby=true
bigbench.hive.optimize.sampling.orderby.number=20000
bigbench.hive.optimize.sampling.orderby.percent=0.1
hive.groupby.skewindata=false
hive.exec.submit.local.task.via.child=true
hive.exec.compress.output=false
OK
Time taken: 0.071 seconds
OK
Time taken: 0.494 seconds
OK
STAGE DEPENDENCIES:
  Stage-13 is a root stage
  Stage-4 depends on stages: Stage-13
  Stage-5 depends on stages: Stage-4
  Stage-0 depends on stages: Stage-5
  Stage-6 depends on stages: Stage-0

STAGE PLANS:
  Stage: Stage-13
    Map Reduce Local Work
      Alias -> Map Local Tables:
        d 
          Fetch Operator
            limit: -1
        i 
          Fetch Operator
            limit: -1
        w 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        d 
          TableScan
            alias: d
            Statistics: Num rows: 109573 Data size: 123050479 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (d_date_sk is not null and (datediff(d_date, '2001-05-08') >= -30) and (datediff(d_date, '2001-05-08') <= 30)) (type: boolean)
              Statistics: Num rows: 12174 Data size: 13671402 Basic stats: COMPLETE Column stats: NONE
              HashTable Sink Operator
                keys:
                  0 _col0 (type: bigint)
                  1 d_date_sk (type: bigint)
        i 
          TableScan
            alias: i
            Statistics: Num rows: 17820 Data size: 31241101 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_sk is not null and i_current_price BETWEEN 0.98 AND 1.5) (type: boolean)
              Statistics: Num rows: 1980 Data size: 3471233 Basic stats: COMPLETE Column stats: NONE
              HashTable Sink Operator
                keys:
                  0 inv_item_sk (type: bigint)
                  1 i_item_sk (type: bigint)
        w 
          TableScan
            alias: w
            Statistics: Num rows: 5 Data size: 5695 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: w_warehouse_sk is not null (type: boolean)
              Statistics: Num rows: 5 Data size: 5695 Basic stats: COMPLETE Column stats: NONE
              HashTable Sink Operator
                keys:
                  0 _col2 (type: bigint)
                  1 w_warehouse_sk (type: bigint)

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: inv
            Statistics: Num rows: 23255100 Data size: 651118804 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (inv_item_sk is not null and inv_warehouse_sk is not null and inv_date_sk is not null) (type: boolean)
              Statistics: Num rows: 23255100 Data size: 651118804 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 inv_item_sk (type: bigint)
                  1 i_item_sk (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3, _col7, _col8
                Statistics: Num rows: 25580610 Data size: 716230699 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col2 (type: bigint)
                    1 w_warehouse_sk (type: bigint)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col7, _col8, _col32, _col34
                  Statistics: Num rows: 28138671 Data size: 787853785 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: bigint)
                      1 d_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col7, _col8, _col32, _col34, _col49, _col51
                    Statistics: Num rows: 30952538 Data size: 866639182 Basic stats: COMPLETE Column stats: NONE
                    Filter Operator
                      predicate: ((_col2 = _col32) and (_col0 = _col49) and (_col7 = _col1)) (type: boolean)
                      Statistics: Num rows: 3869067 Data size: 108329890 Basic stats: COMPLETE Column stats: NONE
                      Select Operator
                        expressions: _col34 (type: string), _col8 (type: string), _col51 (type: string), _col3 (type: int)
                        outputColumnNames: _col34, _col8, _col51, _col3
                        Statistics: Num rows: 3869067 Data size: 108329890 Basic stats: COMPLETE Column stats: NONE
                        Group By Operator
                          aggregations: sum(CASE WHEN ((datediff(_col51, '2001-05-08') < 0)) THEN (_col3) ELSE (0) END), sum(CASE WHEN ((datediff(_col51, '2001-05-08') >= 0)) THEN (_col3) ELSE (0) END)
                          keys: _col34 (type: string), _col8 (type: string)
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2, _col3
                          Statistics: Num rows: 3869067 Data size: 108329890 Basic stats: COMPLETE Column stats: NONE
                          Reduce Output Operator
                            key expressions: _col0 (type: string), _col1 (type: string)
                            sort order: ++
                            Map-reduce partition columns: _col0 (type: string), _col1 (type: string)
                            Statistics: Num rows: 3869067 Data size: 108329890 Basic stats: COMPLETE Column stats: NONE
                            value expressions: _col2 (type: bigint), _col3 (type: bigint)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1)
          keys: KEY._col0 (type: string), KEY._col1 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 1934533 Data size: 54164931 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: ((_col2 > 0) and ((_col3 / _col2) >= 0.666667) and ((_col3 / _col2) <= 1.5)) (type: boolean)
            Statistics: Num rows: 71649 Data size: 2006098 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string)
              sort order: ++
              Statistics: Num rows: 71649 Data size: 2006098 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
              value expressions: _col2 (type: bigint), _col3 (type: bigint)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), VALUE._col0 (type: bigint), VALUE._col1 (type: bigint)
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 71649 Data size: 2006098 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 2700 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 100 Data size: 2700 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.TextInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                  name: bigbench.q22_hive_run_query_0_result

  Stage: Stage-0
    Move Operator
      tables:
          replace: false
          table:
              input format: org.apache.hadoop.mapred.TextInputFormat
              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
              serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
              name: bigbench.q22_hive_run_query_0_result

  Stage: Stage-6
    Stats-Aggr Operator

Time taken: 2.288 seconds, Fetched: 166 row(s)
======= q22_hive_run_query_0 time =======
Start timestamp: 2018/02/12:12:24:13 1518459853
Stop  timestamp: 2018/02/12:12:24:29 1518459869
Duration:  0h 0m 16s
q22_hive_run_query_0 SUCCESS exit code: 0 
----- result -----
EMPTY  bytes: 0
to display: hadoop fs -cat /user/wentingt/benchmarks/bigbench/queryResults/q22_hive_run_query_0_result/*
----- logs -----
time&status: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/times.csv
full log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q22_hive_run_query_0.log
=========================
@@@/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q23/query23.sql
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q23/engineLocalSettings.sql to hive init.
===============================================
Running query : q23
-----------------------------------------------
benchmark phase: run_query
stream number  : 0
user parameter file: 
user settings file : 
log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q23_hive_run_query_0.log
===============================================
checking existence of local: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs
creating/cleaning/set permissions for hdfs tmp and result folders for this query
hdfs client: hadoop fs
Duration for hdfs prepare:  0h 0m 17s
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q23/engineLocalSettings.sql to hive init.
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/log4j-slf4j-impl-2.6.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/users/wentingt/hadoop-3.0.0-beta1-src/hadoop-dist/target/hadoop-3.0.0-beta1/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]

Logging initialized using configuration in jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/hive-common-2.3.2.jar!/hive-log4j2.properties Async: true
hive.execution.engine=mr
hive.cbo.enable=true
hive.stats.fetch.partition.stats=true
hive.script.operator.truncate.env=false
hive.compute.query.using.stats=true
hive.vectorized.execution.enabled=false
hive.vectorized.execution.reduce.enabled=true
hive.stats.autogather=true
mapreduce.input.fileinputformat.split.minsize=1
mapreduce.input.fileinputformat.split.maxsize=256000000
hive.exec.reducers.bytes.per.reducer=256000000
hive.exec.reducers.max=1009
hive.exec.parallel=false
hive.exec.parallel.thread.number=8
hive.exec.compress.intermediate=false
hive.exec.compress.output=false
mapred.map.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
mapred.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
hive.default.fileformat=TEXTFILE
hive.auto.convert.sortmerge.join=false
hive.auto.convert.sortmerge.join.noconditionaltask is undefined
hive.optimize.bucketmapjoin=false
hive.optimize.bucketmapjoin.sortedmerge=false
hive.auto.convert.join.noconditionaltask.size=10000000
hive.auto.convert.join=true
hive.optimize.mapjoin.mapreduce is undefined
hive.mapred.local.mem=0
hive.mapjoin.smalltable.filesize=25000000
hive.mapjoin.localtask.max.memory.usage=0.9
hive.optimize.skewjoin=false
hive.optimize.skewjoin.compiletime=false
hive.optimize.ppd=true
hive.optimize.ppd.storage=true
hive.ppd.recognizetransivity=true
hive.optimize.index.filter=false
hive.optimize.sampling.orderby=false
hive.optimize.sampling.orderby.number=1000
hive.optimize.sampling.orderby.percent=0.1
bigbench.hive.optimize.sampling.orderby=true
bigbench.hive.optimize.sampling.orderby.number=20000
bigbench.hive.optimize.sampling.orderby.percent=0.1
hive.groupby.skewindata=false
hive.exec.submit.local.task.via.child=true
OK
Time taken: 0.067 seconds
NoViableAltException(350@[319:1: constant : ( ( intervalLiteral )=> intervalLiteral | Number | dateLiteral | timestampLiteral | StringLiteral | stringLiteralSequence | IntegralLiteral | NumberLiteral | charSetStringLiteral | booleanValue | KW_NULL -> TOK_NULL );])
	at org.antlr.runtime.DFA.noViableAlt(DFA.java:158)
	at org.antlr.runtime.DFA.predict(DFA.java:116)
	at org.apache.hadoop.hive.ql.parse.HiveParser_IdentifiersParser.constant(HiveParser_IdentifiersParser.java:5267)
	at org.apache.hadoop.hive.ql.parse.HiveParser_IdentifiersParser.atomExpression(HiveParser_IdentifiersParser.java:6755)
	at org.apache.hadoop.hive.ql.parse.HiveParser_IdentifiersParser.precedenceFieldExpression(HiveParser_IdentifiersParser.java:6988)
	at org.apache.hadoop.hive.ql.parse.HiveParser_IdentifiersParser.precedenceUnaryPrefixExpression(HiveParser_IdentifiersParser.java:7324)
	at org.apache.hadoop.hive.ql.parse.HiveParser_IdentifiersParser.precedenceUnarySuffixExpression(HiveParser_IdentifiersParser.java:7380)
	at org.apache.hadoop.hive.ql.parse.HiveParser_IdentifiersParser.precedenceBitwiseXorExpression(HiveParser_IdentifiersParser.java:7542)
	at org.apache.hadoop.hive.ql.parse.HiveParser_IdentifiersParser.precedenceStarExpression(HiveParser_IdentifiersParser.java:7685)
	at org.apache.hadoop.hive.ql.parse.HiveParser_IdentifiersParser.precedencePlusExpression(HiveParser_IdentifiersParser.java:7828)
	at org.apache.hadoop.hive.ql.parse.HiveParser_IdentifiersParser.precedenceConcatenateExpression(HiveParser_IdentifiersParser.java:7967)
	at org.apache.hadoop.hive.ql.parse.HiveParser_IdentifiersParser.precedenceAmpersandExpression(HiveParser_IdentifiersParser.java:8177)
	at org.apache.hadoop.hive.ql.parse.HiveParser_IdentifiersParser.precedenceBitwiseOrExpression(HiveParser_IdentifiersParser.java:8314)
	at org.apache.hadoop.hive.ql.parse.HiveParser_IdentifiersParser.precedenceSimilarExpressionPart(HiveParser_IdentifiersParser.java:8943)
	at org.apache.hadoop.hive.ql.parse.HiveParser_IdentifiersParser.precedenceSimilarExpressionMain(HiveParser_IdentifiersParser.java:8816)
	at org.apache.hadoop.hive.ql.parse.HiveParser_IdentifiersParser.precedenceSimilarExpression(HiveParser_IdentifiersParser.java:8697)
	at org.apache.hadoop.hive.ql.parse.HiveParser_IdentifiersParser.precedenceEqualExpression(HiveParser_IdentifiersParser.java:9537)
	at org.apache.hadoop.hive.ql.parse.HiveParser_IdentifiersParser.precedenceNotExpression(HiveParser_IdentifiersParser.java:9703)
	at org.apache.hadoop.hive.ql.parse.HiveParser_IdentifiersParser.precedenceAndExpression(HiveParser_IdentifiersParser.java:9836)
	at org.apache.hadoop.hive.ql.parse.HiveParser_IdentifiersParser.precedenceOrExpression(HiveParser_IdentifiersParser.java:9953)
	at org.apache.hadoop.hive.ql.parse.HiveParser_IdentifiersParser.expression(HiveParser_IdentifiersParser.java:6686)
	at org.apache.hadoop.hive.ql.parse.HiveParser.expression(HiveParser.java:41942)
	at org.apache.hadoop.hive.ql.parse.HiveParser_FromClauseParser.searchCondition(HiveParser_FromClauseParser.java:6446)
	at org.apache.hadoop.hive.ql.parse.HiveParser_FromClauseParser.whereClause(HiveParser_FromClauseParser.java:6364)
	at org.apache.hadoop.hive.ql.parse.HiveParser.whereClause(HiveParser.java:42024)
	at org.apache.hadoop.hive.ql.parse.HiveParser.atomSelectStatement(HiveParser.java:36755)
	at org.apache.hadoop.hive.ql.parse.HiveParser.selectStatement(HiveParser.java:36987)
	at org.apache.hadoop.hive.ql.parse.HiveParser.selectStatementWithCTE(HiveParser.java:37675)
	at org.apache.hadoop.hive.ql.parse.HiveParser.createTableStatement(HiveParser.java:6361)
	at org.apache.hadoop.hive.ql.parse.HiveParser.ddlStatement(HiveParser.java:3808)
	at org.apache.hadoop.hive.ql.parse.HiveParser.execStatement(HiveParser.java:2382)
	at org.apache.hadoop.hive.ql.parse.HiveParser.statement(HiveParser.java:1333)
	at org.apache.hadoop.hive.ql.parse.ParseDriver.parse(ParseDriver.java:208)
	at org.apache.hadoop.hive.ql.parse.ParseUtils.parse(ParseUtils.java:77)
	at org.apache.hadoop.hive.ql.parse.ParseUtils.parse(ParseUtils.java:70)
	at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:468)
	at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:1317)
	at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:1457)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:1237)
	at org.apache.hadoop.hive.ql.Driver.run(Driver.java:1227)
	at org.apache.hadoop.hive.cli.CliDriver.processLocalCmd(CliDriver.java:233)
	at org.apache.hadoop.hive.cli.CliDriver.processCmd(CliDriver.java:184)
	at org.apache.hadoop.hive.cli.CliDriver.processLine(CliDriver.java:403)
	at org.apache.hadoop.hive.cli.CliDriver.processLine(CliDriver.java:336)
	at org.apache.hadoop.hive.cli.CliDriver.processReader(CliDriver.java:474)
	at org.apache.hadoop.hive.cli.CliDriver.processFile(CliDriver.java:490)
	at org.apache.hadoop.hive.cli.CliDriver.executeDriver(CliDriver.java:793)
	at org.apache.hadoop.hive.cli.CliDriver.run(CliDriver.java:759)
	at org.apache.hadoop.hive.cli.CliDriver.main(CliDriver.java:686)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.util.RunJar.run(RunJar.java:239)
	at org.apache.hadoop.util.RunJar.main(RunJar.java:153)
FAILED: ParseException line 33:0 cannot recognize input near '1.3' ';' 'set' in constant
An error occured while running command:
==========
runEngineCmd -f /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q23/q23.sql
==========
Please check the log files for details
======= q23_hive_run_query_0 time =======
Start timestamp: 2018/02/12:12:24:48 1518459888
Stop  timestamp: 2018/02/12:12:25:01 1518459901
Duration:  0h 0m 13s
q23_hive_run_query_0 FAILED exit code: 64 
----- result -----
EMPTY  bytes: 0
to display: hadoop fs -cat /user/wentingt/benchmarks/bigbench/queryResults/q23_hive_run_query_0_result/*
----- logs -----
time&status: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/times.csv
full log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q23_hive_run_query_0.log
=========================
An error occured while running command:
==========
runModule
==========
Please check the log files for details
@@@/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q24/query24.sql
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q24/engineLocalSettings.sql to hive init.
===============================================
Running query : q24
-----------------------------------------------
benchmark phase: run_query
stream number  : 0
user parameter file: 
user settings file : 
log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q24_hive_run_query_0.log
===============================================
checking existence of local: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs
creating/cleaning/set permissions for hdfs tmp and result folders for this query
hdfs client: hadoop fs
Duration for hdfs prepare:  0h 0m 16s
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q24/engineLocalSettings.sql to hive init.
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/log4j-slf4j-impl-2.6.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/users/wentingt/hadoop-3.0.0-beta1-src/hadoop-dist/target/hadoop-3.0.0-beta1/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]

Logging initialized using configuration in jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/hive-common-2.3.2.jar!/hive-log4j2.properties Async: true
hive.execution.engine=mr
hive.cbo.enable=true
hive.stats.fetch.partition.stats=true
hive.script.operator.truncate.env=false
hive.compute.query.using.stats=true
hive.vectorized.execution.enabled=false
hive.vectorized.execution.reduce.enabled=true
hive.stats.autogather=true
mapreduce.input.fileinputformat.split.minsize=1
mapreduce.input.fileinputformat.split.maxsize=256000000
hive.exec.reducers.bytes.per.reducer=256000000
hive.exec.reducers.max=1009
hive.exec.parallel=false
hive.exec.parallel.thread.number=8
hive.exec.compress.intermediate=false
hive.exec.compress.output=false
mapred.map.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
mapred.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
hive.default.fileformat=TEXTFILE
hive.auto.convert.sortmerge.join=false
hive.auto.convert.sortmerge.join.noconditionaltask is undefined
hive.optimize.bucketmapjoin=false
hive.optimize.bucketmapjoin.sortedmerge=false
hive.auto.convert.join.noconditionaltask.size=10000000
hive.auto.convert.join=true
hive.optimize.mapjoin.mapreduce is undefined
hive.mapred.local.mem=0
hive.mapjoin.smalltable.filesize=25000000
hive.mapjoin.localtask.max.memory.usage=0.9
hive.optimize.skewjoin=false
hive.optimize.skewjoin.compiletime=false
hive.optimize.ppd=true
hive.optimize.ppd.storage=true
hive.ppd.recognizetransivity=true
hive.optimize.index.filter=false
hive.optimize.sampling.orderby=false
hive.optimize.sampling.orderby.number=1000
hive.optimize.sampling.orderby.percent=0.1
bigbench.hive.optimize.sampling.orderby=true
bigbench.hive.optimize.sampling.orderby.number=20000
bigbench.hive.optimize.sampling.orderby.percent=0.1
hive.groupby.skewindata=false
hive.exec.submit.local.task.via.child=true
OK
Time taken: 0.065 seconds
Warning: Map Join MAPJOIN[17][bigTable=?] in task 'Stage-2:MAPRED' is a cross product
WARNING: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = wentingt_20180212112531_f6a9af55-35da-471c-a6a4-8cf221c0e8f1
Total jobs = 1
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/log4j-slf4j-impl-2.6.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/users/wentingt/hadoop-3.0.0-beta1-src/hadoop-dist/target/hadoop-3.0.0-beta1/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
2018-02-12 11:25:40	Starting to launch local task to process map join;	maximum memory = 477626368
2018-02-12 11:25:42	Dump the side-table for tag: 1 with group count: 1 into file: file:/tmp/wentingt/e876af93-1a21-487b-8f50-18d89e7b0e3c/hive_2018-02-12_11-25-31_831_519361675877636988-1/-local-10005/HashTable-Stage-2/MapJoin-mapfile01--.hashtable
2018-02-12 11:25:42	Uploaded 1 File to: file:/tmp/wentingt/e876af93-1a21-487b-8f50-18d89e7b0e3c/hive_2018-02-12_11-25-31_831_519361675877636988-1/-local-10005/HashTable-Stage-2/MapJoin-mapfile01--.hashtable (363 bytes)
2018-02-12 11:25:42	End of local task; Time Taken: 2.096 sec.
Execution completed successfully
MapredLocal task succeeded
Launching Job 1 out of 1
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1518452786757_0142, Tracking URL = http://dc1master-lan1:8088/proxy/application_1518452786757_0142/
Kill Command = /users/wentingt/hadoop-3.0.0-beta1-src/hadoop-dist/target/hadoop-3.0.0-beta1/bin/hadoop job  -kill job_1518452786757_0142
Hadoop job information for Stage-2: number of mappers: 1; number of reducers: 1
2018-02-12 11:25:59,890 Stage-2 map = 0%,  reduce = 0%
2018-02-12 11:26:06,183 Stage-2 map = 100%,  reduce = 0%, Cumulative CPU 6.34 sec
2018-02-12 11:26:14,460 Stage-2 map = 100%,  reduce = 100%, Cumulative CPU 11.79 sec
MapReduce Total cumulative CPU time: 11 seconds 790 msec
Ended Job = job_1518452786757_0142
Moving data to directory hdfs://dc1master:9000/user/hive/warehouse/bigbench.db/q24_hive_run_query_0_temp
MapReduce Jobs Launched: 
Stage-Stage-2: Map: 1  Reduce: 1   Cumulative CPU: 11.79 sec   HDFS Read: 73377 HDFS Write: 267 SUCCESS
Total MapReduce CPU Time Spent: 11 seconds 790 msec
OK
Time taken: 44.645 seconds
hive.exec.compress.output=false
OK
Time taken: 0.012 seconds
OK
Time taken: 0.079 seconds
No Stats for bigbench@web_sales, Columns: ws_item_sk, ws_quantity, ws_sold_date_sk
No Stats for bigbench@q24_hive_run_query_0_temp, Columns: price_change, imp_start_date, imp_sk, no_days_comp_price, i_item_sk
No Stats for bigbench@store_sales, Columns: ss_sold_date_sk, ss_item_sk, ss_quantity
No Stats for bigbench@q24_hive_run_query_0_temp, Columns: price_change, imp_start_date, imp_sk, no_days_comp_price, i_item_sk
OK
STAGE DEPENDENCIES:
  Stage-17 is a root stage
  Stage-2 depends on stages: Stage-17
  Stage-12 depends on stages: Stage-2, Stage-8 , consists of Stage-15, Stage-16, Stage-3
  Stage-15 has a backup stage: Stage-3
  Stage-10 depends on stages: Stage-15
  Stage-4 depends on stages: Stage-3, Stage-10, Stage-11
  Stage-0 depends on stages: Stage-4
  Stage-5 depends on stages: Stage-0
  Stage-16 has a backup stage: Stage-3
  Stage-11 depends on stages: Stage-16
  Stage-3
  Stage-18 is a root stage
  Stage-8 depends on stages: Stage-18

STAGE PLANS:
  Stage: Stage-17
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_0:$hdt$_1:c 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_0:$hdt$_1:c 
          TableScan
            alias: c
            Statistics: Num rows: 5 Data size: 171 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_sk is not null and imp_sk is not null) (type: boolean)
              Statistics: Num rows: 5 Data size: 171 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: bigint), imp_sk (type: bigint), price_change (type: decimal(18,10)), imp_start_date (type: bigint), no_days_comp_price (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 5 Data size: 171 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: ws
            Statistics: Num rows: 668052 Data size: 1221174888 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ws_item_sk is not null (type: boolean)
              Statistics: Num rows: 668052 Data size: 1221174888 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_sold_date_sk (type: bigint), ws_item_sk (type: bigint), ws_quantity (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 668052 Data size: 1221174888 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col0, _col1, _col2, _col4, _col5, _col6, _col7
                  Statistics: Num rows: 734857 Data size: 1343292405 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col1 (type: bigint), _col4 (type: bigint), _col5 (type: decimal(18,10)), CASE WHEN (((_col0 >= _col6) and (_col0 < (_col6 + _col7)))) THEN (_col2) ELSE (0) END (type: int), CASE WHEN (((_col0 >= (_col6 - _col7)) and (_col0 < _col6))) THEN (_col2) ELSE (0) END (type: int)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4
                    Statistics: Num rows: 734857 Data size: 1343292405 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col3), sum(_col4)
                      keys: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: decimal(18,10))
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 734857 Data size: 1343292405 Basic stats: COMPLETE Column stats: NONE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: decimal(18,10))
                        sort order: +++
                        Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: decimal(18,10))
                        Statistics: Num rows: 734857 Data size: 1343292405 Basic stats: COMPLETE Column stats: NONE
                        value expressions: _col3 (type: bigint), _col4 (type: bigint)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1)
          keys: KEY._col0 (type: bigint), KEY._col1 (type: bigint), KEY._col2 (type: decimal(18,10))
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4
          Statistics: Num rows: 367428 Data size: 671645288 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-12
    Conditional Operator

  Stage: Stage-15
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME1 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME1 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint), _col1 (type: bigint)
                1 _col0 (type: bigint), _col1 (type: bigint)

  Stage: Stage-10
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: bigint), _col1 (type: bigint)
                1 _col0 (type: bigint), _col1 (type: bigint)
              outputColumnNames: _col0, _col2, _col3, _col4, _col8, _col9
              Statistics: Num rows: 404170 Data size: 738809832 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col0 (type: bigint), (CAST( (((_col8 + _col3) - _col9) - _col4) AS decimal(19,0)) / (CAST( (_col9 + _col4) AS decimal(19,0)) * _col2)) (type: decimal(38,9))
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 404170 Data size: 738809832 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: avg(_col1)
                  keys: _col0 (type: bigint)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 404170 Data size: 738809832 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Map-reduce partition columns: _col0 (type: bigint)
              Statistics: Num rows: 404170 Data size: 738809832 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: struct<count:bigint,sum:decimal(38,9),input:decimal(38,9)>)
      Reduce Operator Tree:
        Group By Operator
          aggregations: avg(VALUE._col0)
          keys: KEY._col0 (type: bigint)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 202085 Data size: 369404916 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: bigint), CAST( _col1 AS decimal(15,7)) (type: decimal(15,7))
            outputColumnNames: _col0, _col1
            Statistics: Num rows: 202085 Data size: 369404916 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 202085 Data size: 369404916 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.TextInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                  name: bigbench.q24_hive_run_query_0_result

  Stage: Stage-0
    Move Operator
      tables:
          replace: false
          table:
              input format: org.apache.hadoop.mapred.TextInputFormat
              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
              serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
              name: bigbench.q24_hive_run_query_0_result

  Stage: Stage-5
    Stats-Aggr Operator

  Stage: Stage-16
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$INTNAME 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$INTNAME 
          TableScan
            HashTable Sink Operator
              keys:
                0 _col0 (type: bigint), _col1 (type: bigint)
                1 _col0 (type: bigint), _col1 (type: bigint)

  Stage: Stage-11
    Map Reduce
      Map Operator Tree:
          TableScan
            Map Join Operator
              condition map:
                   Inner Join 0 to 1
              keys:
                0 _col0 (type: bigint), _col1 (type: bigint)
                1 _col0 (type: bigint), _col1 (type: bigint)
              outputColumnNames: _col0, _col2, _col3, _col4, _col8, _col9
              Statistics: Num rows: 404170 Data size: 738809832 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: _col0 (type: bigint), (CAST( (((_col8 + _col3) - _col9) - _col4) AS decimal(19,0)) / (CAST( (_col9 + _col4) AS decimal(19,0)) * _col2)) (type: decimal(38,9))
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 404170 Data size: 738809832 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: avg(_col1)
                  keys: _col0 (type: bigint)
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 404170 Data size: 738809832 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
      Local Work:
        Map Reduce Local Work

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint), _col1 (type: bigint)
              sort order: ++
              Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
              Statistics: Num rows: 367428 Data size: 671645288 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: decimal(18,10)), _col3 (type: bigint), _col4 (type: bigint)
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint), _col1 (type: bigint)
              sort order: ++
              Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
              Statistics: Num rows: 367168 Data size: 524311546 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col3 (type: bigint), _col4 (type: bigint)
      Reduce Operator Tree:
        Join Operator
          condition map:
               Inner Join 0 to 1
          keys:
            0 _col0 (type: bigint), _col1 (type: bigint)
            1 _col0 (type: bigint), _col1 (type: bigint)
          outputColumnNames: _col0, _col2, _col3, _col4, _col8, _col9
          Statistics: Num rows: 404170 Data size: 738809832 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: bigint), (CAST( (((_col8 + _col3) - _col9) - _col4) AS decimal(19,0)) / (CAST( (_col9 + _col4) AS decimal(19,0)) * _col2)) (type: decimal(38,9))
            outputColumnNames: _col0, _col1
            Statistics: Num rows: 404170 Data size: 738809832 Basic stats: COMPLETE Column stats: NONE
            Group By Operator
              aggregations: avg(_col1)
              keys: _col0 (type: bigint)
              mode: hash
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 404170 Data size: 738809832 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-18
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:$hdt$_1:$hdt$_2:c 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:$hdt$_1:$hdt$_2:c 
          TableScan
            alias: c
            Statistics: Num rows: 5 Data size: 171 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_sk is not null and imp_sk is not null) (type: boolean)
              Statistics: Num rows: 5 Data size: 171 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: bigint), imp_sk (type: bigint), price_change (type: decimal(18,10)), imp_start_date (type: bigint), no_days_comp_price (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 5 Data size: 171 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-8
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: ss
            Statistics: Num rows: 667579 Data size: 953293700 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ss_item_sk is not null (type: boolean)
              Statistics: Num rows: 667579 Data size: 953293700 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_sold_date_sk (type: bigint), ss_item_sk (type: bigint), ss_quantity (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 667579 Data size: 953293700 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col0, _col1, _col2, _col4, _col5, _col6, _col7
                  Statistics: Num rows: 734336 Data size: 1048623092 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col1 (type: bigint), _col4 (type: bigint), _col5 (type: decimal(18,10)), CASE WHEN (((_col0 >= _col6) and (_col0 < (_col6 + _col7)))) THEN (_col2) ELSE (0) END (type: int), CASE WHEN (((_col0 >= (_col6 - _col7)) and (_col0 < _col6))) THEN (_col2) ELSE (0) END (type: int)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4
                    Statistics: Num rows: 734336 Data size: 1048623092 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col3), sum(_col4)
                      keys: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: decimal(18,10))
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 734336 Data size: 1048623092 Basic stats: COMPLETE Column stats: NONE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: decimal(18,10))
                        sort order: +++
                        Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: decimal(18,10))
                        Statistics: Num rows: 734336 Data size: 1048623092 Basic stats: COMPLETE Column stats: NONE
                        value expressions: _col3 (type: bigint), _col4 (type: bigint)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: sum(VALUE._col0), sum(VALUE._col1)
          keys: KEY._col0 (type: bigint), KEY._col1 (type: bigint), KEY._col2 (type: decimal(18,10))
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4
          Statistics: Num rows: 367168 Data size: 524311546 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: bigint), _col1 (type: bigint), _col3 (type: bigint), _col4 (type: bigint)
            outputColumnNames: _col0, _col1, _col3, _col4
            Statistics: Num rows: 367168 Data size: 524311546 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

Time taken: 1.365 seconds, Fetched: 351 row(s)
OK
Time taken: 1.599 seconds
======= q24_hive_run_query_0 time =======
Start timestamp: 2018/02/12:12:25:19 1518459919
Stop  timestamp: 2018/02/12:12:26:19 1518459979
Duration:  0h 1m 0s
q24_hive_run_query_0 SUCCESS exit code: 0 
----- result -----
EMPTY  bytes: 0
to display: hadoop fs -cat /user/wentingt/benchmarks/bigbench/queryResults/q24_hive_run_query_0_result/*
----- logs -----
time&status: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/times.csv
full log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q24_hive_run_query_0.log
=========================
@@@/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q25/query25.sql
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q25/engineLocalSettings.sql to hive init.
===============================================
Running query : q25
-----------------------------------------------
benchmark phase: run_query
stream number  : 0
user parameter file: 
user settings file : 
log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q25_hive_run_query_0.log
===============================================
checking existence of local: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs
creating/cleaning/set permissions for hdfs tmp and result folders for this query
hdfs client: hadoop fs
Duration for hdfs prepare:  0h 0m 17s
=========================
q25 Step 1/5: Executing hive queries
tmp output: /user/wentingt/benchmarks/bigbench/temp/q25_hive_run_query_0_temp/q25_hive_run_query_0_temp_result
=========================
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q25/engineLocalSettings.sql to hive init.
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/log4j-slf4j-impl-2.6.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/users/wentingt/hadoop-3.0.0-beta1-src/hadoop-dist/target/hadoop-3.0.0-beta1/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]

Logging initialized using configuration in jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/hive-common-2.3.2.jar!/hive-log4j2.properties Async: true
hive.execution.engine=mr
hive.cbo.enable=true
hive.stats.fetch.partition.stats=true
hive.script.operator.truncate.env=false
hive.compute.query.using.stats=true
hive.vectorized.execution.enabled=false
hive.vectorized.execution.reduce.enabled=true
hive.stats.autogather=true
mapreduce.input.fileinputformat.split.minsize=1
mapreduce.input.fileinputformat.split.maxsize=256000000
hive.exec.reducers.bytes.per.reducer=256000000
hive.exec.reducers.max=1009
hive.exec.parallel=false
hive.exec.parallel.thread.number=8
hive.exec.compress.intermediate=false
hive.exec.compress.output=false
mapred.map.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
mapred.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
hive.default.fileformat=TEXTFILE
hive.auto.convert.sortmerge.join=false
hive.auto.convert.sortmerge.join.noconditionaltask is undefined
hive.optimize.bucketmapjoin=false
hive.optimize.bucketmapjoin.sortedmerge=false
hive.auto.convert.join.noconditionaltask.size=10000000
hive.auto.convert.join=true
hive.optimize.mapjoin.mapreduce is undefined
hive.mapred.local.mem=0
hive.mapjoin.smalltable.filesize=25000000
hive.mapjoin.localtask.max.memory.usage=0.9
hive.optimize.skewjoin=false
hive.optimize.skewjoin.compiletime=false
hive.optimize.ppd=true
hive.optimize.ppd.storage=true
hive.ppd.recognizetransivity=true
hive.optimize.index.filter=false
hive.optimize.sampling.orderby=false
hive.optimize.sampling.orderby.number=1000
hive.optimize.sampling.orderby.percent=0.1
bigbench.hive.optimize.sampling.orderby=true
bigbench.hive.optimize.sampling.orderby.number=20000
bigbench.hive.optimize.sampling.orderby.percent=0.1
hive.groupby.skewindata=false
hive.exec.submit.local.task.via.child=true
OK
Time taken: 0.094 seconds
OK
Time taken: 0.754 seconds
WARNING: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = wentingt_20180212112650_c91da662-d160-4f48-8525-039676b1bbd7
Total jobs = 1
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/log4j-slf4j-impl-2.6.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/users/wentingt/hadoop-3.0.0-beta1-src/hadoop-dist/target/hadoop-3.0.0-beta1/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
2018-02-12 11:26:58	Starting to launch local task to process map join;	maximum memory = 477626368
2018-02-12 11:27:00	Dump the side-table for tag: 1 with group count: 72316 into file: file:/tmp/wentingt/25fdee02-394d-4d52-9a5f-a6c2a9f85080/hive_2018-02-12_11-26-50_720_8086704389562180981-1/-local-10003/HashTable-Stage-2/MapJoin-mapfile01--.hashtable
2018-02-12 11:27:01	Uploaded 1 File to: file:/tmp/wentingt/25fdee02-394d-4d52-9a5f-a6c2a9f85080/hive_2018-02-12_11-26-50_720_8086704389562180981-1/-local-10003/HashTable-Stage-2/MapJoin-mapfile01--.hashtable (1497895 bytes)
2018-02-12 11:27:01	End of local task; Time Taken: 2.153 sec.
Execution completed successfully
MapredLocal task succeeded
Launching Job 1 out of 1
Number of reduce tasks not specified. Estimated from input data size: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1518452786757_0143, Tracking URL = http://dc1master-lan1:8088/proxy/application_1518452786757_0143/
Kill Command = /users/wentingt/hadoop-3.0.0-beta1-src/hadoop-dist/target/hadoop-3.0.0-beta1/bin/hadoop job  -kill job_1518452786757_0143
Hadoop job information for Stage-2: number of mappers: 1; number of reducers: 1
2018-02-12 11:27:16,855 Stage-2 map = 0%,  reduce = 0%
2018-02-12 11:27:27,286 Stage-2 map = 100%,  reduce = 0%, Cumulative CPU 13.66 sec
2018-02-12 11:27:34,542 Stage-2 map = 100%,  reduce = 100%, Cumulative CPU 22.82 sec
MapReduce Total cumulative CPU time: 22 seconds 820 msec
Ended Job = job_1518452786757_0143
Loading data to table bigbench.q25_hive_run_query_0_temp
MapReduce Jobs Launched: 
Stage-Stage-2: Map: 1  Reduce: 1   Cumulative CPU: 22.82 sec   HDFS Read: 2514287 HDFS Write: 707610 SUCCESS
Total MapReduce CPU Time Spent: 22 seconds 820 msec
OK
Time taken: 45.558 seconds
WARNING: Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
Query ID = wentingt_20180212112736_4e92b1dc-21bd-4fe9-ac1f-94f1911a83ae
Total jobs = 1
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/log4j-slf4j-impl-2.6.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/users/wentingt/hadoop-3.0.0-beta1-src/hadoop-dist/target/hadoop-3.0.0-beta1/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
2018-02-12 11:27:42	Starting to launch local task to process map join;	maximum memory = 477626368
2018-02-12 11:27:44	Dump the side-table for tag: 1 with group count: 72316 into file: file:/tmp/wentingt/25fdee02-394d-4d52-9a5f-a6c2a9f85080/hive_2018-02-12_11-27-36_291_5612711112172960637-1/-local-10003/HashTable-Stage-2/MapJoin-mapfile11--.hashtable
2018-02-12 11:27:44	Uploaded 1 File to: file:/tmp/wentingt/25fdee02-394d-4d52-9a5f-a6c2a9f85080/hive_2018-02-12_11-27-36_291_5612711112172960637-1/-local-10003/HashTable-Stage-2/MapJoin-mapfile11--.hashtable (1497895 bytes)
2018-02-12 11:27:44	End of local task; Time Taken: 2.366 sec.
Execution completed successfully
MapredLocal task succeeded
Launching Job 1 out of 1
Number of reduce tasks not specified. Estimated from input data size: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1518452786757_0144, Tracking URL = http://dc1master-lan1:8088/proxy/application_1518452786757_0144/
Kill Command = /users/wentingt/hadoop-3.0.0-beta1-src/hadoop-dist/target/hadoop-3.0.0-beta1/bin/hadoop job  -kill job_1518452786757_0144
Hadoop job information for Stage-2: number of mappers: 1; number of reducers: 1
2018-02-12 11:27:59,786 Stage-2 map = 0%,  reduce = 0%
2018-02-12 11:28:09,193 Stage-2 map = 100%,  reduce = 0%, Cumulative CPU 13.7 sec
2018-02-12 11:28:16,420 Stage-2 map = 100%,  reduce = 100%, Cumulative CPU 23.9 sec
MapReduce Total cumulative CPU time: 23 seconds 900 msec
Ended Job = job_1518452786757_0144
Loading data to table bigbench.q25_hive_run_query_0_temp
MapReduce Jobs Launched: 
Stage-Stage-2: Map: 1  Reduce: 1   Cumulative CPU: 23.9 sec   HDFS Read: 2556621 HDFS Write: 713165 SUCCESS
Total MapReduce CPU Time Spent: 23 seconds 900 msec
OK
Time taken: 41.542 seconds
hive.optimize.sampling.orderby=true
hive.optimize.sampling.orderby.number=20000
hive.optimize.sampling.orderby.percent=0.1
OK
Time taken: 0.011 seconds
OK
Time taken: 0.091 seconds
OK
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-2 depends on stages: Stage-1
  Stage-0 depends on stages: Stage-2
  Stage-3 depends on stages: Stage-0

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: q25_hive_run_query_0_temp
            Statistics: Num rows: 62819 Data size: 1357762 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: cid (type: bigint), most_recent_date (type: bigint), frequency (type: bigint), amount (type: decimal(15,2))
              outputColumnNames: cid, most_recent_date, frequency, amount
              Statistics: Num rows: 62819 Data size: 1357762 Basic stats: COMPLETE Column stats: NONE
              Group By Operator
                aggregations: max(most_recent_date), sum(frequency), sum(amount)
                keys: cid (type: bigint)
                mode: hash
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 62819 Data size: 1357762 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 62819 Data size: 1357762 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col1 (type: bigint), _col2 (type: bigint), _col3 (type: decimal(25,2))
      Reduce Operator Tree:
        Group By Operator
          aggregations: max(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2)
          keys: KEY._col0 (type: bigint)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 31409 Data size: 678870 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: _col0 (type: bigint), CASE WHEN (((37621 - _col1) < 60)) THEN (1) ELSE (0) END (type: int), _col2 (type: bigint), _col3 (type: decimal(25,2))
            outputColumnNames: _col0, _col1, _col2, _col3
            Statistics: Num rows: 31409 Data size: 678870 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Statistics: Num rows: 31409 Data size: 678870 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: int), _col2 (type: bigint), _col3 (type: decimal(25,2))
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: bigint), UDFToDouble(VALUE._col0) (type: double), UDFToDouble(VALUE._col1) (type: double), UDFToDouble(VALUE._col2) (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 31409 Data size: 678870 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 31409 Data size: 678870 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.TextInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                name: bigbench.q25_hive_run_query_0_temp_result

  Stage: Stage-0
    Move Operator
      tables:
          replace: false
          table:
              input format: org.apache.hadoop.mapred.TextInputFormat
              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
              serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
              name: bigbench.q25_hive_run_query_0_temp_result

  Stage: Stage-3
    Stats-Aggr Operator

Time taken: 0.524 seconds, Fetched: 83 row(s)
OK
Time taken: 1.64 seconds
=========================
q25 Step 2/3: Calculating KMeans with spark
intput: --fromHiveMetastore true --input bigbench.q25_hive_run_query_0_temp_result
result output: /user/wentingt/benchmarks/bigbench/queryResults/q25_hive_run_query_0_result/
=========================
spark-submit --class io.bigdatabenchmark.v1.queries.KMeansClustering /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/Resources/bigbench-ml-spark.jar --fromHiveMetastore true --input bigbench.q25_hive_run_query_0_temp_result --output /user/wentingt/benchmarks/bigbench/queryResults/q25_hive_run_query_0_result/ --num-clusters 8 --iterations 20 --query-num q25 --saveClassificationResult true --saveMetaInfo true --verbose false
/users/wentingt/Big-Data-Benchmark-for-Big-Bench/bin/bigBench: line 64: spark-submit: command not found
An error occured while running command:
==========
spark-submit --class io.bigdatabenchmark.v1.queries.KMeansClustering /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/Resources/bigbench-ml-spark.jar --fromHiveMetastore true --input bigbench.q25_hive_run_query_0_temp_result --output /user/wentingt/benchmarks/bigbench/queryResults/q25_hive_run_query_0_result/ --num-clusters 8 --iterations 20 --query-num q25 --saveClassificationResult true --saveMetaInfo true --verbose false
==========
Please check the log files for details
======= q25_hive_run_query_0 time =======
Start timestamp: 2018/02/12:12:26:38 1518459998
Stop  timestamp: 2018/02/12:12:28:20 1518460100
Duration:  0h 1m 42s
q25_hive_run_query_0 FAILED exit code: 127 
----- result -----
EMPTY  bytes: 0
to display: hadoop fs -cat /user/wentingt/benchmarks/bigbench/queryResults/q25_hive_run_query_0_result/*
----- logs -----
time&status: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/times.csv
full log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q25_hive_run_query_0.log
=========================
An error occured while running command:
==========
runModule
==========
Please check the log files for details
@@@/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q26/query26.sql
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q26/engineLocalSettings.sql to hive init.
===============================================
Running query : q26
-----------------------------------------------
benchmark phase: run_query
stream number  : 0
user parameter file: 
user settings file : 
log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q26_hive_run_query_0.log
===============================================
checking existence of local: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs
creating/cleaning/set permissions for hdfs tmp and result folders for this query
hdfs client: hadoop fs
Duration for hdfs prepare:  0h 0m 16s
=========================
q26 Step 1/3: Executing hive queries
tmp output: /user/wentingt/benchmarks/bigbench/temp/q26_hive_run_query_0_temp
=========================
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q26/engineLocalSettings.sql to hive init.
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/log4j-slf4j-impl-2.6.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/users/wentingt/hadoop-3.0.0-beta1-src/hadoop-dist/target/hadoop-3.0.0-beta1/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]

Logging initialized using configuration in jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/hive-common-2.3.2.jar!/hive-log4j2.properties Async: true
hive.execution.engine=mr
hive.cbo.enable=true
hive.stats.fetch.partition.stats=true
hive.script.operator.truncate.env=false
hive.compute.query.using.stats=true
hive.vectorized.execution.enabled=false
hive.vectorized.execution.reduce.enabled=true
hive.stats.autogather=true
mapreduce.input.fileinputformat.split.minsize=1
mapreduce.input.fileinputformat.split.maxsize=256000000
hive.exec.reducers.bytes.per.reducer=256000000
hive.exec.reducers.max=1009
hive.exec.parallel=false
hive.exec.parallel.thread.number=8
hive.exec.compress.intermediate=false
hive.exec.compress.output=false
mapred.map.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
mapred.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
hive.default.fileformat=TEXTFILE
hive.auto.convert.sortmerge.join=false
hive.auto.convert.sortmerge.join.noconditionaltask is undefined
hive.optimize.bucketmapjoin=false
hive.optimize.bucketmapjoin.sortedmerge=false
hive.auto.convert.join.noconditionaltask.size=10000000
hive.auto.convert.join=true
hive.optimize.mapjoin.mapreduce is undefined
hive.mapred.local.mem=0
hive.mapjoin.smalltable.filesize=25000000
hive.mapjoin.localtask.max.memory.usage=0.9
hive.optimize.skewjoin=false
hive.optimize.skewjoin.compiletime=false
hive.optimize.ppd=true
hive.optimize.ppd.storage=true
hive.ppd.recognizetransivity=true
hive.optimize.index.filter=false
hive.optimize.sampling.orderby=false
hive.optimize.sampling.orderby.number=1000
hive.optimize.sampling.orderby.percent=0.1
bigbench.hive.optimize.sampling.orderby=true
bigbench.hive.optimize.sampling.orderby.number=20000
bigbench.hive.optimize.sampling.orderby.percent=0.1
hive.groupby.skewindata=false
hive.exec.submit.local.task.via.child=true
hive.optimize.sampling.orderby=true
hive.optimize.sampling.orderby.number=20000
hive.optimize.sampling.orderby.percent=0.1
OK
Time taken: 0.09 seconds
OK
Time taken: 0.787 seconds
OK
STAGE DEPENDENCIES:
  Stage-7 is a root stage
  Stage-2 depends on stages: Stage-7
  Stage-3 depends on stages: Stage-2
  Stage-0 depends on stages: Stage-3
  Stage-4 depends on stages: Stage-0

STAGE PLANS:
  Stage: Stage-7
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_1:i 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_1:i 
          TableScan
            alias: i
            Statistics: Num rows: 17820 Data size: 31241101 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: i_item_sk is not null (type: boolean)
              Statistics: Num rows: 17820 Data size: 31241101 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: bigint), i_class_id (type: int), i_category (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 17820 Data size: 31241101 Basic stats: COMPLETE Column stats: NONE
                Filter Operator
                  predicate: (_col2) IN ('Books') (type: boolean)
                  Statistics: Num rows: 8910 Data size: 15620550 Basic stats: COMPLETE Column stats: NONE
                  HashTable Sink Operator
                    keys:
                      0 _col0 (type: bigint)
                      1 _col0 (type: bigint)

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: ss
            Statistics: Num rows: 667579 Data size: 953293700 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ss_item_sk is not null (type: boolean)
              Statistics: Num rows: 667579 Data size: 953293700 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ss_item_sk (type: bigint), ss_customer_sk (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 667579 Data size: 953293700 Basic stats: COMPLETE Column stats: NONE
                Filter Operator
                  predicate: _col1 is not null (type: boolean)
                  Statistics: Num rows: 667579 Data size: 953293700 Basic stats: COMPLETE Column stats: NONE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: bigint)
                      1 _col0 (type: bigint)
                    outputColumnNames: _col0, _col1, _col3
                    Statistics: Num rows: 734336 Data size: 1048623092 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: _col1 (type: bigint), CASE WHEN ((_col3 = 1)) THEN (1) ELSE (null) END (type: int), CASE WHEN ((_col3 = 2)) THEN (1) ELSE (null) END (type: int), CASE WHEN ((_col3 = 3)) THEN (1) ELSE (null) END (type: int), CASE WHEN ((_col3 = 4)) THEN (1) ELSE (null) END (type: int), CASE WHEN ((_col3 = 5)) THEN (1) ELSE (null) END (type: int), CASE WHEN ((_col3 = 6)) THEN (1) ELSE (null) END (type: int), CASE WHEN ((_col3 = 7)) THEN (1) ELSE (null) END (type: int), CASE WHEN ((_col3 = 8)) THEN (1) ELSE (null) END (type: int), CASE WHEN ((_col3 = 9)) THEN (1) ELSE (null) END (type: int), CASE WHEN ((_col3 = 10)) THEN (1) ELSE (null) END (type: int), CASE WHEN ((_col3 = 11)) THEN (1) ELSE (null) END (type: int), CASE WHEN ((_col3 = 12)) THEN (1) ELSE (null) END (type: int), CASE WHEN ((_col3 = 13)) THEN (1) ELSE (null) END (type: int), CASE WHEN ((_col3 = 14)) THEN (1) ELSE (null) END (type: int), CASE WHEN ((_col3 = 15)) THEN (1) ELSE (null) END (type: int), _col0 (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16
                      Statistics: Num rows: 734336 Data size: 1048623092 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: count(_col1), count(_col2), count(_col3), count(_col4), count(_col5), count(_col6), count(_col7), count(_col8), count(_col9), count(_col10), count(_col11), count(_col12), count(_col13), count(_col14), count(_col15), count(_col16)
                        keys: _col0 (type: bigint)
                        mode: hash
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16
                        Statistics: Num rows: 734336 Data size: 1048623092 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint)
                          sort order: +
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 734336 Data size: 1048623092 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col1 (type: bigint), _col2 (type: bigint), _col3 (type: bigint), _col4 (type: bigint), _col5 (type: bigint), _col6 (type: bigint), _col7 (type: bigint), _col8 (type: bigint), _col9 (type: bigint), _col10 (type: bigint), _col11 (type: bigint), _col12 (type: bigint), _col13 (type: bigint), _col14 (type: bigint), _col15 (type: bigint), _col16 (type: bigint)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0), count(VALUE._col1), count(VALUE._col2), count(VALUE._col3), count(VALUE._col4), count(VALUE._col5), count(VALUE._col6), count(VALUE._col7), count(VALUE._col8), count(VALUE._col9), count(VALUE._col10), count(VALUE._col11), count(VALUE._col12), count(VALUE._col13), count(VALUE._col14), count(VALUE._col15)
          keys: KEY._col0 (type: bigint)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16
          Statistics: Num rows: 367168 Data size: 524311546 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: (_col16 > 5) (type: boolean)
            Statistics: Num rows: 122389 Data size: 174770039 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: bigint), _col3 (type: bigint), _col4 (type: bigint), _col5 (type: bigint), _col6 (type: bigint), _col7 (type: bigint), _col8 (type: bigint), _col9 (type: bigint), _col10 (type: bigint), _col11 (type: bigint), _col12 (type: bigint), _col13 (type: bigint), _col14 (type: bigint), _col15 (type: bigint)
              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15
              Statistics: Num rows: 122389 Data size: 174770039 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                table:
                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: bigint)
              sort order: +
              Statistics: Num rows: 122389 Data size: 174770039 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col1 (type: bigint), _col2 (type: bigint), _col3 (type: bigint), _col4 (type: bigint), _col5 (type: bigint), _col6 (type: bigint), _col7 (type: bigint), _col8 (type: bigint), _col9 (type: bigint), _col10 (type: bigint), _col11 (type: bigint), _col12 (type: bigint), _col13 (type: bigint), _col14 (type: bigint), _col15 (type: bigint)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: bigint), UDFToDouble(VALUE._col0) (type: double), UDFToDouble(VALUE._col1) (type: double), UDFToDouble(VALUE._col2) (type: double), UDFToDouble(VALUE._col3) (type: double), UDFToDouble(VALUE._col4) (type: double), UDFToDouble(VALUE._col5) (type: double), UDFToDouble(VALUE._col6) (type: double), UDFToDouble(VALUE._col7) (type: double), UDFToDouble(VALUE._col8) (type: double), UDFToDouble(VALUE._col9) (type: double), UDFToDouble(VALUE._col10) (type: double), UDFToDouble(VALUE._col11) (type: double), UDFToDouble(VALUE._col12) (type: double), UDFToDouble(VALUE._col13) (type: double), UDFToDouble(VALUE._col14) (type: double)
          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15
          Statistics: Num rows: 122389 Data size: 174770039 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 122389 Data size: 174770039 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.TextInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                name: bigbench.q26_hive_run_query_0_temp

  Stage: Stage-0
    Move Operator
      tables:
          replace: false
          table:
              input format: org.apache.hadoop.mapred.TextInputFormat
              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
              serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
              name: bigbench.q26_hive_run_query_0_temp

  Stage: Stage-4
    Stats-Aggr Operator

Time taken: 2.58 seconds, Fetched: 133 row(s)
=========================
q26 Step 2/3: Calculating KMeans with spark
intput: --fromHiveMetastore true --input bigbench.q26_hive_run_query_0_temp
result output: /user/wentingt/benchmarks/bigbench/queryResults/q26_hive_run_query_0_result/
=========================
spark-submit --class io.bigdatabenchmark.v1.queries.KMeansClustering /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/Resources/bigbench-ml-spark.jar --fromHiveMetastore true --input bigbench.q26_hive_run_query_0_temp --output /user/wentingt/benchmarks/bigbench/queryResults/q26_hive_run_query_0_result/ --num-clusters 8 --iterations 20 --query-num q26 --saveClassificationResult true --saveMetaInfo true --verbose false
/users/wentingt/Big-Data-Benchmark-for-Big-Bench/bin/bigBench: line 64: spark-submit: command not found
An error occured while running command:
==========
spark-submit --class io.bigdatabenchmark.v1.queries.KMeansClustering /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/Resources/bigbench-ml-spark.jar --fromHiveMetastore true --input bigbench.q26_hive_run_query_0_temp --output /user/wentingt/benchmarks/bigbench/queryResults/q26_hive_run_query_0_result/ --num-clusters 8 --iterations 20 --query-num q26 --saveClassificationResult true --saveMetaInfo true --verbose false
==========
Please check the log files for details
======= q26_hive_run_query_0 time =======
Start timestamp: 2018/02/12:12:28:38 1518460118
Stop  timestamp: 2018/02/12:12:28:54 1518460134
Duration:  0h 0m 16s
q26_hive_run_query_0 FAILED exit code: 127 
----- result -----
EMPTY  bytes: 0
to display: hadoop fs -cat /user/wentingt/benchmarks/bigbench/queryResults/q26_hive_run_query_0_result/*
----- logs -----
time&status: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/times.csv
full log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q26_hive_run_query_0.log
=========================
An error occured while running command:
==========
runModule
==========
Please check the log files for details
@@@/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q27/query27.sql
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q27/engineLocalSettings.sql to hive init.
===============================================
Running query : q27
-----------------------------------------------
benchmark phase: run_query
stream number  : 0
user parameter file: 
user settings file : 
log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q27_hive_run_query_0.log
===============================================
checking existence of local: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs
creating/cleaning/set permissions for hdfs tmp and result folders for this query
hdfs client: hadoop fs
Duration for hdfs prepare:  0h 0m 17s
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q27/engineLocalSettings.sql to hive init.
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/log4j-slf4j-impl-2.6.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/users/wentingt/hadoop-3.0.0-beta1-src/hadoop-dist/target/hadoop-3.0.0-beta1/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]

Logging initialized using configuration in jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/hive-common-2.3.2.jar!/hive-log4j2.properties Async: true
hive.execution.engine=mr
hive.cbo.enable=true
hive.stats.fetch.partition.stats=true
hive.script.operator.truncate.env=false
hive.compute.query.using.stats=true
hive.vectorized.execution.enabled=false
hive.vectorized.execution.reduce.enabled=true
hive.stats.autogather=true
mapreduce.input.fileinputformat.split.minsize=1
mapreduce.input.fileinputformat.split.maxsize=256000000
hive.exec.reducers.bytes.per.reducer=256000000
hive.exec.reducers.max=1009
hive.exec.parallel=false
hive.exec.parallel.thread.number=8
hive.exec.compress.intermediate=false
hive.exec.compress.output=false
mapred.map.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
mapred.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
hive.default.fileformat=TEXTFILE
hive.auto.convert.sortmerge.join=false
hive.auto.convert.sortmerge.join.noconditionaltask is undefined
hive.optimize.bucketmapjoin=false
hive.optimize.bucketmapjoin.sortedmerge=false
hive.auto.convert.join.noconditionaltask.size=10000000
hive.auto.convert.join=true
hive.optimize.mapjoin.mapreduce is undefined
hive.mapred.local.mem=0
hive.mapjoin.smalltable.filesize=25000000
hive.mapjoin.localtask.max.memory.usage=0.9
hive.optimize.skewjoin=false
hive.optimize.skewjoin.compiletime=false
hive.optimize.ppd=true
hive.optimize.ppd.storage=true
hive.ppd.recognizetransivity=true
hive.optimize.index.filter=false
hive.optimize.sampling.orderby=false
hive.optimize.sampling.orderby.number=1000
hive.optimize.sampling.orderby.percent=0.1
bigbench.hive.optimize.sampling.orderby=true
bigbench.hive.optimize.sampling.orderby.number=20000
bigbench.hive.optimize.sampling.orderby.percent=0.1
hive.groupby.skewindata=false
hive.exec.submit.local.task.via.child=true
Added [/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/Resources/opennlp-maxent-3.0.3.jar] to class path
Added resources: [/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/Resources/opennlp-maxent-3.0.3.jar]
Added [/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/Resources/opennlp-tools-1.6.0.jar] to class path
Added resources: [/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/Resources/opennlp-tools-1.6.0.jar]
Added [/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/Resources/bigbenchqueriesmr.jar] to class path
Added resources: [/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/Resources/bigbenchqueriesmr.jar]
new io.bigdatabenchmark.v1.queries.q27.CompanyUDF()
new io.bigdatabenchmark.v1.queries.q27.CompanyUDF() done
OK
Time taken: 0.856 seconds
hive.exec.compress.output=false
hive.optimize.sampling.orderby=true
hive.optimize.sampling.orderby.number=20000
hive.optimize.sampling.orderby.percent=0.1
OK
Time taken: 0.069 seconds
OK
Time taken: 0.472 seconds
new io.bigdatabenchmark.v1.queries.q27.CompanyUDF()
new io.bigdatabenchmark.v1.queries.q27.CompanyUDF() done
new io.bigdatabenchmark.v1.queries.q27.CompanyUDF()
new io.bigdatabenchmark.v1.queries.q27.CompanyUDF() done
initialize() io.bigdatabenchmark.v1.queries.q27.CompanyUDF
initialize() io.bigdatabenchmark.v1.queries.q27.CompanyUDF done
new io.bigdatabenchmark.v1.queries.q27.CompanyUDF()
new io.bigdatabenchmark.v1.queries.q27.CompanyUDF() done
initialize() io.bigdatabenchmark.v1.queries.q27.CompanyUDF
initialize() io.bigdatabenchmark.v1.queries.q27.CompanyUDF done
OK
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1
  Stage-2 depends on stages: Stage-0

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: product_reviews
            Statistics: Num rows: 89991 Data size: 79597045 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (pr_item_sk = 10002) (type: boolean)
              Statistics: Num rows: 44995 Data size: 39798080 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: pr_review_sk (type: bigint), 10002 (type: bigint), pr_review_content (type: string)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 44995 Data size: 39798080 Basic stats: COMPLETE Column stats: NONE
                UDTF Operator
                  Statistics: Num rows: 44995 Data size: 39798080 Basic stats: COMPLETE Column stats: NONE
                  function name: io.bigdatabenchmark.v1.queries.q27.CompanyUDF@5020b59f
                  Select Operator
                    expressions: pr_sk (type: bigint), item_sk (type: bigint), company_name (type: string), review_sentence (type: string)
                    outputColumnNames: _col0, _col1, _col2, _col3
                    Statistics: Num rows: 44995 Data size: 39798080 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: string), _col3 (type: string)
                      sort order: ++++
                      Statistics: Num rows: 44995 Data size: 39798080 Basic stats: COMPLETE Column stats: NONE
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint), KEY.reducesinkkey2 (type: string), KEY.reducesinkkey3 (type: string)
          outputColumnNames: _col0, _col1, _col2, _col3
          Statistics: Num rows: 44995 Data size: 39798080 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            Statistics: Num rows: 44995 Data size: 39798080 Basic stats: COMPLETE Column stats: NONE
            table:
                input format: org.apache.hadoop.mapred.TextInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                name: bigbench.q27_hive_run_query_0_result

  Stage: Stage-0
    Move Operator
      tables:
          replace: false
          table:
              input format: org.apache.hadoop.mapred.TextInputFormat
              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
              serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
              name: bigbench.q27_hive_run_query_0_result

  Stage: Stage-2
    Stats-Aggr Operator

Time taken: 4.344 seconds, Fetched: 57 row(s)
======= q27_hive_run_query_0 time =======
Start timestamp: 2018/02/12:12:29:13 1518460153
Stop  timestamp: 2018/02/12:12:29:31 1518460171
Duration:  0h 0m 18s
q27_hive_run_query_0 SUCCESS exit code: 0 
----- result -----
EMPTY  bytes: 0
to display: hadoop fs -cat /user/wentingt/benchmarks/bigbench/queryResults/q27_hive_run_query_0_result/*
----- logs -----
time&status: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/times.csv
full log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q27_hive_run_query_0.log
=========================
@@@/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q28/query28.sql
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q28/engineLocalSettings.sql to hive init.
===============================================
Running query : q28
-----------------------------------------------
benchmark phase: run_query
stream number  : 0
user parameter file: 
user settings file : 
log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q28_hive_run_query_0.log
===============================================
checking existence of local: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs
creating/cleaning/set permissions for hdfs tmp and result folders for this query
hdfs client: hadoop fs
Duration for hdfs prepare:  0h 0m 16s
=========================
q28 step 1/3: Executing hive queries
tmp result1 (training data) in: /user/wentingt/benchmarks/bigbench/temp/q28_hive_run_query_0_temp/q28_hive_run_query_0_temp_training
tmp result2 (test data)     in: /user/wentingt/benchmarks/bigbench/temp/q28_hive_run_query_0_temp/q28_hive_run_query_0_temp_testing
=========================
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q28/engineLocalSettings.sql to hive init.
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/log4j-slf4j-impl-2.6.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/users/wentingt/hadoop-3.0.0-beta1-src/hadoop-dist/target/hadoop-3.0.0-beta1/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]

Logging initialized using configuration in jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/hive-common-2.3.2.jar!/hive-log4j2.properties Async: true
hive.execution.engine=mr
hive.cbo.enable=true
hive.stats.fetch.partition.stats=true
hive.script.operator.truncate.env=false
hive.compute.query.using.stats=true
hive.vectorized.execution.enabled=false
hive.vectorized.execution.reduce.enabled=true
hive.stats.autogather=true
mapreduce.input.fileinputformat.split.minsize=1
mapreduce.input.fileinputformat.split.maxsize=256000000
hive.exec.reducers.bytes.per.reducer=256000000
hive.exec.reducers.max=1009
hive.exec.parallel=false
hive.exec.parallel.thread.number=8
hive.exec.compress.intermediate=false
hive.exec.compress.output=false
mapred.map.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
mapred.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
hive.default.fileformat=TEXTFILE
hive.auto.convert.sortmerge.join=false
hive.auto.convert.sortmerge.join.noconditionaltask is undefined
hive.optimize.bucketmapjoin=false
hive.optimize.bucketmapjoin.sortedmerge=false
hive.auto.convert.join.noconditionaltask.size=10000000
hive.auto.convert.join=true
hive.optimize.mapjoin.mapreduce is undefined
hive.mapred.local.mem=0
hive.mapjoin.smalltable.filesize=25000000
hive.mapjoin.localtask.max.memory.usage=0.9
hive.optimize.skewjoin=false
hive.optimize.skewjoin.compiletime=false
hive.optimize.ppd=true
hive.optimize.ppd.storage=true
hive.ppd.recognizetransivity=true
hive.optimize.index.filter=false
hive.optimize.sampling.orderby=false
hive.optimize.sampling.orderby.number=1000
hive.optimize.sampling.orderby.percent=0.1
bigbench.hive.optimize.sampling.orderby=true
bigbench.hive.optimize.sampling.orderby.number=20000
bigbench.hive.optimize.sampling.orderby.percent=0.1
hive.groupby.skewindata=false
hive.exec.submit.local.task.via.child=true
hive.optimize.sampling.orderby=true
hive.optimize.sampling.orderby.number=20000
hive.optimize.sampling.orderby.percent=0.1
OK
Time taken: 0.095 seconds
OK
Time taken: 0.82 seconds
OK
Time taken: 0.011 seconds
OK
Time taken: 0.091 seconds
OK
STAGE DEPENDENCIES:
  Stage-2 is a root stage
  Stage-0 depends on stages: Stage-2
  Stage-3 depends on stages: Stage-0
  Stage-1 depends on stages: Stage-2
  Stage-4 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: product_reviews
            Statistics: Num rows: 89991 Data size: 79597045 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: pr_review_sk (type: bigint), pr_review_rating (type: int), pr_review_content (type: string)
              outputColumnNames: _col0, _col1, _col2
              Statistics: Num rows: 89991 Data size: 79597045 Basic stats: COMPLETE Column stats: NONE
              Reduce Output Operator
                key expressions: _col0 (type: bigint)
                sort order: +
                Statistics: Num rows: 89991 Data size: 79597045 Basic stats: COMPLETE Column stats: NONE
                value expressions: _col1 (type: int), _col2 (type: string)
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: bigint), VALUE._col0 (type: int), VALUE._col1 (type: string)
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 89991 Data size: 79597045 Basic stats: COMPLETE Column stats: NONE
          Filter Operator
            predicate: ((_col0 pmod 10)) IN (1, 2, 3, 4, 5, 6, 7, 8, 9) (type: boolean)
            Statistics: Num rows: 44995 Data size: 39798080 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 44995 Data size: 39798080 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.TextInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                  name: bigbench.q28_hive_run_query_0_temp_training
          Filter Operator
            predicate: ((_col0 pmod 10)) IN (0) (type: boolean)
            Statistics: Num rows: 44995 Data size: 39798080 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              Statistics: Num rows: 44995 Data size: 39798080 Basic stats: COMPLETE Column stats: NONE
              table:
                  input format: org.apache.hadoop.mapred.TextInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                  name: bigbench.q28_hive_run_query_0_temp_testing

  Stage: Stage-0
    Move Operator
      tables:
          replace: true
          table:
              input format: org.apache.hadoop.mapred.TextInputFormat
              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
              serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
              name: bigbench.q28_hive_run_query_0_temp_training

  Stage: Stage-3
    Stats-Aggr Operator

  Stage: Stage-1
    Move Operator
      tables:
          replace: true
          table:
              input format: org.apache.hadoop.mapred.TextInputFormat
              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
              serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
              name: bigbench.q28_hive_run_query_0_temp_testing

  Stage: Stage-4
    Stats-Aggr Operator

Time taken: 1.879 seconds, Fetched: 77 row(s)
=========================
q28 step 2/3: Train and Test Naive Bayes Classifier with spark - read from metastore table
training and testing data: bigbench.q28_hive_run_query_0_temp_training
test data    : /user/wentingt/benchmarks/bigbench/temp/q28_hive_run_query_0_temp/q28_hive_run_query_0_temp_testing
OUT: /user/wentingt/benchmarks/bigbench/queryResults/q28_hive_run_query_0_result
=========================
spark-submit --class io.bigdatabenchmark.v1.queries.q28.NaiveBayesClassifier /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/Resources/bigbench-ml-spark.jar --fromHiveMetastore true --inputTraining bigbench.q28_hive_run_query_0_temp_training --inputTesting bigbench.q28_hive_run_query_0_temp_testing --lambda 0 --output /user/wentingt/benchmarks/bigbench/queryResults/q28_hive_run_query_0_result/ --saveClassificationResult true --saveMetaInfo true --verbose false
/users/wentingt/Big-Data-Benchmark-for-Big-Bench/bin/bigBench: line 64: spark-submit: command not found
An error occured while running command:
==========
spark-submit --class io.bigdatabenchmark.v1.queries.q28.NaiveBayesClassifier /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/Resources/bigbench-ml-spark.jar --fromHiveMetastore true --inputTraining bigbench.q28_hive_run_query_0_temp_training --inputTesting bigbench.q28_hive_run_query_0_temp_testing --lambda 0 --output /user/wentingt/benchmarks/bigbench/queryResults/q28_hive_run_query_0_result/ --saveClassificationResult true --saveMetaInfo true --verbose false
==========
Please check the log files for details
======= q28_hive_run_query_0 time =======
Start timestamp: 2018/02/12:12:29:50 1518460190
Stop  timestamp: 2018/02/12:12:30:05 1518460205
Duration:  0h 0m 15s
q28_hive_run_query_0 FAILED exit code: 127 
----- result -----
EMPTY  bytes: 0
to display: hadoop fs -cat /user/wentingt/benchmarks/bigbench/queryResults/q28_hive_run_query_0_result/*
----- logs -----
time&status: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/times.csv
full log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q28_hive_run_query_0.log
=========================
An error occured while running command:
==========
runModule
==========
Please check the log files for details
@@@/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q29/query29.sql
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q29/engineLocalSettings.sql to hive init.
===============================================
Running query : q29
-----------------------------------------------
benchmark phase: run_query
stream number  : 0
user parameter file: 
user settings file : 
log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q29_hive_run_query_0.log
===============================================
checking existence of local: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs
creating/cleaning/set permissions for hdfs tmp and result folders for this query
hdfs client: hadoop fs
Duration for hdfs prepare:  0h 0m 16s
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q29/engineLocalSettings.sql to hive init.
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/log4j-slf4j-impl-2.6.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/users/wentingt/hadoop-3.0.0-beta1-src/hadoop-dist/target/hadoop-3.0.0-beta1/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]

Logging initialized using configuration in jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/hive-common-2.3.2.jar!/hive-log4j2.properties Async: true
hive.execution.engine=mr
hive.cbo.enable=true
hive.stats.fetch.partition.stats=true
hive.script.operator.truncate.env=false
hive.compute.query.using.stats=true
hive.vectorized.execution.enabled=false
hive.vectorized.execution.reduce.enabled=true
hive.stats.autogather=true
mapreduce.input.fileinputformat.split.minsize=1
mapreduce.input.fileinputformat.split.maxsize=256000000
hive.exec.reducers.bytes.per.reducer=256000000
hive.exec.reducers.max=1009
hive.exec.parallel=false
hive.exec.parallel.thread.number=8
hive.exec.compress.intermediate=false
hive.exec.compress.output=false
mapred.map.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
mapred.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
hive.default.fileformat=TEXTFILE
hive.auto.convert.sortmerge.join=false
hive.auto.convert.sortmerge.join.noconditionaltask is undefined
hive.optimize.bucketmapjoin=false
hive.optimize.bucketmapjoin.sortedmerge=false
hive.auto.convert.join.noconditionaltask.size=10000000
hive.auto.convert.join=true
hive.optimize.mapjoin.mapreduce is undefined
hive.mapred.local.mem=0
hive.mapjoin.smalltable.filesize=25000000
hive.mapjoin.localtask.max.memory.usage=0.9
hive.optimize.skewjoin=false
hive.optimize.skewjoin.compiletime=false
hive.optimize.ppd=true
hive.optimize.ppd.storage=true
hive.ppd.recognizetransivity=true
hive.optimize.index.filter=false
hive.optimize.sampling.orderby=false
hive.optimize.sampling.orderby.number=1000
hive.optimize.sampling.orderby.percent=0.1
bigbench.hive.optimize.sampling.orderby=true
bigbench.hive.optimize.sampling.orderby.number=20000
bigbench.hive.optimize.sampling.orderby.percent=0.1
hive.groupby.skewindata=false
hive.exec.submit.local.task.via.child=true
Added [/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/Resources/bigbenchqueriesmr.jar] to class path
Added resources: [/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/Resources/bigbenchqueriesmr.jar]
OK
Time taken: 0.017 seconds
hive.exec.compress.output=false
OK
Time taken: 0.079 seconds
OK
Time taken: 0.418 seconds
OK
STAGE DEPENDENCIES:
  Stage-8 is a root stage
  Stage-2 depends on stages: Stage-8
  Stage-3 depends on stages: Stage-2
  Stage-4 depends on stages: Stage-3
  Stage-0 depends on stages: Stage-4
  Stage-5 depends on stages: Stage-0

STAGE PLANS:
  Stage: Stage-8
    Map Reduce Local Work
      Alias -> Map Local Tables:
        $hdt$_0:$hdt$_0:$hdt$_1:i 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        $hdt$_0:$hdt$_0:$hdt$_1:i 
          TableScan
            alias: i
            Statistics: Num rows: 17820 Data size: 31241101 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_category_id is not null and i_item_sk is not null) (type: boolean)
              Statistics: Num rows: 17820 Data size: 31241101 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: i_item_sk (type: bigint), i_category_id (type: int)
                outputColumnNames: _col0, _col11
                Statistics: Num rows: 17820 Data size: 31241101 Basic stats: COMPLETE Column stats: NONE
                HashTable Sink Operator
                  keys:
                    0 _col3 (type: bigint)
                    1 _col0 (type: bigint)

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: ws
            Statistics: Num rows: 668052 Data size: 1221174888 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: ws_item_sk is not null (type: boolean)
              Statistics: Num rows: 668052 Data size: 1221174888 Basic stats: COMPLETE Column stats: NONE
              Select Operator
                expressions: ws_order_number (type: bigint), ws_item_sk (type: bigint)
                outputColumnNames: _col17, _col3
                Statistics: Num rows: 668052 Data size: 1221174888 Basic stats: COMPLETE Column stats: NONE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col3 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col17, _col48
                  Statistics: Num rows: 734857 Data size: 1343292405 Basic stats: COMPLETE Column stats: NONE
                  Group By Operator
                    aggregations: collect_set(_col48)
                    keys: _col17 (type: bigint)
                    mode: hash
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 734857 Data size: 1343292405 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 734857 Data size: 1343292405 Basic stats: COMPLETE Column stats: NONE
                      value expressions: _col1 (type: array<int>)
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Group By Operator
          aggregations: collect_set(VALUE._col0)
          keys: KEY._col0 (type: bigint)
          mode: mergepartial
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 367428 Data size: 671645288 Basic stats: COMPLETE Column stats: NONE
          Select Operator
            expressions: sort_array(_col1) (type: array<int>), false (type: boolean)
            outputColumnNames: _col0, _col1
            Statistics: Num rows: 367428 Data size: 671645288 Basic stats: COMPLETE Column stats: NONE
            UDTF Operator
              Statistics: Num rows: 367428 Data size: 671645288 Basic stats: COMPLETE Column stats: NONE
              function name: io.bigdatabenchmark.v1.queries.udf.PairwiseUDTF@951e911
              Group By Operator
                aggregations: count()
                keys: itema (type: string), itemb (type: string)
                mode: hash
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 367428 Data size: 671645288 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string)
              sort order: ++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: string)
              Statistics: Num rows: 367428 Data size: 671645288 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0)
          keys: KEY._col0 (type: string), KEY._col1 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 183714 Data size: 335822644 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col2 (type: bigint), _col0 (type: string), _col1 (type: string)
              sort order: -++
              Statistics: Num rows: 183714 Data size: 335822644 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey1 (type: string), KEY.reducesinkkey2 (type: string), KEY.reducesinkkey0 (type: bigint)
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 183714 Data size: 335822644 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 182700 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: UDFToLong(_col0) (type: bigint), UDFToLong(_col1) (type: bigint), _col2 (type: bigint)
              outputColumnNames: _col0, _col1, _col2
              Statistics: Num rows: 100 Data size: 182700 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                Statistics: Num rows: 100 Data size: 182700 Basic stats: COMPLETE Column stats: NONE
                table:
                    input format: org.apache.hadoop.mapred.TextInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                    name: bigbench.q29_hive_run_query_0_result

  Stage: Stage-0
    Move Operator
      tables:
          replace: false
          table:
              input format: org.apache.hadoop.mapred.TextInputFormat
              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
              serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
              name: bigbench.q29_hive_run_query_0_result

  Stage: Stage-5
    Stats-Aggr Operator

Time taken: 3.036 seconds, Fetched: 161 row(s)
======= q29_hive_run_query_0 time =======
Start timestamp: 2018/02/12:12:30:24 1518460224
Stop  timestamp: 2018/02/12:12:30:40 1518460240
Duration:  0h 0m 16s
q29_hive_run_query_0 SUCCESS exit code: 0 
----- result -----
EMPTY  bytes: 0
to display: hadoop fs -cat /user/wentingt/benchmarks/bigbench/queryResults/q29_hive_run_query_0_result/*
----- logs -----
time&status: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/times.csv
full log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q29_hive_run_query_0.log
=========================
@@@/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q30/query30.sql
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q30/engineLocalSettings.sql to hive init.
===============================================
Running query : q30
-----------------------------------------------
benchmark phase: run_query
stream number  : 0
user parameter file: 
user settings file : 
log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q30_hive_run_query_0.log
===============================================
checking existence of local: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs
creating/cleaning/set permissions for hdfs tmp and result folders for this query
hdfs client: hadoop fs
Duration for hdfs prepare:  0h 0m 17s
Additional local hive settings found. Adding /users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q30/engineLocalSettings.sql to hive init.
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/log4j-slf4j-impl-2.6.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/users/wentingt/hadoop-3.0.0-beta1-src/hadoop-dist/target/hadoop-3.0.0-beta1/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]

Logging initialized using configuration in jar:file:/users/wentingt/apache-hive-2.3.2-bin/lib/hive-common-2.3.2.jar!/hive-log4j2.properties Async: true
hive.execution.engine=mr
hive.cbo.enable=true
hive.stats.fetch.partition.stats=true
hive.script.operator.truncate.env=false
hive.compute.query.using.stats=true
hive.vectorized.execution.enabled=false
hive.vectorized.execution.reduce.enabled=true
hive.stats.autogather=true
mapreduce.input.fileinputformat.split.minsize=1
mapreduce.input.fileinputformat.split.maxsize=256000000
hive.exec.reducers.bytes.per.reducer=256000000
hive.exec.reducers.max=1009
hive.exec.parallel=false
hive.exec.parallel.thread.number=8
hive.exec.compress.intermediate=false
hive.exec.compress.output=false
mapred.map.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
mapred.output.compression.codec=org.apache.hadoop.io.compress.DefaultCodec
hive.default.fileformat=TEXTFILE
hive.auto.convert.sortmerge.join=false
hive.auto.convert.sortmerge.join.noconditionaltask is undefined
hive.optimize.bucketmapjoin=false
hive.optimize.bucketmapjoin.sortedmerge=false
hive.auto.convert.join.noconditionaltask.size=10000000
hive.auto.convert.join=true
hive.optimize.mapjoin.mapreduce is undefined
hive.mapred.local.mem=0
hive.mapjoin.smalltable.filesize=25000000
hive.mapjoin.localtask.max.memory.usage=0.9
hive.optimize.skewjoin=false
hive.optimize.skewjoin.compiletime=false
hive.optimize.ppd=true
hive.optimize.ppd.storage=true
hive.ppd.recognizetransivity=true
hive.optimize.index.filter=false
hive.optimize.sampling.orderby=false
hive.optimize.sampling.orderby.number=1000
hive.optimize.sampling.orderby.percent=0.1
bigbench.hive.optimize.sampling.orderby=true
bigbench.hive.optimize.sampling.orderby.number=20000
bigbench.hive.optimize.sampling.orderby.percent=0.1
hive.groupby.skewindata=false
hive.exec.submit.local.task.via.child=true
Added [/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/Resources/bigbenchqueriesmr.jar] to class path
Added resources: [/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/Resources/bigbenchqueriesmr.jar]
OK
Time taken: 0.014 seconds
Added resources: [/users/wentingt/Big-Data-Benchmark-for-Big-Bench/engines/hive/queries/q30/q30-sessionize.py]
OK
Time taken: 0.101 seconds
OK
Time taken: 0.796 seconds
hive.exec.compress.output=false
OK
Time taken: 0.013 seconds
OK
Time taken: 0.161 seconds
OK
STAGE DEPENDENCIES:
  Stage-9 is a root stage
  Stage-2 depends on stages: Stage-9
  Stage-3 depends on stages: Stage-2
  Stage-4 depends on stages: Stage-3
  Stage-5 depends on stages: Stage-4
  Stage-0 depends on stages: Stage-5
  Stage-6 depends on stages: Stage-0

STAGE PLANS:
  Stage: Stage-9
    Map Reduce Local Work
      Alias -> Map Local Tables:
        pairs:collectedlist:q30_hive_run_query_0_temp:q02_tmp_sessionize:clicksanwebpagetype:i 
          Fetch Operator
            limit: -1
      Alias -> Map Local Operator Tree:
        pairs:collectedlist:q30_hive_run_query_0_temp:q02_tmp_sessionize:clicksanwebpagetype:i 
          TableScan
            alias: i
            Statistics: Num rows: 17820 Data size: 31241101 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (i_item_sk is not null and i_category_id is not null) (type: boolean)
              Statistics: Num rows: 17820 Data size: 31241101 Basic stats: COMPLETE Column stats: NONE
              HashTable Sink Operator
                keys:
                  0 wcs_item_sk (type: bigint)
                  1 i_item_sk (type: bigint)

  Stage: Stage-2
    Map Reduce
      Map Operator Tree:
          TableScan
            alias: wcs
            Statistics: Num rows: 6770550 Data size: 253337416 Basic stats: COMPLETE Column stats: NONE
            Filter Operator
              predicate: (wcs_item_sk is not null and wcs_user_sk is not null) (type: boolean)
              Statistics: Num rows: 6770550 Data size: 253337416 Basic stats: COMPLETE Column stats: NONE
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 wcs_item_sk (type: bigint)
                  1 i_item_sk (type: bigint)
                outputColumnNames: _col0, _col1, _col3, _col5, _col9, _col20
                Statistics: Num rows: 7447605 Data size: 278671163 Basic stats: COMPLETE Column stats: NONE
                Filter Operator
                  predicate: (_col3 = _col9) (type: boolean)
                  Statistics: Num rows: 3723802 Data size: 139335562 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col5 (type: bigint), ((((_col0 * 24) * 60) * 60) + _col1) (type: bigint), _col20 (type: int)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 3723802 Data size: 139335562 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: int)
                      sort order: +++
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 3723802 Data size: 139335562 Basic stats: COMPLETE Column stats: NONE
      Local Work:
        Map Reduce Local Work
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint), KEY.reducesinkkey2 (type: int)
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 3723802 Data size: 139335562 Basic stats: COMPLETE Column stats: NONE
          Transform Operator
            command: python q30-sessionize.py 3600
            output info:
                input format: org.apache.hadoop.mapred.TextInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
            Statistics: Num rows: 3723802 Data size: 139335562 Basic stats: COMPLETE Column stats: NONE
            File Output Operator
              compressed: false
              table:
                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                  serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-3
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col1 (type: string)
              sort order: +
              Map-reduce partition columns: _col1 (type: string)
              Statistics: Num rows: 3723802 Data size: 139335562 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col0 (type: bigint)
      Reduce Operator Tree:
        Select Operator
          expressions: VALUE._col0 (type: bigint), KEY.reducesinkkey0 (type: string)
          outputColumnNames: _col0, _col1
          Statistics: Num rows: 3723802 Data size: 139335562 Basic stats: COMPLETE Column stats: NONE
          Group By Operator
            aggregations: collect_set(_col0)
            keys: _col1 (type: string)
            mode: complete
            outputColumnNames: _col0, _col1
            Statistics: Num rows: 1861901 Data size: 69667781 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: sort_array(_col1) (type: array<bigint>), false (type: boolean)
              outputColumnNames: _col0, _col1
              Statistics: Num rows: 1861901 Data size: 69667781 Basic stats: COMPLETE Column stats: NONE
              UDTF Operator
                Statistics: Num rows: 1861901 Data size: 69667781 Basic stats: COMPLETE Column stats: NONE
                function name: io.bigdatabenchmark.v1.queries.udf.PairwiseUDTF@7805478c
                Group By Operator
                  aggregations: count()
                  keys: itema (type: string), itemb (type: string)
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 1861901 Data size: 69667781 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-4
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col0 (type: string), _col1 (type: string)
              sort order: ++
              Map-reduce partition columns: _col0 (type: string), _col1 (type: string)
              Statistics: Num rows: 1861901 Data size: 69667781 Basic stats: COMPLETE Column stats: NONE
              value expressions: _col2 (type: bigint)
      Reduce Operator Tree:
        Group By Operator
          aggregations: count(VALUE._col0)
          keys: KEY._col0 (type: string), KEY._col1 (type: string)
          mode: mergepartial
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 930950 Data size: 34833871 Basic stats: COMPLETE Column stats: NONE
          File Output Operator
            compressed: false
            table:
                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe

  Stage: Stage-5
    Map Reduce
      Map Operator Tree:
          TableScan
            Reduce Output Operator
              key expressions: _col2 (type: bigint), _col0 (type: string), _col1 (type: string)
              sort order: -++
              Statistics: Num rows: 930950 Data size: 34833871 Basic stats: COMPLETE Column stats: NONE
              TopN Hash Memory Usage: 0.1
      Reduce Operator Tree:
        Select Operator
          expressions: KEY.reducesinkkey1 (type: string), KEY.reducesinkkey2 (type: string), KEY.reducesinkkey0 (type: bigint)
          outputColumnNames: _col0, _col1, _col2
          Statistics: Num rows: 930950 Data size: 34833871 Basic stats: COMPLETE Column stats: NONE
          Limit
            Number of rows: 100
            Statistics: Num rows: 100 Data size: 3700 Basic stats: COMPLETE Column stats: NONE
            Select Operator
              expressions: UDFToLong(_col0) (type: bigint), UDFToLong(_col1) (type: bigint), _col2 (type: bigint)
              outputColumnNames: _col0, _col1, _col2
              Statistics: Num rows: 100 Data size: 3700 Basic stats: COMPLETE Column stats: NONE
              File Output Operator
                compressed: false
                Statistics: Num rows: 100 Data size: 3700 Basic stats: COMPLETE Column stats: NONE
                table:
                    input format: org.apache.hadoop.mapred.TextInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                    name: bigbench.q30_hive_run_query_0_result

  Stage: Stage-0
    Move Operator
      tables:
          replace: false
          table:
              input format: org.apache.hadoop.mapred.TextInputFormat
              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
              serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
              name: bigbench.q30_hive_run_query_0_result

  Stage: Stage-6
    Stats-Aggr Operator

Time taken: 0.577 seconds, Fetched: 187 row(s)
OK
Time taken: 1.546 seconds
======= q30_hive_run_query_0 time =======
Start timestamp: 2018/02/12:12:30:59 1518460259
Stop  timestamp: 2018/02/12:12:31:14 1518460274
Duration:  0h 0m 15s
q30_hive_run_query_0 SUCCESS exit code: 0 
----- result -----
EMPTY  bytes: 0
to display: hadoop fs -cat /user/wentingt/benchmarks/bigbench/queryResults/q30_hive_run_query_0_result/*
----- logs -----
time&status: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/times.csv
full log: /users/wentingt/Big-Data-Benchmark-for-Big-Bench/logs/q30_hive_run_query_0.log
=========================
